<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RUSHL ‚Äì All-in-One Toolkit</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    
    <style>
        /* CSS Variables for Themes */
        :root {
            --color-bg: #fafafa;
            --color-bg-secondary: #e4e5f1;
            --color-bg-sidebar: #f0f1f8;
            --color-text-primary: #121212;
            --color-text-secondary: #484b6a;
            --color-accent: #484b6a;
            --color-accent-glow: rgba(72, 75, 106, 0.3);
            --color-border: #d2d3db;
            --color-button-text: #ffffff;
            --color-button-bg: #484b6a;
            --color-button-hover-bg: #3a3d58;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        .dark-mode {
            --color-bg: #0d0f14;
            --color-bg-secondary: #1c222d;
            --color-bg-sidebar: #12151a;
            --color-text-primary: #ffffff;
            --color-text-secondary: #e0e0e0;
            --color-accent: #42f8f5;
            --color-accent-glow: rgba(66, 248, 245, 0.6);
            --color-border: #42f8f5;
            --color-button-text: #0d0f14;
            --color-button-bg: #42f8f5;
            --color-button-hover-bg: #8efffd;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-bg);
            color: var(--color-text-primary);
            line-height: 1.6;
            transition: var(--transition);
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        ul {
            list-style: none;
        }

        button {
            cursor: pointer;
            border: none;
            outline: none;
            font-family: inherit;
            transition: var(--transition);
        }

        /* Layout */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        .header {
            position: sticky;
            top: 0;
            z-index: 100;
            background-color: var(--color-bg-secondary);
            box-shadow: var(--shadow);
            padding: 1rem 0;
            transition: var(--transition);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--color-text-primary);
        }

        .logo-icon {
            font-size: 2rem;
            color: var(--color-accent);
        }

        .nav-links {
            display: flex;
            gap: 2rem;
        }

        .nav-link {
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: var(--transition);
        }

        .nav-link:hover {
            background-color: var(--color-accent);
            color: var(--color-button-text);
        }

        .theme-toggle {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--color-text-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            transition: var(--transition);
        }

        .theme-toggle:hover {
            background-color: var(--color-accent);
            color: var(--color-button-text);
        }

        .hamburger {
            display: none;
            flex-direction: column;
            cursor: pointer;
        }

        .hamburger span {
            width: 25px;
            height: 3px;
            background-color: var(--color-text-primary);
            margin: 3px 0;
            transition: var(--transition);
        }

        /* Main Layout */
        .main-layout {
            display: flex;
            min-height: calc(100vh - 80px);
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background-color: var(--color-bg-sidebar);
            padding: 2rem 1rem;
            position: sticky;
            top: 80px;
            height: calc(100vh - 80px);
            overflow-y: auto;
            transition: var(--transition);
        }

        .sidebar h3 {
            margin-bottom: 1.5rem;
            padding-left: 1rem;
            color: var(--color-accent);
        }

        .sidebar-category {
            margin-bottom: 1.5rem;
        }

        .sidebar-category h4 {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.8rem;
            color: var(--color-text-secondary);
            padding-left: 1rem;
        }

        .sidebar-item {
            padding: 0.7rem 1rem;
            border-radius: 4px;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .sidebar-item:hover {
            background-color: var(--color-bg-secondary);
            box-shadow: 0 0 10px var(--color-accent-glow);
        }

        .sidebar-item.active {
            background-color: var(--color-accent);
            color: var(--color-button-text);
        }

        .sidebar-toggle {
            display: none;
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 90;
            background-color: var(--color-accent);
            color: var(--color-button-text);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 2rem;
        }

        /* Hero Section */
        .hero {
            text-align: center;
            padding: 3rem 0;
            margin-bottom: 2rem;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            background: linear-gradient(90deg, var(--color-accent), #8efffd);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hero p {
            font-size: 1.2rem;
            color: var(--color-text-secondary);
            max-width: 600px;
            margin: 0 auto 2rem;
        }

        /* Search Bar */
        .search-container {
            max-width: 600px;
            margin: 0 auto 3rem;
            position: relative;
        }

        .search-bar {
            width: 100%;
            padding: 1rem 1.5rem;
            border-radius: 50px;
            border: 1px solid var(--color-border);
            background-color: var(--color-bg-secondary);
            color: var(--color-text-primary);
            font-size: 1rem;
            transition: var(--transition);
        }

        .search-bar:focus {
            outline: none;
            box-shadow: 0 0 15px var(--color-accent-glow);
            border-color: var(--color-accent);
        }

        .search-icon {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--color-text-secondary);
        }

        /* Tool Grid */
        .tool-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 4rem;
        }

        .tool-card {
            background-color: var(--color-bg-secondary);
            border-radius: 10px;
            padding: 1.5rem;
            border: 1px solid var(--color-border);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .tool-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px var(--color-accent-glow);
        }

        .tool-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--color-accent);
        }

        .tool-card h3 {
            margin-bottom: 0.5rem;
            font-size: 1.3rem;
        }

        .tool-card p {
            color: var(--color-text-secondary);
            margin-bottom: 1.5rem;
            flex-grow: 1;
        }

        .tool-button {
            background-color: var(--color-button-bg);
            color: var(--color-button-text);
            padding: 0.8rem 1.5rem;
            border-radius: 4px;
            font-weight: 500;
            text-align: center;
            transition: var(--transition);
        }

        .tool-button:hover {
            background-color: var(--color-button-hover-bg);
            box-shadow: 0 0 10px var(--color-accent-glow);
        }

        /* Sections */
        .section {
            padding: 4rem 0;
            border-top: 1px solid var(--color-border);
        }

        .section h2 {
            font-size: 2rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .section-content {
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.8;
            color: var(--color-text-secondary);
        }

        /* Footer */
        .footer {
            background-color: var(--color-bg-secondary);
            padding: 2rem 0;
            text-align: center;
            border-top: 1px solid var(--color-border);
        }

        .footer-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
        }

        .footer-links {
            display: flex;
            gap: 2rem;
        }

        .footer-link {
            color: var(--color-text-secondary);
            transition: var(--transition);
        }

        .footer-link:hover {
            color: var(--color-accent);
        }

        .social-icons {
            display: flex;
            gap: 1rem;
        }

        .social-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--color-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .social-icon:hover {
            background-color: var(--color-accent);
            color: var(--color-button-text);
            box-shadow: 0 0 10px var(--color-accent-glow);
        }

        /* Modals */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background-color: var(--color-bg);
            border-radius: 10px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 2rem;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transform: translateY(20px);
            transition: var(--transition);
        }

        .modal-overlay.active .modal {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--color-border);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--color-text-primary);
            cursor: pointer;
            transition: var(--transition);
        }

        .modal-close:hover {
            color: var(--color-accent);
        }

        .modal-content {
            margin-bottom: 2rem;
        }

        .tool-controls {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .input-group label {
            font-weight: 500;
            color: var(--color-text-secondary);
        }

        .input-group input,
        .input-group select,
        .input-group textarea {
            padding: 0.8rem 1rem;
            border-radius: 4px;
            border: 1px solid var(--color-border);
            background-color: var(--color-bg-secondary);
            color: var(--color-text-primary);
            font-family: inherit;
            transition: var(--transition);
        }

        .input-group input:focus,
        .input-group select:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: var(--color-accent);
            box-shadow: 0 0 5px var(--color-accent-glow);
        }

        .file-upload {
            border: 2px dashed var(--color-border);
            border-radius: 4px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .file-upload:hover {
            border-color: var(--color-accent);
            background-color: var(--color-bg-secondary);
        }

        .file-input {
            display: none;
        }

        .range-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .range-value {
            font-weight: 500;
            color: var(--color-accent);
        }

        .button-group {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .primary-button {
            background-color: var(--color-button-bg);
            color: var(--color-button-text);
            padding: 0.8rem 1.5rem;
            border-radius: 4px;
            font-weight: 500;
            transition: var(--transition);
            flex: 1;
        }

        .primary-button:hover {
            background-color: var(--color-button-hover-bg);
            box-shadow: 0 0 10px var(--color-accent-glow);
        }

        .secondary-button {
            background-color: transparent;
            color: var(--color-text-primary);
            padding: 0.8rem 1.5rem;
            border-radius: 4px;
            border: 1px solid var(--color-border);
            font-weight: 500;
            transition: var(--transition);
            flex: 1;
        }

        .secondary-button:hover {
            background-color: var(--color-bg-secondary);
        }

        /* Scroll to Top */
        .scroll-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--color-accent);
            color: var(--color-button-text);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            z-index: 90;
        }

        .scroll-to-top.active {
            opacity: 1;
            visibility: visible;
        }

        .scroll-to-top:hover {
            background-color: var(--color-button-hover-bg);
            box-shadow: 0 0 15px var(--color-accent-glow);
        }

        /* Loading Spinner */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--color-accent);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Image Preview */
        .image-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .preview-item {
            position: relative;
            width: 100px;
            height: 100px;
            border-radius: 4px;
            overflow: hidden;
            border: 1px solid var(--color-border);
        }

        .preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .preview-item .remove-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(0,0,0,0.7);
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
        }

        /* Canvas Container */
        .canvas-container {
            margin: 1rem 0;
            border: 1px solid var(--color-border);
            border-radius: 4px;
            overflow: hidden;
            max-width: 100%;
        }

        .canvas-container canvas {
            display: block;
            max-width: 100%;
        }

        /* Color Palette */
        .color-palette {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .color-swatch {
            width: 50px;
            height: 50px;
            border-radius: 4px;
            border: 1px solid var(--color-border);
            cursor: pointer;
            position: relative;
        }

        .color-swatch:hover::after {
            content: attr(data-color);
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--color-bg);
            padding: 2px 5px;
            border-radius: 2px;
            font-size: 0.7rem;
            white-space: nowrap;
            border: 1px solid var(--color-border);
        }

        /* Timer Display */
        .timer-display {
            font-size: 3rem;
            font-family: 'Orbitron', monospace;
            text-align: center;
            margin: 1rem 0;
            color: var(--color-accent);
        }

        /* Contrast Checker */
        .contrast-preview {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .contrast-sample {
            flex: 1;
            padding: 1rem;
            border-radius: 4px;
            text-align: center;
            font-weight: bold;
        }

        /* Tool Output */
        .tool-output {
            margin-top: 1.5rem;
            padding: 1rem;
            background-color: var(--color-bg-secondary);
            border-radius: 4px;
            border: 1px solid var(--color-border);
        }

        .tool-output h4 {
            margin-bottom: 0.5rem;
            color: var(--color-accent);
        }

        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 6px;
            background-color: var(--color-border);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--color-accent);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Responsive Styles */
        @media (max-width: 1024px) {
            .main-layout {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                position: static;
                display: none;
            }
            
            .sidebar.active {
                display: block;
            }
            
            .sidebar-toggle {
                display: flex;
            }
            
            .tool-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .hamburger {
                display: flex;
            }
            
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .tool-grid {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .footer-links {
                flex-direction: column;
                gap: 1rem;
            }
        }

        @media (max-width: 480px) {
            .hero h1 {
                font-size: 2rem;
            }
            
            .modal {
                padding: 1.5rem;
            }
            
            .tool-card {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container header-content">
            <a href="#" class="logo">
                <span class="logo-icon">‚ö°</span>
                <span>RUSHL</span>
            </a>
            
            <nav class="nav">
                <ul class="nav-links">
                    <li><a href="#home" class="nav-link">Home</a></li>
                    <li><a href="#about" class="nav-link">About</a></li>
                    <li><a href="#contact" class="nav-link">Contact</a></li>
                </ul>
            </nav>
            
            <div class="header-actions">
                <button class="theme-toggle" id="themeToggle">
                    <span class="sun">‚òÄÔ∏è</span>
                    <span class="moon" style="display: none;">üåô</span>
                </button>
                
                <div class="hamburger" id="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Layout -->
    <div class="main-layout">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <h3>Tool Categories</h3>
            
            <div class="sidebar-category">
                <h4>PDF Tools</h4>
                <div class="sidebar-item" data-category="pdf">Merge PDF</div>
                <div class="sidebar-item" data-category="pdf">Split PDF</div>
                <div class="sidebar-item" data-category="pdf">Image to PDF</div>
            </div>
            
            <div class="sidebar-category">
                <h4>Image Tools</h4>
                <div class="sidebar-item" data-category="image">Image Converter</div>
                <div class="sidebar-item" data-category="image">Image Compressor</div>
                <div class="sidebar-item" data-category="image">Image Cropper</div>
                <div class="sidebar-item" data-category="image">Image Resizer</div>
                <div class="sidebar-item" data-category="image">Image Watermarker</div>
                <div class="sidebar-item" data-category="image">Color Palette Extractor</div>
                <div class="sidebar-item" data-category="image">Favicon Generator</div>
                <div class="sidebar-item" data-category="image">Image Steganography</div>
                <div class="sidebar-item" data-category="image">Merge Images</div>
            </div>
            
            <div class="sidebar-category">
                <h4>Audio & Speech</h4>
                <div class="sidebar-item" data-category="audio">Audio Trimmer</div>
                <div class="sidebar-item" data-category="audio">Text to Speech</div>
                <div class="sidebar-item" data-category="audio">Speech to Text</div>
            </div>
            
            <div class="sidebar-category">
                <h4>Calculators</h4>
                <div class="sidebar-item" data-category="calculator">Age Calculator</div>
                <div class="sidebar-item" data-category="calculator">EMI Calculator</div>
                <div class="sidebar-item" data-category="calculator">SIP Calculator</div>
                <div class="sidebar-item" data-category="calculator">BMI Calculator</div>
                <div class="sidebar-item" data-category="calculator">Unit Price Calculator</div>
            </div>
            
            <div class="sidebar-category">
                <h4>Text Utilities</h4>
                <div class="sidebar-item" data-category="text">Word & Character Counter</div>
                <div class="sidebar-item" data-category="text">Case Converter</div>
                <div class="sidebar-item" data-category="text">Lorem Ipsum Generator</div>
                <div class="sidebar-item" data-category="text">Text Minifier</div>
                <div class="sidebar-item" data-category="text">Text Beautifier</div>
            </div>
            
            <div class="sidebar-category">
                <h4>Developer Tools</h4>
                <div class="sidebar-item" data-category="dev">Password Generator</div>
                <div class="sidebar-item" data-category="dev">QR Code Generator</div>
                <div class="sidebar-item" data-category="dev">JSON Formatter</div>
                <div class="sidebar-item" data-category="dev">Base64 Encoder/Decoder</div>
                <div class="sidebar-item" data-category="dev">CSV/JSON Converter</div>
                <div class="sidebar-item" data-category="dev">Regex Tester</div>
                <div class="sidebar-item" data-category="dev">Hash Generator</div>
                <div class="sidebar-item" data-category="dev">Timer/Stopwatch</div>
                <div class="sidebar-item" data-category="dev">Unit Converter</div>
                <div class="sidebar-item" data-category="dev">Document Scanner</div>
                <div class="sidebar-item" data-category="dev">Color Picker & Contrast Checker</div>
            </div>
        </aside>
        
        <button class="sidebar-toggle" id="sidebarToggle">‚ò∞</button>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Hero Section -->
            <section class="hero" id="home">
                <h1>Welcome to RUSHL</h1>
                <p>Your complete client-side toolkit with 35+ powerful tools for PDFs, images, audio, text, and development.</p>
                
                <div class="search-container">
                    <input type="text" class="search-bar" id="searchBar" placeholder="Search for tools...">
                    <span class="search-icon">üîç</span>
                </div>
            </section>

            <!-- Tool Grid -->
            <section class="tool-grid" id="toolGrid">
                <!-- Tools will be dynamically generated here -->
            </section>

            <!-- About Section -->
            <section class="section" id="about">
                <h2>About Us</h2>
                <div class="section-content">
                    <p>Welcome to ALL IN ONE TOOL ‚Äì RUSHL, your ultimate destination for a comprehensive suite of online utilities designed to simplify your digital life. We understand that in today's fast-paced world, efficiency and convenience are paramount. That's why we've created a powerful, all-in-one platform that brings together a wide array of tools to meet your diverse needs.</p>
                    <p>At RUSHL, we believe in providing high-quality, reliable tools that are accessible to everyone. Our mission is to empower individuals, professionals, and businesses by offering seamless solutions that enhance productivity and creativity. Whether you're working with documents, images, audio, or code, RUSHL has you covered.</p>
                </div>
            </section>

            <!-- Contact Section -->
            <section class="section" id="contact">
                <h2>Contact Us</h2>
                <div class="section-content">
                    <p>Have a question, suggestion, or need support? We'd love to hear from you! Our team is dedicated to providing the best experience possible and is always ready to assist you with any inquiries or feedback.</p>
                    <p>Email: nikkipandey392@gmail.com</p>
                </div>
            </section>
        </main>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container footer-content">
            <p>¬© 2025 RUSHL. All Rights Reserved.</p>
            
            <div class="footer-links">
                <a href="#" class="footer-link">Privacy Policy</a>
                <a href="#" class="footer-link">Terms of Service</a>
            </div>
            
            <div class="social-icons">
                <a href="#" class="social-icon">G</a>
                <a href="#" class="social-icon">T</a>
                <a href="#" class="social-icon">L</a>
            </div>
        </div>
    </footer>

    <!-- Scroll to Top -->
    <button class="scroll-to-top" id="scrollToTop">‚Üë</button>

    <!-- Modals will be dynamically generated here -->
    <div id="modalContainer"></div>

    <script>
        // Tool Data
        const tools = [
            // PDF Tools
            { id: 'merge-pdf', name: 'Merge PDF', category: 'pdf', icon: 'üìÑ', description: 'Combine multiple PDF files into a single document.' },
            { id: 'split-pdf', name: 'Split PDF', category: 'pdf', icon: '‚úÇÔ∏è', description: 'Extract specific pages or split PDF into multiple files.' },
            { id: 'image-to-pdf', name: 'Image to PDF', category: 'pdf', icon: 'üñºÔ∏è', description: 'Convert images to PDF format with customizable settings.' },
            
            // Image Tools
            { id: 'image-converter', name: 'Image Converter', category: 'image', icon: 'üîÑ', description: 'Convert images between different formats (PNG, JPEG, WebP).' },
            { id: 'image-compressor', name: 'Image Compressor', category: 'image', icon: 'üóúÔ∏è', description: 'Reduce image file size while maintaining quality.' },
            { id: 'image-cropper', name: 'Image Cropper', category: 'image', icon: '‚úÇÔ∏è', description: 'Crop images to your desired dimensions.' },
            { id: 'image-resizer', name: 'Image Resizer', category: 'image', icon: 'üìè', description: 'Resize images with aspect ratio preservation.' },
            { id: 'image-watermarker', name: 'Image Watermarker', category: 'image', icon: 'üíß', description: 'Add text or image watermarks to your photos.' },
            { id: 'color-palette', name: 'Color Palette Extractor', category: 'image', icon: 'üé®', description: 'Extract dominant colors from any image.' },
            { id: 'favicon-generator', name: 'Favicon Generator', category: 'image', icon: 'üåê', description: 'Create favicons in multiple sizes from a single image.' },
            { id: 'image-steganography', name: 'Image Steganography', category: 'image', icon: 'üîí', description: 'Hide and extract secret messages in images.' },
            { id: 'merge-images', name: 'Merge Images', category: 'image', icon: 'üñºÔ∏è', description: 'Combine multiple images into a single image.' },
            
            // Audio & Speech Tools
            { id: 'audio-trimmer', name: 'Audio Trimmer', category: 'audio', icon: '‚úÇÔ∏è', description: 'Trim audio files to your desired length.' },
            { id: 'text-to-speech', name: 'Text to Speech', category: 'audio', icon: 'üîä', description: 'Convert text to natural-sounding speech.' },
            { id: 'speech-to-text', name: 'Speech to Text', category: 'audio', icon: 'üé§', description: 'Transcribe speech to text in real-time.' },
            
            // Calculators
            { id: 'age-calculator', name: 'Age Calculator', category: 'calculator', icon: 'üéÇ', description: 'Calculate age in years, months, and days.' },
            { id: 'emi-calculator', name: 'EMI Calculator', category: 'calculator', icon: 'üí∞', description: 'Calculate Equated Monthly Installments for loans.' },
            { id: 'sip-calculator', name: 'SIP Calculator', category: 'calculator', icon: 'üìà', description: 'Calculate returns on Systematic Investment Plans.' },
            { id: 'bmi-calculator', name: 'BMI Calculator', category: 'calculator', icon: '‚öñÔ∏è', description: 'Calculate Body Mass Index and health classification.' },
            { id: 'unit-price-calculator', name: 'Unit Price Calculator', category: 'calculator', icon: 'üè∑Ô∏è', description: 'Compare prices to find the best value.' },
            
            // Text Utilities
            { id: 'word-counter', name: 'Word & Character Counter', category: 'text', icon: 'üìù', description: 'Count words, characters, sentences, and more.' },
            { id: 'case-converter', name: 'Case Converter', category: 'text', icon: 'üîÑ', description: 'Convert text between different cases (upper, lower, title).' },
            { id: 'lorem-ipsum', name: 'Lorem Ipsum Generator', category: 'text', icon: 'üìÑ', description: 'Generate placeholder text for your projects.' },
            { id: 'text-minifier', name: 'Text Minifier', category: 'text', icon: 'üóúÔ∏è', description: 'Minify HTML, CSS, and JavaScript code.' },
            { id: 'text-beautifier', name: 'Text Beautifier', category: 'text', icon: '‚ú®', description: 'Format and beautify code with proper indentation.' },
            
            // Developer Tools
            { id: 'password-generator', name: 'Password Generator', category: 'dev', icon: 'üîë', description: 'Generate strong, secure passwords.' },
            { id: 'qr-generator', name: 'QR Code Generator', category: 'dev', icon: 'üì±', description: 'Create QR codes for URLs, text, and more.' },
            { id: 'json-formatter', name: 'JSON Formatter', category: 'dev', icon: '{}', description: 'Format and validate JSON data.' },
            { id: 'base64-converter', name: 'Base64 Encoder/Decoder', category: 'dev', icon: 'üî§', description: 'Encode and decode Base64 strings.' },
            { id: 'csv-json-converter', name: 'CSV/JSON Converter', category: 'dev', icon: 'üîÑ', description: 'Convert between CSV and JSON formats.' },
            { id: 'regex-tester', name: 'Regex Tester', category: 'dev', icon: '.*', description: 'Test and debug regular expressions.' },
            { id: 'hash-generator', name: 'Hash Generator', category: 'dev', icon: 'üî¢', description: 'Generate MD5, SHA-1, SHA-256 hashes.' },
            { id: 'timer-stopwatch', name: 'Timer/Stopwatch', category: 'dev', icon: '‚è±Ô∏è', description: 'Countdown timer and stopwatch with laps.' },
            { id: 'unit-converter', name: 'Unit Converter', category: 'dev', icon: 'üìä', description: 'Convert between various units of measurement.' },
            { id: 'document-scanner', name: 'Document Scanner', category: 'dev', icon: 'üìÑ', description: 'Enhance document photos with filters.' },
            { id: 'color-picker', name: 'Color Picker & Contrast Checker', category: 'dev', icon: 'üé®', description: 'Pick colors and check accessibility contrast.' }
        ];

        // DOM Elements
        const themeToggle = document.getElementById('themeToggle');
        const hamburger = document.getElementById('hamburger');
        const sidebar = document.getElementById('sidebar');
        const sidebarToggle = document.getElementById('sidebarToggle');
        const searchBar = document.getElementById('searchBar');
        const toolGrid = document.getElementById('toolGrid');
        const modalContainer = document.getElementById('modalContainer');
        const scrollToTop = document.getElementById('scrollToTop');
        const navLinks = document.querySelectorAll('.nav-link');
        const sidebarItems = document.querySelectorAll('.sidebar-item');

        // Initialize the application
        function init() {
            // Render tool grid
            renderToolGrid(tools);
            
            // Set up event listeners
            setupEventListeners();
            
            // Check for saved theme preference
            checkSavedTheme();
        }

        // Render the tool grid
        function renderToolGrid(toolsToRender) {
            toolGrid.innerHTML = '';
            
            toolsToRender.forEach(tool => {
                const toolCard = document.createElement('div');
                toolCard.className = 'tool-card';
                toolCard.innerHTML = `
                    <div class="tool-icon">${tool.icon}</div>
                    <h3>${tool.name}</h3>
                    <p>${tool.description}</p>
                    <button class="tool-button" data-tool="${tool.id}">Open Tool</button>
                `;
                toolGrid.appendChild(toolCard);
            });
            
            // Add event listeners to tool buttons
            document.querySelectorAll('.tool-button').forEach(button => {
                button.addEventListener('click', function() {
                    const toolId = this.getAttribute('data-tool');
                    openToolModal(toolId);
                });
            });
        }

        // Set up event listeners
        function setupEventListeners() {
            // Theme toggle
            themeToggle.addEventListener('click', toggleTheme);
            
            // Hamburger menu
            hamburger.addEventListener('click', toggleMobileMenu);
            
            // Sidebar toggle
            sidebarToggle.addEventListener('click', toggleSidebar);
            
            // Search functionality
            searchBar.addEventListener('input', filterTools);
            
            // Scroll to top
            scrollToTop.addEventListener('click', scrollToTopFunction);
            
            // Smooth scrolling for navigation links
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    
                    if (targetElement) {
                        targetElement.scrollIntoView({ behavior: 'smooth' });
                        
                        // Close mobile menu if open
                        if (window.innerWidth <= 768) {
                            toggleMobileMenu();
                        }
                    }
                });
            });
            
            // Sidebar category filtering
            sidebarItems.forEach(item => {
                item.addEventListener('click', function() {
                    const category = this.getAttribute('data-category');
                    filterByCategory(category);
                    
                    // Update active state
                    sidebarItems.forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Close sidebar on mobile
                    if (window.innerWidth <= 1024) {
                        sidebar.classList.remove('active');
                    }
                });
            });
            
            // Show/hide scroll to top button based on scroll position
            window.addEventListener('scroll', toggleScrollToTop);
        }

        // Toggle theme between light and dark
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            
            // Update toggle button icons
            const sun = themeToggle.querySelector('.sun');
            const moon = themeToggle.querySelector('.moon');
            
            if (document.body.classList.contains('dark-mode')) {
                sun.style.display = 'none';
                moon.style.display = 'block';
                localStorage.setItem('theme', 'dark');
            } else {
                sun.style.display = 'block';
                moon.style.display = 'none';
                localStorage.setItem('theme', 'light');
            }
        }

        // Check for saved theme preference
        function checkSavedTheme() {
            const savedTheme = localStorage.getItem('theme');
            
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                themeToggle.querySelector('.sun').style.display = 'none';
                themeToggle.querySelector('.moon').style.display = 'block';
            }
        }

        // Toggle mobile menu
        function toggleMobileMenu() {
            const navLinks = document.querySelector('.nav-links');
            navLinks.style.display = navLinks.style.display === 'flex' ? 'none' : 'flex';
            
            // Animate hamburger
            hamburger.classList.toggle('active');
        }

        // Toggle sidebar
        function toggleSidebar() {
            sidebar.classList.toggle('active');
        }

        // Filter tools based on search input
        function filterTools() {
            const searchTerm = searchBar.value.toLowerCase();
            
            if (searchTerm === '') {
                renderToolGrid(tools);
                return;
            }
            
            const filteredTools = tools.filter(tool => 
                tool.name.toLowerCase().includes(searchTerm) || 
                tool.description.toLowerCase().includes(searchTerm)
            );
            
            renderToolGrid(filteredTools);
        }

        // Filter tools by category
        function filterByCategory(category) {
            if (category === 'all') {
                renderToolGrid(tools);
                return;
            }
            
            const filteredTools = tools.filter(tool => tool.category === category);
            renderToolGrid(filteredTools);
            
            // Scroll to tool grid
            document.getElementById('toolGrid').scrollIntoView({ behavior: 'smooth' });
        }

        // Scroll to top function
        function scrollToTopFunction() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Show/hide scroll to top button
        function toggleScrollToTop() {
            if (window.pageYOffset > 300) {
                scrollToTop.classList.add('active');
            } else {
                scrollToTop.classList.remove('active');
            }
        }

        // Open tool modal
        function openToolModal(toolId) {
            const tool = tools.find(t => t.id === toolId);
            if (!tool) return;
            
            // Create modal HTML based on tool type
            let modalHTML = '';
            
            switch (toolId) {
                case 'merge-pdf':
                    modalHTML = createPdfMergeModal(tool);
                    break;
                case 'split-pdf':
                    modalHTML = createPdfSplitModal(tool);
                    break;
                case 'image-to-pdf':
                    modalHTML = createImageToPdfModal(tool);
                    break;
                case 'image-converter':
                    modalHTML = createImageConverterModal(tool);
                    break;
                case 'image-compressor':
                    modalHTML = createImageCompressorModal(tool);
                    break;
                case 'image-cropper':
                    modalHTML = createImageCropperModal(tool);
                    break;
                case 'image-resizer':
                    modalHTML = createImageResizerModal(tool);
                    break;
                case 'image-watermarker':
                    modalHTML = createImageWatermarkerModal(tool);
                    break;
                case 'color-palette':
                    modalHTML = createColorPaletteModal(tool);
                    break;
                case 'favicon-generator':
                    modalHTML = createFaviconGeneratorModal(tool);
                    break;
                case 'image-steganography':
                    modalHTML = createImageSteganographyModal(tool);
                    break;
                case 'merge-images':
                    modalHTML = createMergeImagesModal(tool);
                    break;
                case 'audio-trimmer':
                    modalHTML = createAudioTrimmerModal(tool);
                    break;
                case 'text-to-speech':
                    modalHTML = createTextToSpeechModal(tool);
                    break;
                case 'speech-to-text':
                    modalHTML = createSpeechToTextModal(tool);
                    break;
                case 'age-calculator':
                    modalHTML = createAgeCalculatorModal(tool);
                    break;
                case 'emi-calculator':
                    modalHTML = createEmiCalculatorModal(tool);
                    break;
                case 'sip-calculator':
                    modalHTML = createSipCalculatorModal(tool);
                    break;
                case 'bmi-calculator':
                    modalHTML = createBmiCalculatorModal(tool);
                    break;
                case 'unit-price-calculator':
                    modalHTML = createUnitPriceCalculatorModal(tool);
                    break;
                case 'word-counter':
                    modalHTML = createWordCounterModal(tool);
                    break;
                case 'case-converter':
                    modalHTML = createCaseConverterModal(tool);
                    break;
                case 'lorem-ipsum':
                    modalHTML = createLoremIpsumModal(tool);
                    break;
                case 'text-minifier':
                    modalHTML = createTextMinifierModal(tool);
                    break;
                case 'text-beautifier':
                    modalHTML = createTextBeautifierModal(tool);
                    break;
                case 'password-generator':
                    modalHTML = createPasswordGeneratorModal(tool);
                    break;
                case 'qr-generator':
                    modalHTML = createQrGeneratorModal(tool);
                    break;
                case 'json-formatter':
                    modalHTML = createJsonFormatterModal(tool);
                    break;
                case 'base64-converter':
                    modalHTML = createBase64ConverterModal(tool);
                    break;
                case 'csv-json-converter':
                    modalHTML = createCsvJsonConverterModal(tool);
                    break;
                case 'regex-tester':
                    modalHTML = createRegexTesterModal(tool);
                    break;
                case 'hash-generator':
                    modalHTML = createHashGeneratorModal(tool);
                    break;
                case 'timer-stopwatch':
                    modalHTML = createTimerStopwatchModal(tool);
                    break;
                case 'unit-converter':
                    modalHTML = createUnitConverterModal(tool);
                    break;
                case 'document-scanner':
                    modalHTML = createDocumentScannerModal(tool);
                    break;
                case 'color-picker':
                    modalHTML = createColorPickerModal(tool);
                    break;
                default:
                    modalHTML = createDefaultModal(tool);
                    break;
            }
            
            // Create modal overlay
            const modalOverlay = document.createElement('div');
            modalOverlay.className = 'modal-overlay';
            modalOverlay.innerHTML = modalHTML;
            
            // Add to DOM
            modalContainer.innerHTML = '';
            modalContainer.appendChild(modalOverlay);
            
            // Show modal
            setTimeout(() => {
                modalOverlay.classList.add('active');
            }, 10);
            
            // Set up modal event listeners
            setupModalEventListeners(modalOverlay, toolId);
        }

        // Set up modal event listeners
        function setupModalEventListeners(modalOverlay, toolId) {
            // Close modal when clicking overlay or close button
            modalOverlay.addEventListener('click', function(e) {
                if (e.target === modalOverlay || e.target.classList.contains('modal-close')) {
                    closeModal(modalOverlay);
                }
            });
            
            // Set up tool-specific functionality
            switch (toolId) {
                case 'merge-pdf':
                    setupPdfMergeTool(modalOverlay);
                    break;
                case 'split-pdf':
                    setupPdfSplitTool(modalOverlay);
                    break;
                case 'image-to-pdf':
                    setupImageToPdfTool(modalOverlay);
                    break;
                case 'image-converter':
                    setupImageConverterTool(modalOverlay);
                    break;
                case 'image-compressor':
                    setupImageCompressorTool(modalOverlay);
                    break;
                case 'image-cropper':
                    setupImageCropperTool(modalOverlay);
                    break;
                case 'image-resizer':
                    setupImageResizerTool(modalOverlay);
                    break;
                case 'image-watermarker':
                    setupImageWatermarkerTool(modalOverlay);
                    break;
                case 'color-palette':
                    setupColorPaletteTool(modalOverlay);
                    break;
                case 'favicon-generator':
                    setupFaviconGeneratorTool(modalOverlay);
                    break;
                case 'image-steganography':
                    setupImageSteganographyTool(modalOverlay);
                    break;
                case 'merge-images':
                    setupMergeImagesTool(modalOverlay);
                    break;
                case 'audio-trimmer':
                    setupAudioTrimmerTool(modalOverlay);
                    break;
                case 'text-to-speech':
                    setupTextToSpeechTool(modalOverlay);
                    break;
                case 'speech-to-text':
                    setupSpeechToTextTool(modalOverlay);
                    break;
                case 'age-calculator':
                    setupAgeCalculatorTool(modalOverlay);
                    break;
                case 'emi-calculator':
                    setupEmiCalculatorTool(modalOverlay);
                    break;
                case 'sip-calculator':
                    setupSipCalculatorTool(modalOverlay);
                    break;
                case 'bmi-calculator':
                    setupBmiCalculatorTool(modalOverlay);
                    break;
                case 'unit-price-calculator':
                    setupUnitPriceCalculatorTool(modalOverlay);
                    break;
                case 'word-counter':
                    setupWordCounterTool(modalOverlay);
                    break;
                case 'case-converter':
                    setupCaseConverterTool(modalOverlay);
                    break;
                case 'lorem-ipsum':
                    setupLoremIpsumTool(modalOverlay);
                    break;
                case 'text-minifier':
                    setupTextMinifierTool(modalOverlay);
                    break;
                case 'text-beautifier':
                    setupTextBeautifierTool(modalOverlay);
                    break;
                case 'password-generator':
                    setupPasswordGeneratorTool(modalOverlay);
                    break;
                case 'qr-generator':
                    setupQrGeneratorTool(modalOverlay);
                    break;
                case 'json-formatter':
                    setupJsonFormatterTool(modalOverlay);
                    break;
                case 'base64-converter':
                    setupBase64ConverterTool(modalOverlay);
                    break;
                case 'csv-json-converter':
                    setupCsvJsonConverterTool(modalOverlay);
                    break;
                case 'regex-tester':
                    setupRegexTesterTool(modalOverlay);
                    break;
                case 'hash-generator':
                    setupHashGeneratorTool(modalOverlay);
                    break;
                case 'timer-stopwatch':
                    setupTimerStopwatchTool(modalOverlay);
                    break;
                case 'unit-converter':
                    setupUnitConverterTool(modalOverlay);
                    break;
                case 'document-scanner':
                    setupDocumentScannerTool(modalOverlay);
                    break;
                case 'color-picker':
                    setupColorPickerTool(modalOverlay);
                    break;
            }
        }

        // Close modal
        function closeModal(modalOverlay) {
            modalOverlay.classList.remove('active');
            setTimeout(() => {
                modalOverlay.remove();
            }, 300);
        }

        // ===========================================
        // MODAL TEMPLATES
        // ===========================================

        // pdf merge Modal
        function createPdfMergeModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Upload PDF Files</label>
                                <div class="file-upload" id="pdfUploadArea">
                                    <p>Drag & drop PDF files here or click to browse</p>
                                    <input type="file" class="file-input" id="pdfFiles" multiple accept=".pdf">
                                </div>
                                <div id="fileList"></div>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="mergePdfBtn">Merge PDFs</button>
                                <button class="secondary-button" id="resetPdfBtn">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
 
        // Pdf split Modal
         function createPdfSplitModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Upload PDF File</label>
                                <div class="file-upload" id="pdfUploadArea">
                                    <p>Drag & drop a PDF file here or click to browse</p>
                                    <input type="file" class="file-input" id="pdfFile" accept=".pdf">
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Page Range (e.g., 1-3, 5, 7-10)</label>
                                <input type="text" id="pageRange" placeholder="1-5">
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="splitPdfBtn">Split PDF</button>
                                <button class="secondary-button" id="resetSplitBtn">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Image to PDF Modal
        function createImageToPdfModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Upload Images</label>
                                <div class="file-upload" id="imageUploadArea">
                                    <p>Drag & drop images here or click to browse</p>
                                    <input type="file" class="file-input" id="imageFiles" multiple accept="image/*">
                                </div>
                                <div id="imagePreview"></div>
                            </div>
                            <div class="input-group">
                                <label>Page Size</label>
                                <select id="pageSize">
                                    <option value="a4">A4</option>
                                    <option value="letter">Letter</option>
                                    <option value="legal">Legal</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>Orientation</label>
                                <select id="pageOrientation">
                                    <option value="portrait">Portrait</option>
                                    <option value="landscape">Landscape</option>
                                </select>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="convertToPdfBtn">Convert to PDF</button>
                                <button class="secondary-button" id="resetImageBtn">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Image Converter Modal
               function createImageConverterModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Upload Image</label>
                                <div class="file-upload" id="imageUploadArea">
                                    <p>Drag & drop an image here or click to browse</p>
                                    <input type="file" class="file-input" id="imageFile" accept="image/*">
                                </div>
                                <div id="imagePreview"></div>
                            </div>
                            <div class="input-group">
                                <label>Convert To</label>
                                <select id="outputFormat">
                                    <option value="png">PNG</option>
                                    <option value="jpeg">JPEG</option>
                                    <option value="webp">WebP</option>
                                </select>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="convertImageBtn">Convert Image</button>
                                <button class="secondary-button" id="resetConvertBtn">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Image Compressor Modal
               function createImageCompressorModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Upload Image</label>
                                <div class="file-upload" id="imageUploadArea">
                                    <p>Drag & drop an image here or click to browse</p>
                                    <input type="file" class="file-input" id="imageFile" accept="image/*">
                                </div>
                                <div id="imagePreview"></div>
                            </div>
                            <div class="range-group">
                                <label>Compression Quality</label>
                                <input type="range" id="compressionQuality" min="0" max="100" value="80">
                                <span class="range-value" id="qualityValue">80%</span>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="compressImageBtn">Compress Image</button>
                                <button class="secondary-button" id="resetCompressBtn">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }


        // Image Cropper Modal
        function createImageCropperModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Upload Image</label>
                                <div class="file-upload" id="imageUploadArea">
                                    <p>Drag & drop an image here or click to browse</p>
                                    <input type="file" class="file-input" id="imageFile" accept="image/*">
                                </div>
                            </div>
                            <div class="canvas-container">
                                <canvas id="cropCanvas"></canvas>
                            </div>
                            <div class="input-group">
                                <label>Crop Dimensions</label>
                                <div style="display: flex; gap: 10px;">
                                    <input type="number" id="cropWidth" placeholder="Width" style="flex: 1;">
                                    <input type="number" id="cropHeight" placeholder="Height" style="flex: 1;">
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Crop Position</label>
                                <div style="display: flex; gap: 10px;">
                                    <input type="number" id="cropX" placeholder="X" style="flex: 1;" value="0">
                                    <input type="number" id="cropY" placeholder="Y" style="flex: 1;" value="0">
                                </div>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="cropImageBtn">Crop Image</button>
                                <button class="secondary-button" id="resetCropBtn">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Image Resizer Modal
        function createImageResizerModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Upload Image</label>
                                <div class="file-upload" id="imageUploadArea">
                                    <p>Drag & drop an image here or click to browse</p>
                                    <input type="file" class="file-input" id="imageFile" accept="image/*">
                                </div>
                            </div>
                            <div class="input-group">
                                <label>New Width</label>
                                <input type="number" id="resizeWidth" placeholder="Enter width in pixels">
                            </div>
                            <div class="input-group">
                                <label>New Height</label>
                                <input type="number" id="resizeHeight" placeholder="Enter height in pixels">
                            </div>
                            <div class="input-group">
                                <label>
                                    <input type="checkbox" id="maintainAspect" checked>
                                    Maintain Aspect Ratio
                                </label>
                            </div>
                            <div class="input-group">
                                <label>Resize Quality</label>
                                <select id="resizeQuality">
                                    <option value="high">High</option>
                                    <option value="medium" selected>Medium</option>
                                    <option value="low">Low</option>
                                </select>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="resizeImageBtn">Resize Image</button>
                                <button class="secondary-button" id="resetResizeBtn">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Image Watermarker Modal
        function createImageWatermarkerModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Upload Image</label>
                                <div class="file-upload" id="imageUploadArea">
                                    <p>Drag & drop an image here or click to browse</p>
                                    <input type="file" class="file-input" id="imageFile" accept="image/*">
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Watermark Type</label>
                                <select id="watermarkType">
                                    <option value="text">Text Watermark</option>
                                    <option value="image">Image Watermark</option>
                                </select>
                            </div>
                            <div id="textWatermarkOptions">
                                <div class="input-group">
                                    <label>Watermark Text</label>
                                    <input type="text" id="watermarkText" placeholder="Enter watermark text">
                                </div>
                                <div class="input-group">
                                    <label>Text Color</label>
                                    <input type="color" id="textColor" value="#ffffff">
                                </div>
                                <div class="input-group">
                                    <label>Text Size</label>
                                    <input type="range" id="textSize" min="10" max="100" value="30">
                                    <span class="range-value" id="textSizeValue">30px</span>
                                </div>
                                <div class="input-group">
                                    <label>Font Family</label>
                                    <select id="textFont">
                                        <option value="Arial">Arial</option>
                                        <option value="Helvetica">Helvetica</option>
                                        <option value="Times New Roman">Times New Roman</option>
                                        <option value="Courier New">Courier New</option>
                                        <option value="Verdana">Verdana</option>
                                    </select>
                                </div>
                            </div>
                            <div id="imageWatermarkOptions" style="display: none;">
                                <div class="input-group">
                                    <label>Upload Watermark Image</label>
                                    <div class="file-upload" id="watermarkUploadArea">
                                        <p>Drag & drop watermark image here</p>
                                        <input type="file" class="file-input" id="watermarkFile" accept="image/*">
                                    </div>
                                </div>
                                <div class="input-group">
                                    <label>Watermark Size (%)</label>
                                    <input type="range" id="watermarkSize" min="5" max="50" value="20">
                                    <span class="range-value" id="watermarkSizeValue">20%</span>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Opacity</label>
                                <input type="range" id="watermarkOpacity" min="0" max="100" value="50">
                                <span class="range-value" id="opacityValue">50%</span>
                            </div>
                            <div class="input-group">
                                <label>Position</label>
                                <select id="watermarkPosition">
                                    <option value="top-left">Top Left</option>
                                    <option value="top-right">Top Right</option>
                                    <option value="bottom-left">Bottom Left</option>
                                    <option value="bottom-right">Bottom Right</option>
                                    <option value="center">Center</option>
                                    <option value="tile">Tile (Repeat)</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>Rotation (degrees)</label>
                                <input type="range" id="watermarkRotation" min="0" max="360" value="0">
                                <span class="range-value" id="rotationValue">0¬∞</span>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="addWatermarkBtn">Add Watermark</button>
                                <button class="secondary-button" id="resetWatermarkBtn">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Color Palette Extractor Modal
        function createColorPaletteModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Upload Image</label>
                                <div class="file-upload" id="imageUploadArea">
                                    <p>Drag & drop an image here or click to browse</p>
                                    <input type="file" class="file-input" id="imageFile" accept="image/*">
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Number of Colors</label>
                                <input type="number" id="colorCount" min="1" max="20" value="5">
                            </div>
                            <div class="input-group">
                                <label>Color Extraction Method</label>
                                <select id="extractionMethod">
                                    <option value="dominant">Dominant Colors</option>
                                    <option value="vibrant">Vibrant Colors</option>
                                    <option value="muted">Muted Colors</option>
                                </select>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="extractColorsBtn">Extract Colors</button>
                                <button class="secondary-button" id="resetPaletteBtn">Reset</button>
                            </div>
                            <div id="colorPaletteResult" class="color-palette"></div>
                            <div class="tool-output" id="colorCodesOutput" style="display: none;">
                                <h4>Color Codes</h4>
                                <div id="colorCodes"></div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Favicon Generator Modal
        function createFaviconGeneratorModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Upload Image</label>
                                <div class="file-upload" id="imageUploadArea">
                                    <p>Drag & drop an image here or click to browse</p>
                                    <input type="file" class="file-input" id="imageFile" accept="image/*">
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Favicon Sizes</label>
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                                    <label><input type="checkbox" name="faviconSize" value="16" checked> 16x16</label>
                                    <label><input type="checkbox" name="faviconSize" value="32" checked> 32x32</label>
                                    <label><input type="checkbox" name="faviconSize" value="48" checked> 48x48</label>
                                    <label><input type="checkbox" name="faviconSize" value="64"> 64x64</label>
                                    <label><input type="checkbox" name="faviconSize" value="128"> 128x128</label>
                                    <label><input type="checkbox" name="faviconSize" value="256"> 256x256</label>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Background</label>
                                <select id="faviconBackground">
                                    <option value="transparent">Transparent</option>
                                    <option value="white">White</option>
                                    <option value="black">Black</option>
                                    <option value="custom">Custom Color</option>
                                </select>
                            </div>
                            <div class="input-group" id="customColorContainer" style="display: none;">
                                <label>Custom Background Color</label>
                                <input type="color" id="customBgColor" value="#ffffff">
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="generateFaviconBtn">Generate Favicon</button>
                                <button class="secondary-button" id="resetFaviconBtn">Reset</button>
                            </div>
                            <div class="tool-output" id="faviconOutput" style="display: none;">
                                <h4>Generated Favicons</h4>
                                <div id="faviconPreview"></div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Image Steganography Modal
        function createImageSteganographyModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Mode</label>
                                <select id="stegMode">
                                    <option value="encode">Encode Message</option>
                                    <option value="decode">Decode Message</option>
                                </select>
                            </div>
                            <div id="encodeOptions">
                                <div class="input-group">
                                    <label>Upload Image</label>
                                    <div class="file-upload" id="imageUploadArea">
                                        <p>Drag & drop an image here or click to browse</p>
                                        <input type="file" class="file-input" id="imageFile" accept="image/*">
                                    </div>
                                </div>
                                <div class="input-group">
                                    <label>Secret Message</label>
                                    <textarea id="secretMessage" placeholder="Enter message to hide" rows="4"></textarea>
                                </div>
                                <div class="input-group">
                                    <label>Password (optional)</label>
                                    <input type="password" id="encodePassword" placeholder="Enter password for encryption">
                                </div>
                                <div class="button-group">
                                    <button class="primary-button" id="encodeMessageBtn">Encode Message</button>
                                </div>
                            </div>
                            <div id="decodeOptions" style="display: none;">
                                <div class="input-group">
                                    <label>Upload Steganographic Image</label>
                                    <div class="file-upload" id="stegImageUploadArea">
                                        <p>Drag & drop an image with hidden message</p>
                                        <input type="file" class="file-input" id="stegImageFile" accept="image/*">
                                    </div>
                                </div>
                                <div class="input-group">
                                    <label>Password (if used during encoding)</label>
                                    <input type="password" id="decodePassword" placeholder="Enter password">
                                </div>
                                <div class="button-group">
                                    <button class="primary-button" id="decodeMessageBtn">Decode Message</button>
                                </div>
                                <div class="input-group">
                                    <label>Extracted Message</label>
                                    <textarea id="extractedMessage" placeholder="Extracted message will appear here" rows="4" readonly></textarea>
                                </div>
                            </div>
                            <div class="button-group">
                                <button class="secondary-button" id="resetStegBtn">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Merge Images Modal
        function createMergeImagesModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Upload Images</label>
                                <div class="file-upload" id="imageUploadArea">
                                    <p>Drag & drop images here or click to browse</p>
                                    <input type="file" class="file-input" id="imageFiles" multiple accept="image/*">
                                </div>
                                <div id="imagePreview"></div>
                            </div>
                            <div class="input-group">
                                <label>Layout</label>
                                <select id="mergeLayout">
                                    <option value="horizontal">Horizontal</option>
                                    <option value="vertical">Vertical</option>
                                    <option value="grid">Grid</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>Spacing (pixels)</label>
                                <input type="number" id="mergeSpacing" min="0" max="100" value="10">
                            </div>
                            <div class="input-group">
                                <label>Background Color</label>
                                <input type="color" id="mergeBgColor" value="#ffffff">
                            </div>
                            <div class="input-group">
                                <label>Output Format</label>
                                <select id="mergeFormat">
                                    <option value="png">PNG</option>
                                    <option value="jpeg">JPEG</option>
                                    <option value="webp">WebP</option>
                                </select>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="mergeImagesBtn">Merge Images</button>
                                <button class="secondary-button" id="resetMergeBtn">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Audio Trimmer Modal
        function createAudioTrimmerModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Upload Audio File</label>
                                <div class="file-upload" id="audioUploadArea">
                                    <p>Drag & drop an audio file here or click to browse</p>
                                    <input type="file" class="file-input" id="audioFile" accept="audio/*">
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Audio Player</label>
                                <audio id="audioPlayer" controls style="width: 100%;"></audio>
                            </div>
                            <div class="range-group">
                                <label>Start Time (seconds)</label>
                                <input type="range" id="startTime" min="0" max="100" value="0" step="0.1">
                                <span class="range-value" id="startTimeValue">0s</span>
                            </div>
                            <div class="range-group">
                                <label>End Time (seconds)</label>
                                <input type="range" id="endTime" min="0" max="100" value="0" step="0.1">
                                <span class="range-value" id="endTimeValue">0s</span>
                            </div>
                            <div class="input-group">
                                <label>Output Format</label>
                                <select id="audioFormat">
                                    <option value="mp3">MP3</option>
                                    <option value="wav">WAV</option>
                                    <option value="ogg">OGG</option>
                                </select>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="trimAudioBtn">Trim Audio</button>
                                <button class="secondary-button" id="resetAudioBtn">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Text to Speech Modal
        function createTextToSpeechModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Text to Convert</label>
                                <textarea id="ttsText" placeholder="Enter text to convert to speech..." rows="6"></textarea>
                            </div>
                            <div class="input-group">
                                <label>Voice</label>
                                <select id="ttsVoice">
                                    <option value="">Default Voice</option>
                                </select>
                            </div>
                            <div class="range-group">
                                <label>Rate</label>
                                <input type="range" id="ttsRate" min="0.5" max="2" step="0.1" value="1">
                                <span class="range-value" id="rateValue">1.0</span>
                            </div>
                            <div class="range-group">
                                <label>Pitch</label>
                                <input type="range" id="ttsPitch" min="0.5" max="2" step="0.1" value="1">
                                <span class="range-value" id="pitchValue">1.0</span>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="speakBtn">Speak</button>
                                <button class="secondary-button" id="pauseBtn">Pause</button>
                                <button class="secondary-button" id="resumeBtn">Resume</button>
                                <button class="secondary-button" id="stopBtn">Stop</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }


        // Speech to Text Modal
        function createSpeechToTextModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Language</label>
                                <select id="recognitionLanguage">
                                    <option value="en-US">English (US)</option>
                                    <option value="en-GB">English (UK)</option>
                                    <option value="es-ES">Spanish</option>
                                    <option value="fr-FR">French</option>
                                    <option value="de-DE">German</option>
                                    <option value="hi-IN">Hindi</option>
                                    <option value="ja-JP">Japanese</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>Speech Recognition Mode</label>
                                <select id="recognitionMode">
                                    <option value="continuous">Continuous</option>
                                    <option value="single">Single Utterance</option>
                                </select>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="startRecognitionBtn">Start Recognition</button>
                                <button class="secondary-button" id="stopRecognitionBtn">Stop Recognition</button>
                            </div>
                            <div class="input-group">
                                <label>Transcription</label>
                                <textarea id="transcriptionResult" placeholder="Speech will be transcribed here..." rows="6" readonly></textarea>
                            </div>
                            <div class="button-group">
                                <button class="secondary-button" id="copyTranscriptionBtn">Copy to Clipboard</button>
                                <button class="secondary-button" id="clearTranscriptionBtn">Clear</button>
                                <button class="secondary-button" id="resetRecognitionBtn">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Age Calculator Modal
           function createAgeCalculatorModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Birth Date</label>
                                <input type="date" id="birthDate">
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="calculateAgeBtn">Calculate Age</button>
                                <button class="secondary-button" id="resetAgeBtn">Reset</button>
                            </div>
                            <div class="input-group">
                                <label>Age</label>
                                <div id="ageResult" style="font-size: 1.2rem; font-weight: bold; padding: 10px; background-color: var(--color-bg-secondary); border-radius: 4px;">
                                    Enter your birth date to calculate age
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }



        // EMI Calculator Modal
        function createEmiCalculatorModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Loan Amount</label>
                                <input type="number" id="loanAmount" placeholder="Enter loan amount">
                            </div>
                            <div class="input-group">
                                <label>Interest Rate (% per year)</label>
                                <input type="number" id="interestRate" placeholder="Enter interest rate" step="0.1">
                            </div>
                            <div class="input-group">
                                <label>Loan Term (years)</label>
                                <input type="number" id="loanTerm" placeholder="Enter loan term">
                            </div>
                            <div class="input-group">
                                <label>Payment Frequency</label>
                                <select id="paymentFrequency">
                                    <option value="monthly">Monthly</option>
                                    <option value="quarterly">Quarterly</option>
                                    <option value="yearly">Yearly</option>
                                </select>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="calculateEmiBtn">Calculate EMI</button>
                                <button class="secondary-button" id="resetEmiBtn">Reset</button>
                            </div>
                            <div class="tool-output" id="emiResult">
                                <h4>EMI Result</h4>
                                <div id="emiDetails">Enter loan details to calculate EMI</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // SIP Calculator Modal
        function createSipCalculatorModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Monthly Investment</label>
                                <input type="number" id="monthlyInvestment" placeholder="Enter monthly investment">
                            </div>
                            <div class="input-group">
                                <label>Expected Annual Return (%)</label>
                                <input type="number" id="expectedReturn" placeholder="Enter expected return" step="0.1">
                            </div>
                            <div class="input-group">
                                <label>Investment Period (years)</label>
                                <input type="number" id="investmentPeriod" placeholder="Enter investment period">
                            </div>
                            <div class="input-group">
                                <label>Inflation Rate (%)</label>
                                <input type="number" id="inflationRate" placeholder="Enter inflation rate" step="0.1" value="6">
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="calculateSipBtn">Calculate SIP</button>
                                <button class="secondary-button" id="resetSipBtn">Reset</button>
                            </div>
                            <div class="tool-output" id="sipResult">
                                <h4>SIP Result</h4>
                                <div id="sipDetails">Enter investment details to calculate SIP returns</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // BMI Calculator Modal
        function createBmiCalculatorModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Measurement System</label>
                                <select id="measurementSystem">
                                    <option value="metric">Metric (kg, cm)</option>
                                    <option value="imperial">Imperial (lbs, inches)</option>
                                </select>
                            </div>
                            <div id="metricInputs">
                                <div class="input-group">
                                    <label>Weight (kg)</label>
                                    <input type="number" id="weightKg" placeholder="Enter weight in kg">
                                </div>
                                <div class="input-group">
                                    <label>Height (cm)</label>
                                    <input type="number" id="heightCm" placeholder="Enter height in cm">
                                </div>
                            </div>
                            <div id="imperialInputs" style="display: none;">
                                <div class="input-group">
                                    <label>Weight (lbs)</label>
                                    <input type="number" id="weightLbs" placeholder="Enter weight in lbs">
                                </div>
                                <div class="input-group">
                                    <label>Height (feet)</label>
                                    <input type="number" id="heightFeet" placeholder="Feet">
                                </div>
                                <div class="input-group">
                                    <label>Height (inches)</label>
                                    <input type="number" id="heightInches" placeholder="Inches">
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Age</label>
                                <input type="number" id="age" placeholder="Enter age">
                            </div>
                            <div class="input-group">
                                <label>Gender</label>
                                <select id="gender">
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                </select>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="calculateBmiBtn">Calculate BMI</button>
                                <button class="secondary-button" id="resetBmiBtn">Reset</button>
                            </div>
                            <div class="tool-output" id="bmiResult">
                                <h4>BMI Result</h4>
                                <div id="bmiDetails">Enter your details to calculate BMI</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Unit Price Calculator Modal
        function createUnitPriceCalculatorModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Product 1</label>
                                <div style="display: flex; gap: 10px;">
                                    <input type="number" id="product1Price" placeholder="Price" style="flex: 1;">
                                    <input type="number" id="product1Quantity" placeholder="Quantity" style="flex: 1;">
                                    <input type="text" id="product1Unit" placeholder="Unit (e.g., kg)" style="flex: 1;">
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Product 2</label>
                                <div style="display: flex; gap: 10px;">
                                    <input type="number" id="product2Price" placeholder="Price" style="flex: 1;">
                                    <input type="number" id="product2Quantity" placeholder="Quantity" style="flex: 1;">
                                    <input type="text" id="product2Unit" placeholder="Unit (e.g., kg)" style="flex: 1;">
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Currency</label>
                                <select id="currency">
                                    <option value="$">$ (USD)</option>
                                    <option value="‚Ç¨">‚Ç¨ (EUR)</option>
                                    <option value="¬£">¬£ (GBP)</option>
                                    <option value="‚Çπ">‚Çπ (INR)</option>
                                    <option value="¬•">¬• (JPY)</option>
                                </select>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="comparePricesBtn">Compare Prices</button>
                                <button class="secondary-button" id="resetPriceBtn">Reset</button>
                            </div>
                            <div class="tool-output" id="priceResult">
                                <h4>Comparison Result</h4>
                                <div id="priceDetails">Enter product details to compare prices</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Word Counter Modal
        function createWordCounterModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Enter Text</label>
                                <textarea id="wordCounterInput" placeholder="Type or paste your text here..." rows="10"></textarea>
                            </div>
                            <div class="input-group">
                                <label>Count Options</label>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                                    <label><input type="checkbox" id="countWords" checked> Words</label>
                                    <label><input type="checkbox" id="countCharacters" checked> Characters</label>
                                    <label><input type="checkbox" id="countSentences"> Sentences</label>
                                    <label><input type="checkbox" id="countParagraphs"> Paragraphs</label>
                                    <label><input type="checkbox" id="countSpaces"> Spaces</label>
                                    <label><input type="checkbox" id="countPunctuation"> Punctuation</label>
                                </div>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="countTextBtn">Count Text</button>
                                <button class="secondary-button" id="clearTextBtn">Clear Text</button>
                                <button class="secondary-button" id="resetCounterBtn">Reset</button>
                            </div>
                            <div class="tool-output" id="wordCounterResult">
                                <h4>Text Statistics</h4>
                                <div id="wordCounterDetails">Enter text to see statistics</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Case Converter Modal
        function createCaseConverterModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Enter Text</label>
                                <textarea id="caseInput" placeholder="Enter text to convert" rows="6"></textarea>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="toUpperCaseBtn">UPPERCASE</button>
                                <button class="primary-button" id="toLowerCaseBtn">lowercase</button>
                                <button class="primary-button" id="toTitleCaseBtn">Title Case</button>
                                <button class="primary-button" id="toSentenceCaseBtn">Sentence case</button>
                                <button class="primary-button" id="toCamelCaseBtn">camelCase</button>
                                <button class="primary-button" id="toPascalCaseBtn">PascalCase</button>
                                <button class="primary-button" id="toSnakeCaseBtn">snake_case</button>
                                <button class="primary-button" id="toKebabCaseBtn">kebab-case</button>
                            </div>
                            <div class="input-group">
                                <label>Converted Text</label>
                                <textarea id="caseOutput" placeholder="Converted text will appear here" rows="6" readonly></textarea>
                            </div>
                            <div class="button-group">
                                <button class="secondary-button" id="copyCaseBtn">Copy to Clipboard</button>
                                <button class="secondary-button" id="swapCaseBtn">Swap Case</button>
                                <button class="secondary-button" id="resetCaseBtn">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Lorem Ipsum Generator Modal
        function createLoremIpsumModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Number of Paragraphs</label>
                                <input type="number" id="paragraphCount" min="1" max="20" value="3">
                            </div>
                            <div class="input-group">
                                <label>Paragraph Length</label>
                                <select id="paragraphLength">
                                    <option value="short">Short (2-3 sentences)</option>
                                    <option value="medium" selected>Medium (4-6 sentences)</option>
                                    <option value="long">Long (7-10 sentences)</option>
                                    <option value="very-long">Very Long (10+ sentences)</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>Starting Text</label>
                                <select id="startWith">
                                    <option value="lorem">Lorem ipsum dolor sit amet...</option>
                                    <option value="random">Random start</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>Include HTML Tags</label>
                                <select id="includeHtml">
                                    <option value="none">No HTML</option>
                                    <option value="p">Paragraph Tags (&lt;p&gt;)</option>
                                    <option value="div">Div Tags (&lt;div&gt;)</option>
                                </select>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="generateLoremBtn">Generate Lorem Ipsum</button>
                                <button class="secondary-button" id="resetLoremBtn">Reset</button>
                            </div>
                            <div class="input-group">
                                <label>Generated Text</label>
                                <textarea id="loremOutput" placeholder="Lorem ipsum text will appear here" rows="10" readonly></textarea>
                            </div>
                            <div class="button-group">
                                <button class="secondary-button" id="copyLoremBtn">Copy to Clipboard</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Text Minifier Modal
        function createTextMinifierModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Enter Text (HTML, CSS, JS)</label>
                                <textarea id="minifyInput" placeholder="Paste your code here..." rows="10"></textarea>
                            </div>
                            <div class="input-group">
                                <label>Language</label>
                                <select id="minifyLanguage">
                                    <option value="auto">Auto-detect</option>
                                    <option value="html">HTML</option>
                                    <option value="css">CSS</option>
                                    <option value="js">JavaScript</option>
                                    <option value="json">JSON</option>
                                    <option value="xml">XML</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>Options</label>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                                    <label><input type="checkbox" id="removeComments" checked> Remove Comments</label>
                                    <label><input type="checkbox" id="removeWhitespace" checked> Remove Whitespace</label>
                                    <label><input type="checkbox" id="collapseWhitespace"> Collapse Whitespace</label>
                                    <label><input type="checkbox" id="removeEmptyAttributes"> Remove Empty Attributes</label>
                                </div>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="minifyTextBtn">Minify Text</button>
                                <button class="secondary-button" id="resetMinifyBtn">Reset</button>
                            </div>
                            <div class="input-group">
                                <label>Minified Text</label>
                                <textarea id="minifyOutput" placeholder="Minified code will appear here" rows="10" readonly></textarea>
                            </div>
                            <div class="tool-output" id="minifyStats" style="display: none;">
                                <h4>Compression Statistics</h4>
                                <div id="minifyDetails"></div>
                            </div>
                            <div class="button-group">
                                <button class="secondary-button" id="copyMinifyBtn">Copy to Clipboard</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Text Beautifier Modal
        function createTextBeautifierModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Enter Text (HTML, CSS, JS)</label>
                                <textarea id="beautifyInput" placeholder="Paste your code here..." rows="10"></textarea>
                            </div>
                            <div class="input-group">
                                <label>Language</label>
                                <select id="beautifyLanguage">
                                    <option value="auto">Auto-detect</option>
                                    <option value="html">HTML</option>
                                    <option value="css">CSS</option>
                                    <option value="js">JavaScript</option>
                                    <option value="json">JSON</option>
                                    <option value="xml">XML</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>Indentation</label>
                                <select id="indentation">
                                    <option value="2">2 Spaces</option>
                                    <option value="4" selected>4 Spaces</option>
                                    <option value="tab">Tabs</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>Options</label>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                                    <label><input type="checkbox" id="wrapAttributes" checked> Wrap Attributes</label>
                                    <label><input type="checkbox" id="preserveNewlines"> Preserve Newlines</label>
                                    <label><input type="checkbox" id="endWithNewline" checked> End with Newline</label>
                                    <label><input type="checkbox" id="sortAttributes"> Sort Attributes</label>
                                </div>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="beautifyTextBtn">Beautify Text</button>
                                <button class="secondary-button" id="resetBeautifyBtn">Reset</button>
                            </div>
                            <div class="input-group">
                                <label>Beautified Text</label>
                                <textarea id="beautifyOutput" placeholder="Beautified code will appear here" rows="10" readonly></textarea>
                            </div>
                            <div class="button-group">
                                <button class="secondary-button" id="copyBeautifyBtn">Copy to Clipboard</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Password Generator Modal
        function createPasswordGeneratorModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Password Length</label>
                                <input type="range" id="passwordLength" min="8" max="32" value="12">
                                <span class="range-value" id="passwordLengthValue">12 characters</span>
                            </div>
                            <div class="input-group">
                                <label>Character Types</label>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                                    <label><input type="checkbox" id="includeUppercase" checked> Uppercase Letters (A-Z)</label>
                                    <label><input type="checkbox" id="includeLowercase" checked> Lowercase Letters (a-z)</label>
                                    <label><input type="checkbox" id="includeNumbers" checked> Numbers (0-9)</label>
                                    <label><input type="checkbox" id="includeSymbols"> Symbols (!@#$%^&*)</label>
                                    <label><input type="checkbox" id="excludeSimilar"> Exclude Similar Characters (i, l, 1, L, o, 0, O)</label>
                                    <label><input type="checkbox" id="excludeAmbiguous"> Exclude Ambiguous Characters ({ } [ ] ( ) / \\ ' " ` + "`" + ` ~ , ; : . < >)</label>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Password Strength</label>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="passwordStrengthBar"></div>
                                </div>
                                <div id="passwordStrengthText" style="margin-top: 5px;">Medium</div>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="generatePasswordBtn">Generate Password</button>
                                <button class="secondary-button" id="resetPasswordBtn">Reset</button>
                            </div>
                            <div class="input-group">
                                <label>Generated Password</label>
                                <div style="display: flex; gap: 10px;">
                                    <input type="text" id="generatedPassword" placeholder="Generated password will appear here" readonly style="flex: 1;">
                                    <button class="secondary-button" id="copyPasswordBtn">Copy</button>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Generate Multiple Passwords</label>
                                <input type="number" id="passwordCount" min="1" max="10" value="1">
                                <button class="secondary-button" id="generateMultipleBtn">Generate Multiple</button>
                            </div>
                            <div class="tool-output" id="multiplePasswords" style="display: none;">
                                <h4>Generated Passwords</h4>
                                <div id="passwordList"></div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // QR Code Generator Modal
        function createQrGeneratorModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>QR Code Content</label>
                                <textarea id="qrContent" placeholder="Enter text, URL, or other content for QR code" rows="4"></textarea>
                            </div>
                            <div class="input-group">
                                <label>QR Code Type</label>
                                <select id="qrType">
                                    <option value="url">URL</option>
                                    <option value="text">Text</option>
                                    <option value="email">Email</option>
                                    <option value="phone">Phone Number</option>
                                    <option value="sms">SMS</option>
                                    <option value="wifi">WiFi</option>
                                    <option value="vcard">Contact (vCard)</option>
                                    <option value="event">Event</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>QR Code Size</label>
                                <input type="range" id="qrSize" min="100" max="500" value="200">
                                <span class="range-value" id="qrSizeValue">200px</span>
                            </div>
                            <div class="input-group">
                                <label>QR Code Color</label>
                                <input type="color" id="qrColor" value="#000000">
                            </div>
                            <div class="input-group">
                                <label>Background Color</label>
                                <input type="color" id="qrBgColor" value="#ffffff">
                            </div>
                            <div class="input-group">
                                <label>Error Correction Level</label>
                                <select id="qrErrorCorrection">
                                    <option value="L">Low (7%)</option>
                                    <option value="M" selected>Medium (15%)</option>
                                    <option value="Q">Quartile (25%)</option>
                                    <option value="H">High (30%)</option>
                                </select>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="generateQrBtn">Generate QR Code</button>
                                <button class="secondary-button" id="resetQrBtn">Reset</button>
                            </div>
                            <div class="tool-output" id="qrOutput" style="display: none;">
                                <h4>QR Code</h4>
                                <div id="qrCodeContainer" style="text-align: center;"></div>
                                <div class="button-group">
                                    <button class="secondary-button" id="downloadQrBtn">Download QR Code</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // JSON Formatter Modal
        function createJsonFormatterModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Enter JSON</label>
                                <textarea id="jsonInput" placeholder="Paste your JSON here..." rows="10"></textarea>
                            </div>
                            <div class="input-group">
                                <label>Indentation</label>
                                <select id="jsonIndentation">
                                    <option value="2">2 Spaces</option>
                                    <option value="4" selected>4 Spaces</option>
                                    <option value="tab">Tabs</option>
                                </select>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="formatJsonBtn">Format JSON</button>
                                <button class="primary-button" id="minifyJsonBtn">Minify JSON</button>
                                <button class="secondary-button" id="validateJsonBtn">Validate JSON</button>
                                <button class="secondary-button" id="resetJsonBtn">Reset</button>
                            </div>
                            <div class="input-group">
                                <label>Formatted JSON</label>
                                <textarea id="jsonOutput" placeholder="Formatted JSON will appear here" rows="10" readonly></textarea>
                            </div>
                            <div class="tool-output" id="jsonValidation" style="display: none;">
                                <h4>Validation Result</h4>
                                <div id="jsonValidationResult"></div>
                            </div>
                            <div class="button-group">
                                <button class="secondary-button" id="copyJsonBtn">Copy to Clipboard</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Base64 Converter Modal
        function createBase64ConverterModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Conversion Direction</label>
                                <select id="base64Direction">
                                    <option value="encode">Encode to Base64</option>
                                    <option value="decode">Decode from Base64</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>Input</label>
                                <textarea id="base64Input" placeholder="Enter text to encode or Base64 to decode" rows="6"></textarea>
                            </div>
                            <div class="input-group">
                                <label>Input Type</label>
                                <select id="base64InputType">
                                    <option value="text">Text</option>
                                    <option value="file">File</option>
                                </select>
                            </div>
                            <div class="input-group" id="base64FileUpload" style="display: none;">
                                <label>Upload File</label>
                                <div class="file-upload" id="base64FileUploadArea">
                                    <p>Drag & drop a file here or click to browse</p>
                                    <input type="file" class="file-input" id="base64File">
                                </div>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="convertBase64Btn">Convert</button>
                                <button class="secondary-button" id="resetBase64Btn">Reset</button>
                            </div>
                            <div class="input-group">
                                <label>Output</label>
                                <textarea id="base64Output" placeholder="Converted result will appear here" rows="6" readonly></textarea>
                            </div>
                            <div class="button-group">
                                <button class="secondary-button" id="copyBase64Btn">Copy to Clipboard</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // CSV/JSON Converter Modal
        function createCsvJsonConverterModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Conversion Direction</label>
                                <select id="conversionDirection">
                                    <option value="csvToJson">CSV to JSON</option>
                                    <option value="jsonToCsv">JSON to CSV</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>Input Data</label>
                                <textarea id="conversionInput" placeholder="Paste your data here..." rows="10"></textarea>
                            </div>
                            <div class="input-group">
                                <label>Options</label>
                                <div id="csvOptions">
                                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                                        <label><input type="checkbox" id="csvHeader" checked> First row is header</label>
                                        <label><input type="checkbox" id="csvQuotes"> Wrap values in quotes</label>
                                    </div>
                                    <div class="input-group">
                                        <label>Delimiter</label>
                                        <select id="csvDelimiter">
                                            <option value="," selected>Comma (,)</option>
                                            <option value=";">Semicolon (;)</option>
                                            <option value="\t">Tab (\t)</option>
                                            <option value="|">Pipe (|)</option>
                                            <option value="custom">Custom</option>
                                        </select>
                                    </div>
                                    <div class="input-group" id="customDelimiterContainer" style="display: none;">
                                        <label>Custom Delimiter</label>
                                        <input type="text" id="customDelimiter" maxlength="1">
                                    </div>
                                </div>
                                <div id="jsonOptions" style="display: none;">
                                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                                        <label><input type="checkbox" id="jsonMinify"> Minify JSON output</label>
                                        <label><input type="checkbox" id="jsonHeader" checked> Include header row</label>
                                    </div>
                                </div>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="convertDataBtn">Convert Data</button>
                                <button class="secondary-button" id="resetConversionBtn">Reset</button>
                            </div>
                            <div class="input-group">
                                <label>Converted Data</label>
                                <textarea id="conversionOutput" placeholder="Converted data will appear here" rows="10" readonly></textarea>
                            </div>
                            <div class="button-group">
                                <button class="secondary-button" id="copyConversionBtn">Copy to Clipboard</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Regex Tester Modal
        function createRegexTesterModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Regular Expression</label>
                                <input type="text" id="regexPattern" placeholder="Enter regex pattern">
                            </div>
                            <div class="input-group">
                                <label>Test String</label>
                                <textarea id="testString" placeholder="Enter text to test against the regex" rows="6"></textarea>
                            </div>
                            <div class="input-group">
                                <label>Flags</label>
                                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                    <label><input type="checkbox" id="globalFlag"> Global (g)</label>
                                    <label><input type="checkbox" id="ignoreCaseFlag"> Ignore Case (i)</label>
                                    <label><input type="checkbox" id="multilineFlag"> Multiline (m)</label>
                                    <label><input type="checkbox" id="dotAllFlag"> Dot All (s)</label>
                                    <label><input type="checkbox" id="unicodeFlag"> Unicode (u)</label>
                                    <label><input type="checkbox" id="stickyFlag"> Sticky (y)</label>
                                </div>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="testRegexBtn">Test Regex</button>
                                <button class="secondary-button" id="resetRegexBtn">Reset</button>
                            </div>
                            <div class="tool-output" id="regexResult">
                                <h4>Test Results</h4>
                                <div id="regexDetails">Test results will appear here</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Hash Generator Modal
        function createHashGeneratorModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Enter Text</label>
                                <textarea id="hashInput" placeholder="Enter text to hash" rows="6"></textarea>
                            </div>
                            <div class="input-group">
                                <label>Input Type</label>
                                <select id="hashInputType">
                                    <option value="text">Text</option>
                                    <option value="file">File</option>
                                </select>
                            </div>
                            <div class="input-group" id="hashFileUpload" style="display: none;">
                                <label>Upload File</label>
                                <div class="file-upload" id="hashFileUploadArea">
                                    <p>Drag & drop a file here or click to browse</p>
                                    <input type="file" class="file-input" id="hashFile">
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Hash Algorithm</label>
                                <select id="hashAlgorithm">
                                    <option value="MD5">MD5</option>
                                    <option value="SHA-1">SHA-1</option>
                                    <option value="SHA-256">SHA-256</option>
                                    <option value="SHA-384">SHA-384</option>
                                    <option value="SHA-512">SHA-512</option>
                                    <option value="SHA3-256">SHA3-256</option>
                                    <option value="SHA3-512">SHA3-512</option>
                                </select>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="generateHashBtn">Generate Hash</button>
                                <button class="secondary-button" id="resetHashBtn">Reset</button>
                            </div>
                            <div class="input-group">
                                <label>Hash Result</label>
                                <textarea id="hashOutput" placeholder="Hash will appear here" rows="3" readonly></textarea>
                            </div>
                            <div class="button-group">
                                <button class="secondary-button" id="copyHashBtn">Copy to Clipboard</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Timer/Stopwatch Modal
        function createTimerStopwatchModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Mode</label>
                                <select id="timerMode">
                                    <option value="timer">Timer</option>
                                    <option value="stopwatch">Stopwatch</option>
                                </select>
                            </div>
                            <div id="timerOptions">
                                <div class="input-group">
                                    <label>Set Timer</label>
                                    <div style="display: flex; gap: 10px;">
                                        <input type="number" id="timerHours" min="0" max="23" value="0" placeholder="Hours" style="flex: 1;">
                                        <input type="number" id="timerMinutes" min="0" max="59" value="1" placeholder="Minutes" style="flex: 1;">
                                        <input type="number" id="timerSeconds" min="0" max="59" value="0" placeholder="Seconds" style="flex: 1;">
                                    </div>
                                </div>
                            </div>
                            <div class="timer-display" id="timeDisplay">00:00:00</div>
                            <div class="button-group">
                                <button class="primary-button" id="startTimerBtn">Start</button>
                                <button class="secondary-button" id="pauseTimerBtn">Pause</button>
                                <button class="secondary-button" id="resetTimerBtn">Reset</button>
                                <button class="secondary-button" id="lapTimerBtn">Lap</button>
                            </div>
                            <div class="input-group">
                                <label>Laps</label>
                                <div id="lapTimes" style="max-height: 150px; overflow-y: auto; padding: 10px; background-color: var(--color-bg-secondary); border-radius: 4px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Unit Converter Modal
        function createUnitConverterModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Category</label>
                                <select id="unitCategory">
                                    <option value="length">Length</option>
                                    <option value="weight">Weight</option>
                                    <option value="temperature">Temperature</option>
                                    <option value="area">Area</option>
                                    <option value="volume">Volume</option>
                                    <option value="speed">Speed</option>
                                    <option value="time">Time</option>
                                    <option value="digital">Digital Storage</option>
                                    <option value="energy">Energy</option>
                                    <option value="pressure">Pressure</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>From</label>
                                <div style="display: flex; gap: 10px;">
                                    <input type="number" id="unitValue" placeholder="Enter value" style="flex: 1;">
                                    <select id="fromUnit" style="flex: 1;"></select>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>To</label>
                                <select id="toUnit"></select>
                            </div>
                            <div class="input-group">
                                <label>Decimal Places</label>
                                <input type="number" id="decimalPlaces" min="0" max="10" value="2">
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="convertUnitBtn">Convert</button>
                                <button class="secondary-button" id="resetUnitBtn">Reset</button>
                            </div>
                            <div class="tool-output" id="unitResult">
                                <h4>Converted Value</h4>
                                <div id="unitDetails">Enter values to convert</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Document Scanner Modal
        function createDocumentScannerModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Upload Document Image</label>
                                <div class="file-upload" id="documentUploadArea">
                                    <p>Drag & drop a document image here or click to browse</p>
                                    <input type="file" class="file-input" id="documentFile" accept="image/*">
                                </div>
                            </div>
                            <div class="canvas-container">
                                <canvas id="documentCanvas"></canvas>
                            </div>
                            <div class="input-group">
                                <label>Enhancement Filters</label>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                                    <label><input type="checkbox" id="grayscaleFilter"> Grayscale</label>
                                    <label><input type="checkbox" id="contrastFilter"> High Contrast</label>
                                    <label><input type="checkbox" id="brightnessFilter"> Brightness</label>
                                    <label><input type="checkbox" id="sharpenFilter"> Sharpen</label>
                                    <label><input type="checkbox" id="blurFilter"> Blur</label>
                                    <label><input type="checkbox" id="invertFilter"> Invert Colors</label>
                                    <label><input type="checkbox" id="sepiaFilter"> Sepia</label>
                                    <label><input type="checkbox" id="noiseFilter"> Reduce Noise</label>
                                </div>
                            </div>
                            <div class="range-group">
                                <label>Brightness</label>
                                <input type="range" id="brightnessValue" min="-100" max="100" value="0">
                                <span class="range-value" id="brightnessValueDisplay">0%</span>
                            </div>
                            <div class="range-group">
                                <label>Contrast</label>
                                <input type="range" id="contrastValue" min="-100" max="100" value="0">
                                <span class="range-value" id="contrastValueDisplay">0%</span>
                            </div>
                            <div class="range-group">
                                <label>Sharpness</label>
                                <input type="range" id="sharpnessValue" min="0" max="100" value="0">
                                <span class="range-value" id="sharpnessValueDisplay">0%</span>
                            </div>
                            <div class="button-group">
                                <button class="primary-button" id="applyFiltersBtn">Apply Filters</button>
                                <button class="secondary-button" id="resetDocumentBtn">Reset</button>
                                <button class="secondary-button" id="downloadDocumentBtn">Download</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Color Picker Modal
        function createColorPickerModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <div class="input-group">
                                <label>Pick a Color</label>
                                <input type="color" id="colorPicker" value="#ff0000">
                            </div>
                            <div class="input-group">
                                <label>Color Formats</label>
                                <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px;">
                                    <span>HEX:</span>
                                    <input type="text" id="hexValue" value="#ff0000" readonly>
                                    <span>RGB:</span>
                                    <input type="text" id="rgbValue" value="rgb(255, 0, 0)" readonly>
                                    <span>HSL:</span>
                                    <input type="text" id="hslValue" value="hsl(0, 100%, 50%)" readonly>
                                    <span>HSV:</span>
                                    <input type="text" id="hsvValue" value="hsv(0, 100%, 100%)" readonly>
                                    <span>CMYK:</span>
                                    <input type="text" id="cmykValue" value="cmyk(0%, 100%, 100%, 0%)" readonly>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Contrast Checker</label>
                                <div style="display: flex; gap: 10px;">
                                    <input type="color" id="color1" value="#ff0000">
                                    <input type="color" id="color2" value="#ffffff">
                                </div>
                                <div class="contrast-preview">
                                    <div class="contrast-sample" id="color1Sample" style="background-color: #ff0000; color: #ffffff;">Sample Text</div>
                                    <div class="contrast-sample" id="color2Sample" style="background-color: #ffffff; color: #ff0000;">Sample Text</div>
                                </div>
                                <div id="contrastResult" style="margin-top: 10px; padding: 10px; background-color: var(--color-bg-secondary); border-radius: 4px;">
                                    Contrast ratio: 4.0:1
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Color Palette Generator</label>
                                <button class="secondary-button" id="generatePaletteBtn">Generate Palette</button>
                                <div id="generatedPalette" class="color-palette" style="margin-top: 10px;"></div>
                            </div>
                            <div class="button-group">
                                <button class="secondary-button" id="resetColorBtn">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Default Modal Template
        function createDefaultModal(tool) {
            return `
                <div class="modal">
                    <div class="modal-header">
                        <h2>${tool.name}</h2>
                        <button class="modal-close">√ó</button>
                    </div>
                    <div class="modal-content">
                        <div class="tool-controls">
                            <p>This tool is currently under development. Please check back later for updates.</p>
                            <div class="button-group">
                                <button class="secondary-button" id="closeDefaultBtn">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ===========================================
        // TOOL IMPLEMENTATIONS
        // ===========================================

        // Tool Implementations go here
        function setupPdfMergeTool(modalOverlay) {
            const pdfFilesInput = modalOverlay.querySelector('#pdfFiles');
            const fileUploadArea = modalOverlay.querySelector('#pdfUploadArea');
            const fileList = modalOverlay.querySelector('#fileList');
            const mergePdfBtn = modalOverlay.querySelector('#mergePdfBtn');
            const resetPdfBtn = modalOverlay.querySelector('#resetPdfBtn');
            
            let uploadedFiles = [];
            
            // File upload area click handler
            fileUploadArea.addEventListener('click', () => {
                pdfFilesInput.click();
            });
            
            // File input change handler
            pdfFilesInput.addEventListener('change', (e) => {
                const files = Array.from(e.target.files);
                uploadedFiles = [...uploadedFiles, ...files];
                updateFileList();
            });
            
            // Drag and drop handlers
            fileUploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                fileUploadArea.style.borderColor = 'var(--color-accent)';
                fileUploadArea.style.backgroundColor = 'var(--color-bg-secondary)';
            });
            
            fileUploadArea.addEventListener('dragleave', () => {
                fileUploadArea.style.borderColor = 'var(--color-border)';
                fileUploadArea.style.backgroundColor = '';
            });
            
            fileUploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                fileUploadArea.style.borderColor = 'var(--color-border)';
                fileUploadArea.style.backgroundColor = '';
                
                const files = Array.from(e.dataTransfer.files);
                uploadedFiles = [...uploadedFiles, ...files];
                updateFileList();
            });
            
            // Update file list display
            function updateFileList() {
                fileList.innerHTML = '';
                
                if (uploadedFiles.length === 0) {
                    return;
                }
                
                const list = document.createElement('ul');
                list.style.marginTop = '10px';
                
                uploadedFiles.forEach((file, index) => {
                    const listItem = document.createElement('li');
                    listItem.style.display = 'flex';
                    listItem.style.justifyContent = 'space-between';
                    listItem.style.alignItems = 'center';
                    listItem.style.padding = '5px 0';
                    listItem.style.borderBottom = '1px solid var(--color-border)';
                    
                    const fileName = document.createElement('span');
                    fileName.textContent = file.name;
                    
                    const removeBtn = document.createElement('button');
                    removeBtn.textContent = 'Remove';
                    removeBtn.style.background = 'none';
                    removeBtn.style.border = 'none';
                    removeBtn.style.color = 'var(--color-accent)';
                    removeBtn.style.cursor = 'pointer';
                    
                    removeBtn.addEventListener('click', () => {
                        uploadedFiles.splice(index, 1);
                        updateFileList();
                    });
                    
                    listItem.appendChild(fileName);
                    listItem.appendChild(removeBtn);
                    list.appendChild(listItem);
                });
                
                fileList.appendChild(list);
            }
            
            // Merge PDFs button handler
            mergePdfBtn.addEventListener('click', async () => {
                if (uploadedFiles.length < 2) {
                    alert('Please upload at least 2 PDF files to merge.');
                    return;
                }
                
                mergePdfBtn.innerHTML = '<span class="loading"></span> Merging...';
                mergePdfBtn.disabled = true;
                
                try {
                    // Create a new PDF document
                    const { PDFDocument } = PDFLib;
                    const mergedPdf = await PDFDocument.create();
                    
                    // Process each uploaded file
                    for (const file of uploadedFiles) {
                        const arrayBuffer = await file.arrayBuffer();
                        const pdf = await PDFDocument.load(arrayBuffer);
                        const pages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
                        pages.forEach(page => mergedPdf.addPage(page));
                    }
                    
                    // Save the merged PDF
                    const mergedPdfBytes = await mergedPdf.save();
                    
                    // Create download link
                    const blob = new Blob([mergedPdfBytes], { type: 'application/pdf' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'merged-document.pdf';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    // Reset button state
                    mergePdfBtn.innerHTML = 'Merge PDFs';
                    mergePdfBtn.disabled = false;
                } catch (error) {
                    console.error('Error merging PDFs:', error);
                    alert('An error occurred while merging PDFs. Please try again.');
                    
                    // Reset button state
                    mergePdfBtn.innerHTML = 'Merge PDFs';
                    mergePdfBtn.disabled = false;
                }
            });
            
            // Reset button handler
            resetPdfBtn.addEventListener('click', () => {
                uploadedFiles = [];
                pdfFilesInput.value = '';
                updateFileList();
            });
        }

        function setupPdfSplitTool(modalOverlay) {
            // Implementation for PDF split tool
            const pdfFileInput = modalOverlay.querySelector('#pdfFile');
            const fileUploadArea = modalOverlay.querySelector('#pdfUploadArea');
            const pageRangeInput = modalOverlay.querySelector('#pageRange');
            const splitPdfBtn = modalOverlay.querySelector('#splitPdfBtn');
            const resetSplitBtn = modalOverlay.querySelector('#resetSplitBtn');
            
            // File upload area click handler
            fileUploadArea.addEventListener('click', () => {
                pdfFileInput.click();
            });
            
            // Split PDF button handler
            splitPdfBtn.addEventListener('click', async () => {
                if (!pdfFileInput.files[0]) {
                    alert('Please upload a PDF file.');
                    return;
                }
                
                if (!pageRangeInput.value.trim()) {
                    alert('Please specify a page range.');
                    return;
                }
                
                splitPdfBtn.innerHTML = '<span class="loading"></span> Splitting...';
                splitPdfBtn.disabled = true;
                
                try {
                    const { PDFDocument } = PDFLib;
                    const file = pdfFileInput.files[0];
                    const arrayBuffer = await file.arrayBuffer();
                    const pdfDoc = await PDFDocument.load(arrayBuffer);
                    
                    // Parse page ranges (e.g., "1-3, 5, 7-10")
                    const pageRanges = pageRangeInput.value.split(',').map(range => range.trim());
                    const pagesToExtract = [];
                    
                    for (const range of pageRanges) {
                        if (range.includes('-')) {
                            const [start, end] = range.split('-').map(num => parseInt(num.trim()) - 1);
                            for (let i = start; i <= end; i++) {
                                if (i >= 0 && i < pdfDoc.getPageCount()) {
                                    pagesToExtract.push(i);
                                }
                            }
                        } else {
                            const pageNum = parseInt(range) - 1;
                            if (pageNum >= 0 && pageNum < pdfDoc.getPageCount()) {
                                pagesToExtract.push(pageNum);
                            }
                        }
                    }
                    
                    // Create new PDF with selected pages
                    const newPdf = await PDFDocument.create();
                    const pages = await newPdf.copyPages(pdfDoc, pagesToExtract);
                    pages.forEach(page => newPdf.addPage(page));
                    
                    // Save and download
                    const pdfBytes = await newPdf.save();
                    const blob = new Blob([pdfBytes], { type: 'application/pdf' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'split-document.pdf';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    // Reset button state
                    splitPdfBtn.innerHTML = 'Split PDF';
                    splitPdfBtn.disabled = false;
                } catch (error) {
                    console.error('Error splitting PDF:', error);
                    alert('An error occurred while splitting PDF. Please try again.');
                    
                    // Reset button state
                    splitPdfBtn.innerHTML = 'Split PDF';
                    splitPdfBtn.disabled = false;
                }
            });
            
            // Reset button handler
            resetSplitBtn.addEventListener('click', () => {
                pdfFileInput.value = '';
                pageRangeInput.value = '';
            });
        }

        function setupImageToPdfTool(modalOverlay) {
            // Implementation for image to PDF tool
            const imageFilesInput = modalOverlay.querySelector('#imageFiles');
            const fileUploadArea = modalOverlay.querySelector('#imageUploadArea');
            const imagePreview = modalOverlay.querySelector('#imagePreview');
            const pageSizeSelect = modalOverlay.querySelector('#pageSize');
            const pageOrientationSelect = modalOverlay.querySelector('#pageOrientation');
            const convertToPdfBtn = modalOverlay.querySelector('#convertToPdfBtn');
            const resetImageBtn = modalOverlay.querySelector('#resetImageBtn');
            
            let uploadedImages = [];
            
            // File upload area click handler
            fileUploadArea.addEventListener('click', () => {
                imageFilesInput.click();
            });
            
            // File input change handler
            imageFilesInput.addEventListener('change', (e) => {
                const files = Array.from(e.target.files);
                uploadedImages = [...uploadedImages, ...files];
                updateImagePreview();
            });
            
            // Drag and drop handlers
            fileUploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                fileUploadArea.style.borderColor = 'var(--color-accent)';
                fileUploadArea.style.backgroundColor = 'var(--color-bg-secondary)';
            });
            
            fileUploadArea.addEventListener('dragleave', () => {
                fileUploadArea.style.borderColor = 'var(--color-border)';
                fileUploadArea.style.backgroundColor = '';
            });
            
            fileUploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                fileUploadArea.style.borderColor = 'var(--color-border)';
                fileUploadArea.style.backgroundColor = '';
                
                const files = Array.from(e.dataTransfer.files);
                uploadedImages = [...uploadedImages, ...files];
                updateImagePreview();
            });
            
            // Update image preview display
            function updateImagePreview() {
                imagePreview.innerHTML = '';
                
                if (uploadedImages.length === 0) {
                    return;
                }
                
                const previewContainer = document.createElement('div');
                previewContainer.className = 'image-preview';
                
                uploadedImages.forEach((file, index) => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const previewItem = document.createElement('div');
                        previewItem.className = 'preview-item';
                        
                        const img = document.createElement('img');
                        img.src = e.target.result;
                        img.alt = file.name;
                        
                        const removeBtn = document.createElement('button');
                        removeBtn.className = 'remove-btn';
                        removeBtn.innerHTML = '√ó';
                        removeBtn.addEventListener('click', () => {
                            uploadedImages.splice(index, 1);
                            updateImagePreview();
                        });
                        
                        previewItem.appendChild(img);
                        previewItem.appendChild(removeBtn);
                        previewContainer.appendChild(previewItem);
                    };
                    reader.readAsDataURL(file);
                });
                
                imagePreview.appendChild(previewContainer);
            }
            
            // Convert to PDF button handler
            convertToPdfBtn.addEventListener('click', async () => {
                if (uploadedImages.length === 0) {
                    alert('Please upload at least one image.');
                    return;
                }
                
                convertToPdfBtn.innerHTML = '<span class="loading"></span> Converting...';
                convertToPdfBtn.disabled = true;
                
                try {
                    const { PDFDocument, rgb } = PDFLib;
                    const pdfDoc = await PDFDocument.create();
                    
                    // Define page sizes
                    const pageSizes = {
                        a4: { width: 595, height: 842 },
                        letter: { width: 612, height: 792 },
                        legal: { width: 612, height: 1008 }
                    };
                    
                    // Process each image
                    for (const file of uploadedImages) {
                        // Convert image to base64
                        const base64 = await new Promise((resolve) => {
                            const reader = new FileReader();
                            reader.onload = () => resolve(reader.result);
                            reader.readAsDataURL(file);
                        });
                        
                        // Create page
                        const pageSize = pageSizes[pageSizeSelect.value];
                        const isLandscape = pageOrientationSelect.value === 'landscape';
                        const page = pdfDoc.addPage([
                            isLandscape ? pageSize.height : pageSize.width,
                            isLandscape ? pageSize.width : pageSize.height
                        ]);
                        
                        // Embed image
                        let image;
                        if (file.type === 'image/jpeg') {
                            image = await pdfDoc.embedJpg(base64);
                        } else if (file.type === 'image/png') {
                            image = await pdfDoc.embedPng(base64);
                        } else {
                            // Convert to PNG for other formats
                            const canvas = document.createElement('canvas');
                            const ctx = canvas.getContext('2d');
                            const img = new Image();
                            
                            await new Promise((resolve) => {
                                img.onload = resolve;
                                img.src = base64;
                            });
                            
                            canvas.width = img.width;
                            canvas.height = img.height;
                            ctx.drawImage(img, 0, 0);
                            
                            const pngDataUrl = canvas.toDataURL('image/png');
                            image = await pdfDoc.embedPng(pngDataUrl);
                        }
                        
                        // Draw image on page (scaled to fit)
                        const { width, height } = image.scale(1);
                        const pageWidth = page.getWidth();
                        const pageHeight = page.getHeight();
                        
                        const scale = Math.min(pageWidth / width, pageHeight / height);
                        const scaledWidth = width * scale;
                        const scaledHeight = height * scale;
                        
                        const x = (pageWidth - scaledWidth) / 2;
                        const y = (pageHeight - scaledHeight) / 2;
                        
                        page.drawImage(image, {
                            x,
                            y,
                            width: scaledWidth,
                            height: scaledHeight,
                        });
                    }
                    
                    // Save and download PDF
                    const pdfBytes = await pdfDoc.save();
                    const blob = new Blob([pdfBytes], { type: 'application/pdf' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'converted-images.pdf';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    // Reset button state
                    convertToPdfBtn.innerHTML = 'Convert to PDF';
                    convertToPdfBtn.disabled = false;
                } catch (error) {
                    console.error('Error converting images to PDF:', error);
                    alert('An error occurred while converting images to PDF. Please try again.');
                    
                    // Reset button state
                    convertToPdfBtn.innerHTML = 'Convert to PDF';
                    convertToPdfBtn.disabled = false;
                }
            });
            
            // Reset button handler
            resetImageBtn.addEventListener('click', () => {
                uploadedImages = [];
                imageFilesInput.value = '';
                updateImagePreview();
            });
        }

         function setupImageConverterTool(modalOverlay) {
            // Implementation for image converter tool
            const imageFileInput = modalOverlay.querySelector('#imageFile');
            const fileUploadArea = modalOverlay.querySelector('#imageUploadArea');
            const imagePreview = modalOverlay.querySelector('#imagePreview');
            const outputFormatSelect = modalOverlay.querySelector('#outputFormat');
            const convertImageBtn = modalOverlay.querySelector('#convertImageBtn');
            const resetConvertBtn = modalOverlay.querySelector('#resetConvertBtn');
            
            let uploadedImage = null;
            
            // File upload area click handler
            fileUploadArea.addEventListener('click', () => {
                imageFileInput.click();
            });
            
            // File input change handler
            imageFileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    uploadedImage = e.target.files[0];
                    updateImagePreview();
                }
            });
            
            // Update image preview
            function updateImagePreview() {
                imagePreview.innerHTML = '';
                
                if (!uploadedImage) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const previewContainer = document.createElement('div');
                    previewContainer.className = 'image-preview';
                    
                    const previewItem = document.createElement('div');
                    previewItem.className = 'preview-item';
                    
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.alt = uploadedImage.name;
                    
                    previewItem.appendChild(img);
                    previewContainer.appendChild(previewItem);
                    imagePreview.appendChild(previewContainer);
                };
                reader.readAsDataURL(uploadedImage);
            }
            
            // Convert image button handler
            convertImageBtn.addEventListener('click', async () => {
                if (!uploadedImage) {
                    alert('Please upload an image.');
                    return;
                }
                
                convertImageBtn.innerHTML = '<span class="loading"></span> Converting...';
                convertImageBtn.disabled = true;
                
                try {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    const img = new Image();
                    
                    await new Promise((resolve) => {
                        img.onload = resolve;
                        img.src = URL.createObjectURL(uploadedImage);
                    });
                    
                    canvas.width = img.width;
                    canvas.height = img.height;
                    ctx.drawImage(img, 0, 0);
                    
                    // Convert to selected format
                    const format = outputFormatSelect.value;
                    let mimeType, fileExtension;
                    
                    switch (format) {
                        case 'jpeg':
                            mimeType = 'image/jpeg';
                            fileExtension = 'jpg';
                            break;
                        case 'png':
                            mimeType = 'image/png';
                            fileExtension = 'png';
                            break;
                        case 'webp':
                            mimeType = 'image/webp';
                            fileExtension = 'webp';
                            break;
                    }
                    
                    const dataUrl = canvas.toDataURL(mimeType);
                    
                    // Create download link
                    const a = document.createElement('a');
                    a.href = dataUrl;
                    a.download = `converted-image.${fileExtension}`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    
                    // Reset button state
                    convertImageBtn.innerHTML = 'Convert Image';
                    convertImageBtn.disabled = false;
                } catch (error) {
                    console.error('Error converting image:', error);
                    alert('An error occurred while converting image. Please try again.');
                    
                    // Reset button state
                    convertImageBtn.innerHTML = 'Convert Image';
                    convertImageBtn.disabled = false;
                }
            });
            
            // Reset button handler
            resetConvertBtn.addEventListener('click', () => {
                uploadedImage = null;
                imageFileInput.value = '';
                imagePreview.innerHTML = '';
            });
        }
        
        function setupImageCompressorTool(modalOverlay) {
            // Implementation for image compressor tool
            const imageFileInput = modalOverlay.querySelector('#imageFile');
            const fileUploadArea = modalOverlay.querySelector('#imageUploadArea');
            const imagePreview = modalOverlay.querySelector('#imagePreview');
            const compressionQuality = modalOverlay.querySelector('#compressionQuality');
            const qualityValue = modalOverlay.querySelector('#qualityValue');
            const compressImageBtn = modalOverlay.querySelector('#compressImageBtn');
            const resetCompressBtn = modalOverlay.querySelector('#resetCompressBtn');
            
            let uploadedImage = null;
            
            // Update quality value display
            compressionQuality.addEventListener('input', () => {
                qualityValue.textContent = `${compressionQuality.value}%`;
            });
            
            // File upload area click handler
            fileUploadArea.addEventListener('click', () => {
                imageFileInput.click();
            });
            
            // File input change handler
            imageFileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    uploadedImage = e.target.files[0];
                    updateImagePreview();
                }
            });
            
            // Update image preview
            function updateImagePreview() {
                imagePreview.innerHTML = '';
                
                if (!uploadedImage) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const previewContainer = document.createElement('div');
                    previewContainer.className = 'image-preview';
                    
                    const previewItem = document.createElement('div');
                    previewItem.className = 'preview-item';
                    
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.alt = uploadedImage.name;
                    
                    previewItem.appendChild(img);
                    previewContainer.appendChild(previewItem);
                    imagePreview.appendChild(previewContainer);
                };
                reader.readAsDataURL(uploadedImage);
            }
            
            // Compress image button handler
            compressImageBtn.addEventListener('click', async () => {
                if (!uploadedImage) {
                    alert('Please upload an image.');
                    return;
                }
                
                compressImageBtn.innerHTML = '<span class="loading"></span> Compressing...';
                compressImageBtn.disabled = true;
                
                try {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    const img = new Image();
                    
                    await new Promise((resolve) => {
                        img.onload = resolve;
                        img.src = URL.createObjectURL(uploadedImage);
                    });
                    
                    canvas.width = img.width;
                    canvas.height = img.height;
                    ctx.drawImage(img, 0, 0);
                    
                    // Compress with selected quality
                    const quality = compressionQuality.value / 100;
                    const dataUrl = canvas.toDataURL('image/jpeg', quality);
                    
                    // Create download link
                    const a = document.createElement('a');
                    a.href = dataUrl;
                    a.download = 'compressed-image.jpg';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    
                    // Reset button state
                    compressImageBtn.innerHTML = 'Compress Image';
                    compressImageBtn.disabled = false;
                } catch (error) {
                    console.error('Error compressing image:', error);
                    alert('An error occurred while compressing image. Please try again.');
                    
                    // Reset button state
                    compressImageBtn.innerHTML = 'Compress Image';
                    compressImageBtn.disabled = false;
                }
            });
            
            // Reset button handler
            resetCompressBtn.addEventListener('click', () => {
                uploadedImage = null;
                imageFileInput.value = '';
                imagePreview.innerHTML = '';
                compressionQuality.value = 80;
                qualityValue.textContent = '80%';
            });
        }



        // Image Cropper Tool
        function setupImageCropperTool(modalOverlay) {
            const imageFileInput = modalOverlay.querySelector('#imageFile');
            const fileUploadArea = modalOverlay.querySelector('#imageUploadArea');
            const cropCanvas = modalOverlay.querySelector('#cropCanvas');
            const cropWidth = modalOverlay.querySelector('#cropWidth');
            const cropHeight = modalOverlay.querySelector('#cropHeight');
            const cropX = modalOverlay.querySelector('#cropX');
            const cropY = modalOverlay.querySelector('#cropY');
            const cropImageBtn = modalOverlay.querySelector('#cropImageBtn');
            const resetCropBtn = modalOverlay.querySelector('#resetCropBtn');
            
            let ctx = cropCanvas.getContext('2d');
            let originalImage = null;
            
            // File upload area click handler
            fileUploadArea.addEventListener('click', () => {
                imageFileInput.click();
            });
            
            // File input change handler
            imageFileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    
                    reader.onload = function(event) {
                        originalImage = new Image();
                        originalImage.onload = function() {
                            // Set canvas size to image size
                            cropCanvas.width = originalImage.width;
                            cropCanvas.height = originalImage.height;
                            
                            // Draw image on canvas
                            ctx.drawImage(originalImage, 0, 0);
                            
                            // Set default crop dimensions
                            cropWidth.value = Math.floor(originalImage.width / 2);
                            cropHeight.value = Math.floor(originalImage.height / 2);
                        };
                        originalImage.src = event.target.result;
                    };
                    
                    reader.readAsDataURL(file);
                }
            });
            
            // Crop image button handler
            cropImageBtn.addEventListener('click', () => {
                if (!originalImage) {
                    alert('Please upload an image first.');
                    return;
                }
                
                const width = parseInt(cropWidth.value);
                const height = parseInt(cropHeight.value);
                const x = parseInt(cropX.value);
                const y = parseInt(cropY.value);
                
                if (isNaN(width) || isNaN(height) || width <= 0 || height <= 0) {
                    alert('Please enter valid crop dimensions.');
                    return;
                }
                
                if (width > originalImage.width || height > originalImage.height) {
                    alert('Crop dimensions cannot exceed original image size.');
                    return;
                }
                
                if (x < 0 || y < 0 || x + width > originalImage.width || y + height > originalImage.height) {
                    alert('Crop area is outside the image boundaries.');
                    return;
                }
                
                // Create a new canvas for the cropped image
                const croppedCanvas = document.createElement('canvas');
                croppedCanvas.width = width;
                croppedCanvas.height = height;
                const croppedCtx = croppedCanvas.getContext('2d');
                
                // Draw the cropped portion
                croppedCtx.drawImage(
                    originalImage,
                    x, y, width, height,  // Source rectangle
                    0, 0, width, height   // Destination rectangle
                );
                
                // Create download link
                const dataUrl = croppedCanvas.toDataURL('image/png');
                const a = document.createElement('a');
                a.href = dataUrl;
                a.download = 'cropped-image.png';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            });
            
            // Reset button handler
            resetCropBtn.addEventListener('click', () => {
                imageFileInput.value = '';
                cropWidth.value = '';
                cropHeight.value = '';
                cropX.value = '0';
                cropY.value = '0';
                ctx.clearRect(0, 0, cropCanvas.width, cropCanvas.height);
                originalImage = null;
            });
        }

        // Image Resizer Tool
        function setupImageResizerTool(modalOverlay) {
            const imageFileInput = modalOverlay.querySelector('#imageFile');
            const fileUploadArea = modalOverlay.querySelector('#imageUploadArea');
            const resizeWidth = modalOverlay.querySelector('#resizeWidth');
            const resizeHeight = modalOverlay.querySelector('#resizeHeight');
            const maintainAspect = modalOverlay.querySelector('#maintainAspect');
            const resizeQuality = modalOverlay.querySelector('#resizeQuality');
            const resizeImageBtn = modalOverlay.querySelector('#resizeImageBtn');
            const resetResizeBtn = modalOverlay.querySelector('#resetResizeBtn');
            
            let originalImage = null;
            let originalWidth = 0;
            let originalHeight = 0;
            
            // File upload area click handler
            fileUploadArea.addEventListener('click', () => {
                imageFileInput.click();
            });
            
            // File input change handler
            imageFileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    
                    reader.onload = function(event) {
                        originalImage = new Image();
                        originalImage.onload = function() {
                            originalWidth = originalImage.width;
                            originalHeight = originalImage.height;
                            
                            // Set default resize values
                            resizeWidth.value = originalWidth;
                            resizeHeight.value = originalHeight;
                        };
                        originalImage.src = event.target.result;
                    };
                    
                    reader.readAsDataURL(file);
                }
            });
            
            // Maintain aspect ratio when width changes
            resizeWidth.addEventListener('input', () => {
                if (maintainAspect.checked && originalWidth > 0) {
                    const newWidth = parseInt(resizeWidth.value);
                    if (!isNaN(newWidth)) {
                        const ratio = originalHeight / originalWidth;
                        resizeHeight.value = Math.round(newWidth * ratio);
                    }
                }
            });
            
            // Maintain aspect ratio when height changes
            resizeHeight.addEventListener('input', () => {
                if (maintainAspect.checked && originalHeight > 0) {
                    const newHeight = parseInt(resizeHeight.value);
                    if (!isNaN(newHeight)) {
                        const ratio = originalWidth / originalHeight;
                        resizeWidth.value = Math.round(newHeight * ratio);
                    }
                }
            });
            
            // Resize image button handler
            resizeImageBtn.addEventListener('click', () => {
                if (!originalImage) {
                    alert('Please upload an image first.');
                    return;
                }
                
                const newWidth = parseInt(resizeWidth.value);
                const newHeight = parseInt(resizeHeight.value);
                
                if (isNaN(newWidth) || isNaN(newHeight) || newWidth <= 0 || newHeight <= 0) {
                    alert('Please enter valid dimensions.');
                    return;
                }
                
                // Set quality based on selection
                let quality = 0.92; // Default medium quality
                if (resizeQuality.value === 'high') quality = 1.0;
                else if (resizeQuality.value === 'low') quality = 0.7;
                
                // Create a new canvas for the resized image
                const resizedCanvas = document.createElement('canvas');
                resizedCanvas.width = newWidth;
                resizedCanvas.height = newHeight;
                const resizedCtx = resizedCanvas.getContext('2d');
                
                // Draw the resized image with smoothing
                resizedCtx.imageSmoothingEnabled = true;
                resizedCtx.imageSmoothingQuality = 'high';
                resizedCtx.drawImage(originalImage, 0, 0, newWidth, newHeight);
                
                // Create download link
                const dataUrl = resizedCanvas.toDataURL('image/jpeg', quality);
                const a = document.createElement('a');
                a.href = dataUrl;
                a.download = 'resized-image.jpg';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            });
            
            // Reset button handler
            resetResizeBtn.addEventListener('click', () => {
                imageFileInput.value = '';
                resizeWidth.value = '';
                resizeHeight.value = '';
                resizeQuality.value = 'medium';
                originalImage = null;
                originalWidth = 0;
                originalHeight = 0;
            });
        }

        // Image Watermarker Tool
        function setupImageWatermarkerTool(modalOverlay) {
            const imageFileInput = modalOverlay.querySelector('#imageFile');
            const fileUploadArea = modalOverlay.querySelector('#imageUploadArea');
            const watermarkType = modalOverlay.querySelector('#watermarkType');
            const textWatermarkOptions = modalOverlay.querySelector('#textWatermarkOptions');
            const imageWatermarkOptions = modalOverlay.querySelector('#imageWatermarkOptions');
            const watermarkText = modalOverlay.querySelector('#watermarkText');
            const textColor = modalOverlay.querySelector('#textColor');
            const textSize = modalOverlay.querySelector('#textSize');
            const textSizeValue = modalOverlay.querySelector('#textSizeValue');
            const textFont = modalOverlay.querySelector('#textFont');
            const watermarkFileInput = modalOverlay.querySelector('#watermarkFile');
            const watermarkUploadArea = modalOverlay.querySelector('#watermarkUploadArea');
            const watermarkSize = modalOverlay.querySelector('#watermarkSize');
            const watermarkSizeValue = modalOverlay.querySelector('#watermarkSizeValue');
            const watermarkOpacity = modalOverlay.querySelector('#watermarkOpacity');
            const opacityValue = modalOverlay.querySelector('#opacityValue');
            const watermarkPosition = modalOverlay.querySelector('#watermarkPosition');
            const watermarkRotation = modalOverlay.querySelector('#watermarkRotation');
            const rotationValue = modalOverlay.querySelector('#rotationValue');
            const addWatermarkBtn = modalOverlay.querySelector('#addWatermarkBtn');
            const resetWatermarkBtn = modalOverlay.querySelector('#resetWatermarkBtn');
            
            let originalImage = null;
            let watermarkImage = null;
            
            // File upload area click handlers
            fileUploadArea.addEventListener('click', () => {
                imageFileInput.click();
            });
            
            watermarkUploadArea.addEventListener('click', () => {
                watermarkFileInput.click();
            });
            
            // File input change handlers
            imageFileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    
                    reader.onload = function(event) {
                        originalImage = new Image();
                        originalImage.onload = function() {
                            // Image loaded successfully
                        };
                        originalImage.src = event.target.result;
                    };
                    
                    reader.readAsDataURL(file);
                }
            });
            
            watermarkFileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    
                    reader.onload = function(event) {
                        watermarkImage = new Image();
                        watermarkImage.onload = function() {
                            // Watermark image loaded successfully
                        };
                        watermarkImage.src = event.target.result;
                    };
                    
                    reader.readAsDataURL(file);
                }
            });
            
            // Watermark type change handler
            watermarkType.addEventListener('change', () => {
                if (watermarkType.value === 'text') {
                    textWatermarkOptions.style.display = 'block';
                    imageWatermarkOptions.style.display = 'none';
                } else {
                    textWatermarkOptions.style.display = 'none';
                    imageWatermarkOptions.style.display = 'block';
                }
            });
            
            // Update text size value display
            textSize.addEventListener('input', () => {
                textSizeValue.textContent = `${textSize.value}px`;
            });
            
            // Update watermark size value display
            watermarkSize.addEventListener('input', () => {
                watermarkSizeValue.textContent = `${watermarkSize.value}%`;
            });
            
            // Update opacity value display
            watermarkOpacity.addEventListener('input', () => {
                opacityValue.textContent = `${watermarkOpacity.value}%`;
            });
            
            // Update rotation value display
            watermarkRotation.addEventListener('input', () => {
                rotationValue.textContent = `${watermarkRotation.value}¬∞`;
            });
            
            // Add watermark button handler
            addWatermarkBtn.addEventListener('click', () => {
                if (!originalImage) {
                    alert('Please upload an image first.');
                    return;
                }
                
                if (watermarkType.value === 'text' && !watermarkText.value.trim()) {
                    alert('Please enter watermark text.');
                    return;
                }
                
                if (watermarkType.value === 'image' && !watermarkImage) {
                    alert('Please upload a watermark image.');
                    return;
                }
                
                // Create a canvas for the watermarked image
                const watermarkedCanvas = document.createElement('canvas');
                watermarkedCanvas.width = originalImage.width;
                watermarkedCanvas.height = originalImage.height;
                const ctx = watermarkedCanvas.getContext('2d');
                
                // Draw the original image
                ctx.drawImage(originalImage, 0, 0);
                
                // Set global alpha for watermark
                ctx.globalAlpha = watermarkOpacity.value / 100;
                
                if (watermarkType.value === 'text') {
                    // Add text watermark
                    ctx.fillStyle = textColor.value;
                    ctx.font = `${textSize.value}px ${textFont.value}`;
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    
                    // Calculate position based on selection
                    let x, y;
                    switch (watermarkPosition.value) {
                        case 'top-left':
                            x = originalImage.width * 0.1;
                            y = originalImage.height * 0.1;
                            ctx.textAlign = 'left';
                            ctx.textBaseline = 'top';
                            break;
                        case 'top-right':
                            x = originalImage.width * 0.9;
                            y = originalImage.height * 0.1;
                            ctx.textAlign = 'right';
                            ctx.textBaseline = 'top';
                            break;
                        case 'bottom-left':
                            x = originalImage.width * 0.1;
                            y = originalImage.height * 0.9;
                            ctx.textAlign = 'left';
                            ctx.textBaseline = 'bottom';
                            break;
                        case 'bottom-right':
                            x = originalImage.width * 0.9;
                            y = originalImage.height * 0.9;
                            ctx.textAlign = 'right';
                            ctx.textBaseline = 'bottom';
                            break;
                        case 'center':
                            x = originalImage.width / 2;
                            y = originalImage.height / 2;
                            break;
                        case 'tile':
                            // Tile text watermark across the image
                            const textWidth = ctx.measureText(watermarkText.value).width;
                            const textHeight = parseInt(textSize.value);
                            const spacingX = textWidth + 20;
                            const spacingY = textHeight + 20;
                            
                            for (let i = 0; i < originalImage.width; i += spacingX) {
                                for (let j = 0; j < originalImage.height; j += spacingY) {
                                    ctx.fillText(watermarkText.value, i, j);
                                }
                            }
                            // Reset global alpha and return early
                            ctx.globalAlpha = 1.0;
                            
                            // Create download link
                            const dataUrl = watermarkedCanvas.toDataURL('image/png');
                            const a = document.createElement('a');
                            a.href = dataUrl;
                            a.download = 'watermarked-image.png';
                            document.body.appendChild(a);
                            a.click();
                            document.body.removeChild(a);
                            return;
                    }
                    
                    // Apply rotation if needed
                    if (parseInt(watermarkRotation.value) !== 0) {
                        ctx.save();
                        ctx.translate(x, y);
                        ctx.rotate(parseInt(watermarkRotation.value) * Math.PI / 180);
                        ctx.fillText(watermarkText.value, 0, 0);
                        ctx.restore();
                    } else {
                        ctx.fillText(watermarkText.value, x, y);
                    }
                } else {
                    // Add image watermark
                    // Calculate position and size
                    let x, y;
                    const watermarkWidth = originalImage.width * (watermarkSize.value / 100);
                    const watermarkHeight = (watermarkImage.height / watermarkImage.width) * watermarkWidth;
                    
                    switch (watermarkPosition.value) {
                        case 'top-left':
                            x = 10;
                            y = 10;
                            break;
                        case 'top-right':
                            x = originalImage.width - watermarkWidth - 10;
                            y = 10;
                            break;
                        case 'bottom-left':
                            x = 10;
                            y = originalImage.height - watermarkHeight - 10;
                            break;
                        case 'bottom-right':
                            x = originalImage.width - watermarkWidth - 10;
                            y = originalImage.height - watermarkHeight - 10;
                            break;
                        case 'center':
                            x = (originalImage.width - watermarkWidth) / 2;
                            y = (originalImage.height - watermarkHeight) / 2;
                            break;
                        case 'tile':
                            // Tile image watermark across the image
                            const spacingX = watermarkWidth + 10;
                            const spacingY = watermarkHeight + 10;
                            
                            for (let i = 0; i < originalImage.width; i += spacingX) {
                                for (let j = 0; j < originalImage.height; j += spacingY) {
                                    ctx.drawImage(watermarkImage, i, j, watermarkWidth, watermarkHeight);
                                }
                            }
                            // Reset global alpha and return early
                            ctx.globalAlpha = 1.0;
                            
                            // Create download link
                            const dataUrl = watermarkedCanvas.toDataURL('image/png');
                            const a = document.createElement('a');
                            a.href = dataUrl;
                            a.download = 'watermarked-image.png';
                            document.body.appendChild(a);
                            a.click();
                            document.body.removeChild(a);
                            return;
                    }
                    
                    // Apply rotation if needed
                    if (parseInt(watermarkRotation.value) !== 0) {
                        ctx.save();
                        ctx.translate(x + watermarkWidth / 2, y + watermarkHeight / 2);
                        ctx.rotate(parseInt(watermarkRotation.value) * Math.PI / 180);
                        ctx.drawImage(watermarkImage, -watermarkWidth / 2, -watermarkHeight / 2, watermarkWidth, watermarkHeight);
                        ctx.restore();
                    } else {
                        ctx.drawImage(watermarkImage, x, y, watermarkWidth, watermarkHeight);
                    }
                }
                
                // Reset global alpha
                ctx.globalAlpha = 1.0;
                
                // Create download link
                const dataUrl = watermarkedCanvas.toDataURL('image/png');
                const a = document.createElement('a');
                a.href = dataUrl;
                a.download = 'watermarked-image.png';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            });
            
            // Reset button handler
            resetWatermarkBtn.addEventListener('click', () => {
                imageFileInput.value = '';
                watermarkFileInput.value = '';
                watermarkText.value = '';
                textColor.value = '#ffffff';
                textSize.value = 30;
                textSizeValue.textContent = '30px';
                textFont.value = 'Arial';
                watermarkSize.value = 20;
                watermarkSizeValue.textContent = '20%';
                watermarkOpacity.value = 50;
                opacityValue.textContent = '50%';
                watermarkPosition.value = 'bottom-right';
                watermarkRotation.value = 0;
                rotationValue.textContent = '0¬∞';
                originalImage = null;
                watermarkImage = null;
            });
        }

        // Color Palette Extractor Tool
        function setupColorPaletteTool(modalOverlay) {
            const imageFileInput = modalOverlay.querySelector('#imageFile');
            const fileUploadArea = modalOverlay.querySelector('#imageUploadArea');
            const colorCount = modalOverlay.querySelector('#colorCount');
            const extractionMethod = modalOverlay.querySelector('#extractionMethod');
            const extractColorsBtn = modalOverlay.querySelector('#extractColorsBtn');
            const resetPaletteBtn = modalOverlay.querySelector('#resetPaletteBtn');
            const colorPaletteResult = modalOverlay.querySelector('#colorPaletteResult');
            const colorCodesOutput = modalOverlay.querySelector('#colorCodesOutput');
            const colorCodes = modalOverlay.querySelector('#colorCodes');
            
            let originalImage = null;
            
            // File upload area click handler
            fileUploadArea.addEventListener('click', () => {
                imageFileInput.click();
            });
            
            // File input change handler
            imageFileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    
                    reader.onload = function(event) {
                        originalImage = new Image();
                        originalImage.onload = function() {
                            // Image loaded successfully
                        };
                        originalImage.src = event.target.result;
                    };
                    
                    reader.readAsDataURL(file);
                }
            });
            
            // Extract colors button handler
            extractColorsBtn.addEventListener('click', () => {
                if (!originalImage) {
                    alert('Please upload an image first.');
                    return;
                }
                
                const numColors = parseInt(colorCount.value);
                if (isNaN(numColors) || numColors < 1 || numColors > 20) {
                    alert('Please enter a valid number of colors (1-20).');
                    return;
                }
                
                // Create a canvas to analyze the image
                const canvas = document.createElement('canvas');
                canvas.width = originalImage.width;
                canvas.height = originalImage.height;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(originalImage, 0, 0);
                
                // Get image data
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;
                
                // Extract colors using a simple clustering algorithm
                const colors = extractColorsFromImageData(data, numColors);
                
                // Display the color palette
                displayColorPalette(colors);
            });
            
            // Reset button handler
            resetPaletteBtn.addEventListener('click', () => {
                imageFileInput.value = '';
                colorCount.value = '5';
                extractionMethod.value = 'dominant';
                colorPaletteResult.innerHTML = '';
                colorCodesOutput.style.display = 'none';
                originalImage = null;
            });
            
            // Extract colors from image data using a simple k-means clustering
            function extractColorsFromImageData(data, k) {
                // Simple color quantization using median cut algorithm
                const colorMap = {};
                
                // Sample pixels to reduce computation
                const sampleStep = Math.floor(data.length / 4 / 1000); // Sample 1000 pixels
                const samples = [];
                
                for (let i = 0; i < data.length; i += 4 * sampleStep) {
                    const r = data[i];
                    const g = data[i + 1];
                    const b = data[i + 2];
                    // Skip transparent pixels
                    if (data[i + 3] < 128) continue;
                    
                    samples.push({ r, g, b });
                }
                
                // If we don't have enough samples, use all pixels
                if (samples.length < k) {
                    samples.length = 0;
                    for (let i = 0; i < data.length; i += 4) {
                        const r = data[i];
                        const g = data[i + 1];
                        const b = data[i + 2];
                        // Skip transparent pixels
                        if (data[i + 3] < 128) continue;
                        
                        samples.push({ r, g, b });
                    }
                }
                
                // Use a simple approach: group by quantized colors
                const quantize = (value) => Math.floor(value / 32) * 32;
                
                samples.forEach(sample => {
                    const quantized = `${quantize(sample.r)},${quantize(sample.g)},${quantize(sample.b)}`;
                    colorMap[quantized] = colorMap[quantized] || { count: 0, r: 0, g: 0, b: 0 };
                    colorMap[quantized].count++;
                    colorMap[quantized].r += sample.r;
                    colorMap[quantized].g += sample.g;
                    colorMap[quantized].b += sample.b;
                });
                
                // Convert to array and calculate average colors
                const colorArray = Object.keys(colorMap).map(key => {
                    const color = colorMap[key];
                    return {
                        r: Math.round(color.r / color.count),
                        g: Math.round(color.g / color.count),
                        b: Math.round(color.b / color.count),
                        count: color.count
                    };
                });
                
                // Sort by frequency and take top k colors
                colorArray.sort((a, b) => b.count - a.count);
                return colorArray.slice(0, k);
            }
            
            // Display the color palette
            function displayColorPalette(colors) {
                colorPaletteResult.innerHTML = '';
                colorCodes.innerHTML = '';
                
                colors.forEach(color => {
                    // Create color swatch
                    const swatch = document.createElement('div');
                    swatch.className = 'color-swatch';
                    swatch.style.backgroundColor = `rgb(${color.r}, ${color.g}, ${color.b})`;
                    swatch.setAttribute('data-color', `rgb(${color.r}, ${color.g}, ${color.b})`);
                    swatch.addEventListener('click', () => {
                        copyToClipboard(`rgb(${color.r}, ${color.g}, ${color.b})`);
                        alert('Color copied to clipboard!');
                    });
                    colorPaletteResult.appendChild(swatch);
                    
                    // Add color code
                    const hex = rgbToHex(color.r, color.g, color.b);
                    const colorCode = document.createElement('div');
                    colorCode.style.marginBottom = '10px';
                    colorCode.innerHTML = `
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="width: 20px; height: 20px; background-color: rgb(${color.r}, ${color.g}, ${color.b}); border: 1px solid var(--color-border);"></div>
                            <span>RGB: ${color.r}, ${color.g}, ${color.b}</span>
                            <span>HEX: ${hex}</span>
                        </div>
                    `;
                    colorCodes.appendChild(colorCode);
                });
                
                colorCodesOutput.style.display = 'block';
            }
            
            // Convert RGB to HEX
            function rgbToHex(r, g, b) {
                return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
            }
            
            // Copy to clipboard utility
            function copyToClipboard(text) {
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
            }
        }

        // Favicon Generator Tool
        function setupFaviconGeneratorTool(modalOverlay) {
            const imageFileInput = modalOverlay.querySelector('#imageFile');
            const fileUploadArea = modalOverlay.querySelector('#imageUploadArea');
            const faviconSizes = modalOverlay.querySelectorAll('input[name="faviconSize"]');
            const faviconBackground = modalOverlay.querySelector('#faviconBackground');
            const customColorContainer = modalOverlay.querySelector('#customColorContainer');
            const customBgColor = modalOverlay.querySelector('#customBgColor');
            const generateFaviconBtn = modalOverlay.querySelector('#generateFaviconBtn');
            const resetFaviconBtn = modalOverlay.querySelector('#resetFaviconBtn');
            const faviconOutput = modalOverlay.querySelector('#faviconOutput');
            const faviconPreview = modalOverlay.querySelector('#faviconPreview');
            
            let originalImage = null;
            
            // File upload area click handler
            fileUploadArea.addEventListener('click', () => {
                imageFileInput.click();
            });
            
            // File input change handler
            imageFileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    
                    reader.onload = function(event) {
                        originalImage = new Image();
                        originalImage.onload = function() {
                            // Image loaded successfully
                        };
                        originalImage.src = event.target.result;
                    };
                    
                    reader.readAsDataURL(file);
                }
            });
            
            // Background type change handler
            faviconBackground.addEventListener('change', () => {
                if (faviconBackground.value === 'custom') {
                    customColorContainer.style.display = 'block';
                } else {
                    customColorContainer.style.display = 'none';
                }
            });
            
            // Generate favicon button handler
            generateFaviconBtn.addEventListener('click', () => {
                if (!originalImage) {
                    alert('Please upload an image first.');
                    return;
                }
                
                // Get selected sizes
                const selectedSizes = Array.from(faviconSizes)
                    .filter(checkbox => checkbox.checked)
                    .map(checkbox => parseInt(checkbox.value));
                
                if (selectedSizes.length === 0) {
                    alert('Please select at least one favicon size.');
                    return;
                }
                
                // Generate favicons for each size
                faviconPreview.innerHTML = '';
                
                selectedSizes.forEach(size => {
                    const faviconCanvas = document.createElement('canvas');
                    faviconCanvas.width = size;
                    faviconCanvas.height = size;
                    const ctx = faviconCanvas.getContext('2d');
                    
                    // Set background
                    if (faviconBackground.value === 'transparent') {
                        // Transparent background - do nothing
                    } else {
                        let bgColor = '#ffffff';
                        if (faviconBackground.value === 'white') bgColor = '#ffffff';
                        else if (faviconBackground.value === 'black') bgColor = '#000000';
                        else if (faviconBackground.value === 'custom') bgColor = customBgColor.value;
                        
                        ctx.fillStyle = bgColor;
                        ctx.fillRect(0, 0, size, size);
                    }
                    
                    // Draw the image centered and scaled to fit
                    const scale = Math.min(size / originalImage.width, size / originalImage.height) * 0.9; // 90% scale to add padding
                    const scaledWidth = originalImage.width * scale;
                    const scaledHeight = originalImage.height * scale;
                    const x = (size - scaledWidth) / 2;
                    const y = (size - scaledHeight) / 2;
                    
                    ctx.drawImage(originalImage, x, y, scaledWidth, scaledHeight);
                    
                    // Create download link
                    const dataUrl = faviconCanvas.toDataURL('image/png');
                    const a = document.createElement('a');
                    a.href = dataUrl;
                    a.download = `favicon-${size}x${size}.png`;
                    
                    // Create preview
                    const previewItem = document.createElement('div');
                    previewItem.style.textAlign = 'center';
                    previewItem.style.marginBottom = '15px';
                    previewItem.innerHTML = `
                        <div style="margin-bottom: 5px;">${size}x${size}</div>
                        <img src="${dataUrl}" alt="Favicon ${size}x${size}" style="border: 1px solid var(--color-border); max-width: 100px;">
                        <div style="margin-top: 5px;">
                            <a href="${dataUrl}" download="favicon-${size}x${size}.png" class="secondary-button" style="display: inline-block; padding: 5px 10px; font-size: 0.8rem;">Download</a>
                        </div>
                    `;
                    faviconPreview.appendChild(previewItem);
                });
                
                faviconOutput.style.display = 'block';
            });
            
            // Reset button handler
            resetFaviconBtn.addEventListener('click', () => {
                imageFileInput.value = '';
                faviconSizes.forEach(checkbox => {
                    if (['16', '32', '48'].includes(checkbox.value)) {
                        checkbox.checked = true;
                    } else {
                        checkbox.checked = false;
                    }
                });
                faviconBackground.value = 'transparent';
                customColorContainer.style.display = 'none';
                customBgColor.value = '#ffffff';
                faviconOutput.style.display = 'none';
                originalImage = null;
            });
        }

        // Image Steganography Tool
        function setupImageSteganographyTool(modalOverlay) {
            const stegMode = modalOverlay.querySelector('#stegMode');
            const encodeOptions = modalOverlay.querySelector('#encodeOptions');
            const decodeOptions = modalOverlay.querySelector('#decodeOptions');
            const imageFileInput = modalOverlay.querySelector('#imageFile');
            const fileUploadArea = modalOverlay.querySelector('#imageUploadArea');
            const secretMessage = modalOverlay.querySelector('#secretMessage');
            const encodePassword = modalOverlay.querySelector('#encodePassword');
            const encodeMessageBtn = modalOverlay.querySelector('#encodeMessageBtn');
            const stegImageFileInput = modalOverlay.querySelector('#stegImageFile');
            const stegImageUploadArea = modalOverlay.querySelector('#stegImageUploadArea');
            const decodePassword = modalOverlay.querySelector('#decodePassword');
            const decodeMessageBtn = modalOverlay.querySelector('#decodeMessageBtn');
            const extractedMessage = modalOverlay.querySelector('#extractedMessage');
            const resetStegBtn = modalOverlay.querySelector('#resetStegBtn');
            
            // Mode change handler
            stegMode.addEventListener('change', () => {
                if (stegMode.value === 'encode') {
                    encodeOptions.style.display = 'block';
                    decodeOptions.style.display = 'none';
                } else {
                    encodeOptions.style.display = 'none';
                    decodeOptions.style.display = 'block';
                }
            });
            
            // File upload area click handlers
            fileUploadArea.addEventListener('click', () => {
                imageFileInput.click();
            });
            
            stegImageUploadArea.addEventListener('click', () => {
                stegImageFileInput.click();
            });
            
            // Encode message button handler
            encodeMessageBtn.addEventListener('click', () => {
                if (!imageFileInput.files.length) {
                    alert('Please upload an image first.');
                    return;
                }
                
                if (!secretMessage.value.trim()) {
                    alert('Please enter a secret message.');
                    return;
                }
                
                // Simple steganography implementation
                const file = imageFileInput.files[0];
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    const img = new Image();
                    img.onload = function() {
                        // Create canvas
                        const canvas = document.createElement('canvas');
                        canvas.width = img.width;
                        canvas.height = img.height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0);
                        
                        // Get image data
                        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                        const data = imageData.data;
                        
                        // Convert message to binary
                        let message = secretMessage.value;
                        if (encodePassword.value) {
                            // Simple "encryption" by XOR with password
                            message = xorEncrypt(message, encodePassword.value);
                        }
                        
                        const binaryMessage = textToBinary(message + String.fromCharCode(0)); // Null terminator
                        
                        // Check if message fits in image
                        if (binaryMessage.length > data.length * 4) {
                            alert('Message is too long for this image. Try a shorter message or a larger image.');
                            return;
                        }
                        
                        // Encode message in LSB of RGB channels
                        let messageIndex = 0;
                        for (let i = 0; i < data.length && messageIndex < binaryMessage.length; i += 4) {
                            // Skip alpha channel for simplicity
                            for (let j = 0; j < 3 && messageIndex < binaryMessage.length; j++) {
                                // Clear the least significant bit
                                data[i + j] = data[i + j] & 0xFE;
                                // Set the least significant bit to the message bit
                                data[i + j] = data[i + j] | parseInt(binaryMessage[messageIndex]);
                                messageIndex++;
                            }
                        }
                        
                        // Update image data
                        ctx.putImageData(imageData, 0, 0);
                        
                        // Create download link
                        const dataUrl = canvas.toDataURL('image/png');
                        const a = document.createElement('a');
                        a.href = dataUrl;
                        a.download = 'steganographic-image.png';
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        
                        alert('Message encoded successfully! Download the image and share it securely.');
                    };
                    img.src = event.target.result;
                };
                
                reader.readAsDataURL(file);
            });
            
            // Decode message button handler
            decodeMessageBtn.addEventListener('click', () => {
                if (!stegImageFileInput.files.length) {
                    alert('Please upload an image with a hidden message.');
                    return;
                }
                
                const file = stegImageFileInput.files[0];
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    const img = new Image();
                    img.onload = function() {
                        // Create canvas
                        const canvas = document.createElement('canvas');
                        canvas.width = img.width;
                        canvas.height = img.height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0);
                        
                        // Get image data
                        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                        const data = imageData.data;
                        
                        // Extract message from LSB of RGB channels
                        let binaryMessage = '';
                        for (let i = 0; i < data.length; i += 4) {
                            // Skip alpha channel
                            for (let j = 0; j < 3; j++) {
                                // Get the least significant bit
                                binaryMessage += data[i + j] & 1;
                            }
                        }
                        
                        // Convert binary to text
                        let message = binaryToText(binaryMessage);
                        
                        if (decodePassword.value) {
                            // Try to decrypt with password
                            message = xorDecrypt(message, decodePassword.value);
                        }
                        
                        extractedMessage.value = message;
                    };
                    img.src = event.target.result;
                };
                
                reader.readAsDataURL(file);
            });
            
            // Reset button handler
            resetStegBtn.addEventListener('click', () => {
                imageFileInput.value = '';
                stegImageFileInput.value = '';
                secretMessage.value = '';
                encodePassword.value = '';
                decodePassword.value = '';
                extractedMessage.value = '';
                stegMode.value = 'encode';
                encodeOptions.style.display = 'block';
                decodeOptions.style.display = 'none';
            });
            
            // Helper functions for steganography
            function textToBinary(text) {
                return text.split('').map(char => {
                    return char.charCodeAt(0).toString(2).padStart(8, '0');
                }).join('');
            }
            
            function binaryToText(binary) {
                let text = '';
                for (let i = 0; i < binary.length; i += 8) {
                    const byte = binary.substr(i, 8);
                    if (byte.length < 8) break;
                    const charCode = parseInt(byte, 2);
                    if (charCode === 0) break; // Null terminator
                    text += String.fromCharCode(charCode);
                }
                return text;
            }
            
            function xorEncrypt(text, password) {
                let result = '';
                for (let i = 0; i < text.length; i++) {
                    const charCode = text.charCodeAt(i) ^ password.charCodeAt(i % password.length);
                    result += String.fromCharCode(charCode);
                }
                return result;
            }
            
            function xorDecrypt(text, password) {
                // XOR encryption is symmetric
                return xorEncrypt(text, password);
            }
        }

        // ‚úÖ Merge Images Tool (Fully Fixed Version)
function setupMergeImagesTool(modalOverlay) {
    const imageFilesInput = modalOverlay.querySelector('#imageFiles');
    const fileUploadArea = modalOverlay.querySelector('#imageUploadArea');
    const imagePreview = modalOverlay.querySelector('#imagePreview');
    const mergeLayout = modalOverlay.querySelector('#mergeLayout');
    const mergeSpacing = modalOverlay.querySelector('#mergeSpacing');
    const mergeBgColor = modalOverlay.querySelector('#mergeBgColor');
    const mergeFormat = modalOverlay.querySelector('#mergeFormat');
    const mergeImagesBtn = modalOverlay.querySelector('#mergeImagesBtn');
    const resetMergeBtn = modalOverlay.querySelector('#resetMergeBtn');

    let uploadedImages = [];

    // üñ±Ô∏è Click area opens file dialog
    fileUploadArea.addEventListener('click', () => {
        imageFilesInput.click();
    });

    // üìÅ File input handler (FIXED to allow multiple uploads)
    imageFilesInput.addEventListener('change', (e) => {
        if (e.target.files.length > 0) {
            const newFiles = Array.from(e.target.files);

            // Avoid duplicates
            newFiles.forEach(file => {
                if (!uploadedImages.some(f => f.name === file.name && f.size === file.size)) {
                    uploadedImages.push(file);
                }
            });

            displayImagePreviews(uploadedImages);

            // Reset input so selecting the same file again triggers change event
            imageFilesInput.value = '';
        }
    });

    // üîÑ Reset button
    resetMergeBtn.addEventListener('click', () => {
        imageFilesInput.value = '';
        imagePreview.innerHTML = '';
        mergeLayout.value = 'horizontal';
        mergeSpacing.value = '10';
        mergeBgColor.value = '#ffffff';
        mergeFormat.value = 'png';
        uploadedImages = [];
    });

    // üß© Merge images
    mergeImagesBtn.addEventListener('click', () => {
        if (uploadedImages.length < 2) {
            alert('Please upload at least 2 images to merge.');
            return;
        }

        // Load all images into memory
        const imagePromises = uploadedImages.map(file => {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => resolve(img);
                img.src = URL.createObjectURL(file);
            });
        });

        Promise.all(imagePromises).then(images => {
            const spacing = parseInt(mergeSpacing.value);
            let mergedWidth, mergedHeight;

            // üìê Calculate canvas size based on layout
            if (mergeLayout.value === 'horizontal') {
                mergedWidth = images.reduce((sum, img) => sum + img.width, 0) + (spacing * (images.length - 1));
                mergedHeight = Math.max(...images.map(img => img.height));
            } else if (mergeLayout.value === 'vertical') {
                mergedWidth = Math.max(...images.map(img => img.width));
                mergedHeight = images.reduce((sum, img) => sum + img.height, 0) + (spacing * (images.length - 1));
            } else { // grid layout
                const cols = Math.ceil(Math.sqrt(images.length));
                const rows = Math.ceil(images.length / cols);
                const maxWidth = Math.max(...images.map(img => img.width));
                const maxHeight = Math.max(...images.map(img => img.height));
                mergedWidth = maxWidth * cols + spacing * (cols - 1);
                mergedHeight = maxHeight * rows + spacing * (rows - 1);
            }

            // üñºÔ∏è Create canvas
            const mergedCanvas = document.createElement('canvas');
            mergedCanvas.width = mergedWidth;
            mergedCanvas.height = mergedHeight;
            const ctx = mergedCanvas.getContext('2d');

            // üé® Fill background
            ctx.fillStyle = mergeBgColor.value;
            ctx.fillRect(0, 0, mergedWidth, mergedHeight);

            // üß© Draw images according to layout
            let x = 0, y = 0;

            if (mergeLayout.value === 'horizontal') {
                images.forEach(img => {
                    ctx.drawImage(img, x, (mergedHeight - img.height) / 2);
                    x += img.width + spacing;
                });
            } else if (mergeLayout.value === 'vertical') {
                images.forEach(img => {
                    ctx.drawImage(img, (mergedWidth - img.width) / 2, y);
                    y += img.height + spacing;
                });
            } else { // grid
                const cols = Math.ceil(Math.sqrt(images.length));
                const maxWidth = Math.max(...images.map(img => img.width));
                const maxHeight = Math.max(...images.map(img => img.height));

                images.forEach((img, index) => {
                    const col = index % cols;
                    const row = Math.floor(index / cols);

                    x = col * (maxWidth + spacing);
                    y = row * (maxHeight + spacing);

                    const imgX = x + (maxWidth - img.width) / 2;
                    const imgY = y + (maxHeight - img.height) / 2;

                    ctx.drawImage(img, imgX, imgY);
                });
            }

            // üíæ Download merged result
            let mimeType, fileExtension;
            if (mergeFormat.value === 'png') {
                mimeType = 'image/png';
                fileExtension = 'png';
            } else if (mergeFormat.value === 'jpeg') {
                mimeType = 'image/jpeg';
                fileExtension = 'jpg';
            } else {
                mimeType = 'image/webp';
                fileExtension = 'webp';
            }

            const dataUrl = mergedCanvas.toDataURL(mimeType);
            const a = document.createElement('a');
            a.href = dataUrl;
            a.download = `merged-images.${fileExtension}`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        });
    });

    // üñºÔ∏è Display previews
    function displayImagePreviews(images) {
        imagePreview.innerHTML = '';

        images.forEach((file, index) => {
            const reader = new FileReader();

            reader.onload = function (event) {
                const previewItem = document.createElement('div');
                previewItem.className = 'preview-item';

                const img = document.createElement('img');
                img.src = event.target.result;

                const removeBtn = document.createElement('button');
                removeBtn.className = 'remove-btn';
                removeBtn.innerHTML = '√ó';
                removeBtn.addEventListener('click', () => {
                    uploadedImages.splice(index, 1);
                    displayImagePreviews(uploadedImages);
                });

                previewItem.appendChild(img);
                previewItem.appendChild(removeBtn);
                imagePreview.appendChild(previewItem);
            };

            reader.readAsDataURL(file);
        });
    }
}

     // üéµ Audio Trimmer Tool (Fully Fixed and Working)
function setupAudioTrimmerTool(modalOverlay) {
    const audioFileInput = modalOverlay.querySelector('#audioFile');
    const audioUploadArea = modalOverlay.querySelector('#audioUploadArea');
    const audioPlayer = modalOverlay.querySelector('#audioPlayer');
    const startTime = modalOverlay.querySelector('#startTime');
    const startTimeValue = modalOverlay.querySelector('#startTimeValue');
    const endTime = modalOverlay.querySelector('#endTime');
    const endTimeValue = modalOverlay.querySelector('#endTimeValue');
    const audioFormat = modalOverlay.querySelector('#audioFormat');
    const trimAudioBtn = modalOverlay.querySelector('#trimAudioBtn');
    const resetAudioBtn = modalOverlay.querySelector('#resetAudioBtn');

    let audioContext = null;
    let audioBuffer = null;
    let fileName = '';

    // üñ±Ô∏è File upload area click
    audioUploadArea.addEventListener('click', () => {
        audioFileInput.click();
    });

    // üìÅ Load audio
    audioFileInput.addEventListener('change', (e) => {
        if (e.target.files.length > 0) {
            const file = e.target.files[0];
            fileName = file.name.split('.').slice(0, -1).join('.');
            const url = URL.createObjectURL(file);
            audioPlayer.src = url;

            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }

            const reader = new FileReader();
            reader.onload = function (event) {
                audioContext.decodeAudioData(event.target.result).then(buffer => {
                    audioBuffer = buffer;

                    const duration = buffer.duration;
                    startTime.max = duration;
                    endTime.max = duration;
                    startTime.value = 0;
                    endTime.value = duration;

                    startTimeValue.textContent = '0s';
                    endTimeValue.textContent = `${duration.toFixed(1)}s`;
                });
            };
            reader.readAsArrayBuffer(file);
        }
    });

    // ‚è±Ô∏è Update displayed time values
    startTime.addEventListener('input', () => {
        const start = parseFloat(startTime.value);
        startTimeValue.textContent = `${start.toFixed(1)}s`;
        if (parseFloat(endTime.value) < start) {
            endTime.value = start;
            endTimeValue.textContent = `${start.toFixed(1)}s`;
        }
    });

    endTime.addEventListener('input', () => {
        const end = parseFloat(endTime.value);
        endTimeValue.textContent = `${end.toFixed(1)}s`;
    });

    // ‚úÇÔ∏è Trim and Download
    trimAudioBtn.addEventListener('click', async () => {
        if (!audioBuffer) {
            alert('Please upload an audio file first.');
            return;
        }

        const start = parseFloat(startTime.value);
        const end = parseFloat(endTime.value);

        if (start >= end) {
            alert('Start time must be less than end time.');
            return;
        }

        const sampleRate = audioBuffer.sampleRate;
        const startSample = Math.floor(start * sampleRate);
        const endSample = Math.floor(end * sampleRate);
        const length = endSample - startSample;

        // Create new trimmed buffer
        const trimmedBuffer = audioContext.createBuffer(
            audioBuffer.numberOfChannels,
            length,
            sampleRate
        );

        for (let channel = 0; channel < audioBuffer.numberOfChannels; channel++) {
            const channelData = audioBuffer.getChannelData(channel);
            trimmedBuffer.copyToChannel(channelData.subarray(startSample, endSample), channel);
        }

        // Convert buffer to WAV
        const wavBlob = bufferToWav(trimmedBuffer);
        const blobUrl = URL.createObjectURL(wavBlob);

        // Download trimmed file
        const a = document.createElement('a');
        a.href = blobUrl;
        const format = audioFormat.value || 'wav';
        a.download = `${fileName || 'trimmed-audio'}.${format}`;
        a.click();

        alert('‚úÖ Audio trimmed successfully and downloaded!');
    });

    // üîÅ Reset
    resetAudioBtn.addEventListener('click', () => {
        audioFileInput.value = '';
        audioPlayer.src = '';
        startTime.value = 0;
        endTime.value = 0;
        startTimeValue.textContent = '0s';
        endTimeValue.textContent = '0s';
        audioFormat.value = 'wav';
        audioBuffer = null;
    });

    // üß† Convert AudioBuffer ‚Üí WAV Blob
    function bufferToWav(buffer) {
        const numOfChan = buffer.numberOfChannels,
              length = buffer.length * numOfChan * 2 + 44,
              bufferView = new ArrayBuffer(length),
              view = new DataView(bufferView),
              channels = [],
              sampleRate = buffer.sampleRate;

        let offset = 0;
        let pos = 0;

        function setUint16(data) { view.setUint16(pos, data, true); pos += 2; }
        function setUint32(data) { view.setUint32(pos, data, true); pos += 4; }

        // RIFF chunk descriptor
        setUint32(0x46464952);
        setUint32(length - 8);
        setUint32(0x45564157);

        // FMT sub-chunk
        setUint32(0x20746d66);
        setUint32(16);
        setUint16(1);
        setUint16(numOfChan);
        setUint32(sampleRate);
        setUint32(sampleRate * 2 * numOfChan);
        setUint16(numOfChan * 2);
        setUint16(16);

        // data sub-chunk
        setUint32(0x61746164);
        setUint32(length - pos - 4);

        for (let i = 0; i < numOfChan; i++) channels.push(buffer.getChannelData(i));

        while (pos < length) {
            for (let i = 0; i < numOfChan; i++) {
                let sample = Math.max(-1, Math.min(1, channels[i][offset]));
                view.setInt16(pos, sample < 0 ? sample * 0x8000 : sample * 0x7FFF, true);
                pos += 2;
            }
            offset++;
        }

        return new Blob([view], { type: 'audio/wav' });
    }
}

        // Speech to Text Tool
        function setupSpeechToTextTool(modalOverlay) {
            const recognitionLanguage = modalOverlay.querySelector('#recognitionLanguage');
            const recognitionMode = modalOverlay.querySelector('#recognitionMode');
            const startRecognitionBtn = modalOverlay.querySelector('#startRecognitionBtn');
            const stopRecognitionBtn = modalOverlay.querySelector('#stopRecognitionBtn');
            const transcriptionResult = modalOverlay.querySelector('#transcriptionResult');
            const copyTranscriptionBtn = modalOverlay.querySelector('#copyTranscriptionBtn');
            const clearTranscriptionBtn = modalOverlay.querySelector('#clearTranscriptionBtn');
            const resetRecognitionBtn = modalOverlay.querySelector('#resetRecognitionBtn');
            
            let recognition = null;
            let isRecognizing = false;
            
            // Check for browser support
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                alert('Speech recognition is not supported in your browser. Please try Chrome or Edge.');
                startRecognitionBtn.disabled = true;
                return;
            }
            
            // Initialize speech recognition
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            
            recognition.continuous = recognitionMode.value === 'continuous';
            recognition.interimResults = true;
            recognition.lang = recognitionLanguage.value;
            
            // Recognition event handlers
            recognition.onstart = function() {
                isRecognizing = true;
                startRecognitionBtn.disabled = true;
                stopRecognitionBtn.disabled = false;
                transcriptionResult.placeholder = 'Listening... Speak now.';
            };
            
            recognition.onresult = function(event) {
                let interimTranscript = '';
                let finalTranscript = '';
                
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    const transcript = event.results[i][0].transcript;
                    if (event.results[i].isFinal) {
                        finalTranscript += transcript + ' ';
                    } else {
                        interimTranscript += transcript;
                    }
                }
                
                transcriptionResult.value = finalTranscript + interimTranscript;
            };
            
            recognition.onerror = function(event) {
                console.error('Speech recognition error:', event.error);
                if (event.error === 'not-allowed') {
                    alert('Microphone access denied. Please allow microphone access and try again.');
                }
                stopRecognition();
            };
            
            recognition.onend = function() {
                stopRecognition();
            };
            
            // Start recognition button handler
            startRecognitionBtn.addEventListener('click', () => {
                if (isRecognizing) return;
                
                recognition.continuous = recognitionMode.value === 'continuous';
                recognition.lang = recognitionLanguage.value;
                
                try {
                    recognition.start();
                } catch (error) {
                    console.error('Error starting speech recognition:', error);
                }
            });
            
            // Stop recognition button handler
            stopRecognitionBtn.addEventListener('click', () => {
                stopRecognition();
            });
            
            // Copy transcription button handler
            copyTranscriptionBtn.addEventListener('click', () => {
                transcriptionResult.select();
                document.execCommand('copy');
                alert('Transcription copied to clipboard!');
            });
            
            // Clear transcription button handler
            clearTranscriptionBtn.addEventListener('click', () => {
                transcriptionResult.value = '';
            });
            
            // Reset button handler
            resetRecognitionBtn.addEventListener('click', () => {
                stopRecognition();
                recognitionLanguage.value = 'en-US';
                recognitionMode.value = 'continuous';
                transcriptionResult.value = '';
            });
            
            // Stop recognition function
            function stopRecognition() {
                if (recognition && isRecognizing) {
                    recognition.stop();
                }
                isRecognizing = false;
                startRecognitionBtn.disabled = false;
                stopRecognitionBtn.disabled = true;
                transcriptionResult.placeholder = 'Speech will be transcribed here...';
            }
        }

        // EMI Calculator Tool
        function setupEmiCalculatorTool(modalOverlay) {
            const loanAmount = modalOverlay.querySelector('#loanAmount');
            const interestRate = modalOverlay.querySelector('#interestRate');
            const loanTerm = modalOverlay.querySelector('#loanTerm');
            const paymentFrequency = modalOverlay.querySelector('#paymentFrequency');
            const calculateEmiBtn = modalOverlay.querySelector('#calculateEmiBtn');
            const resetEmiBtn = modalOverlay.querySelector('#resetEmiBtn');
            const emiDetails = modalOverlay.querySelector('#emiDetails');
            
            // Calculate EMI button handler
            calculateEmiBtn.addEventListener('click', () => {
                const amount = parseFloat(loanAmount.value);
                const rate = parseFloat(interestRate.value);
                const term = parseFloat(loanTerm.value);
                
                if (isNaN(amount) || isNaN(rate) || isNaN(term) || amount <= 0 || rate <= 0 || term <= 0) {
                    alert('Please enter valid loan details.');
                    return;
                }
                
                // Convert annual rate to monthly and term to months
                let monthlyRate, numberOfPayments;
                
                if (paymentFrequency.value === 'monthly') {
                    monthlyRate = rate / 12 / 100;
                    numberOfPayments = term * 12;
                } else if (paymentFrequency.value === 'quarterly') {
                    monthlyRate = rate / 4 / 100;
                    numberOfPayments = term * 4;
                } else { // yearly
                    monthlyRate = rate / 100;
                    numberOfPayments = term;
                }
                
                // Calculate EMI using the formula
                const emi = amount * monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments) / 
                           (Math.pow(1 + monthlyRate, numberOfPayments) - 1);
                
                const totalPayment = emi * numberOfPayments;
                const totalInterest = totalPayment - amount;
                
                // Display results
                emiDetails.innerHTML = `
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>EMI Amount:</div>
                        <div><strong>${formatCurrency(emi)}</strong></div>
                        <div>Total Payment:</div>
                        <div><strong>${formatCurrency(totalPayment)}</strong></div>
                        <div>Principal Amount:</div>
                        <div><strong>${formatCurrency(amount)}</strong></div>
                        <div>Total Interest:</div>
                        <div><strong>${formatCurrency(totalInterest)}</strong></div>
                        <div>Number of Payments:</div>
                        <div><strong>${numberOfPayments}</strong></div>
                    </div>
                `;
            });
            
            // Reset button handler
            resetEmiBtn.addEventListener('click', () => {
                loanAmount.value = '';
                interestRate.value = '';
                loanTerm.value = '';
                paymentFrequency.value = 'monthly';
                emiDetails.innerHTML = 'Enter loan details to calculate EMI';
            });
            
            // Format currency
            function formatCurrency(amount) {
                return '$' + amount.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
            }
        }

        // SIP Calculator Tool
        function setupSipCalculatorTool(modalOverlay) {
            const monthlyInvestment = modalOverlay.querySelector('#monthlyInvestment');
            const expectedReturn = modalOverlay.querySelector('#expectedReturn');
            const investmentPeriod = modalOverlay.querySelector('#investmentPeriod');
            const inflationRate = modalOverlay.querySelector('#inflationRate');
            const calculateSipBtn = modalOverlay.querySelector('#calculateSipBtn');
            const resetSipBtn = modalOverlay.querySelector('#resetSipBtn');
            const sipDetails = modalOverlay.querySelector('#sipDetails');
            
            // Calculate SIP button handler
            calculateSipBtn.addEventListener('click', () => {
                const investment = parseFloat(monthlyInvestment.value);
                const returnRate = parseFloat(expectedReturn.value);
                const period = parseFloat(investmentPeriod.value);
                const inflation = parseFloat(inflationRate.value);
                
                if (isNaN(investment) || isNaN(returnRate) || isNaN(period) || investment <= 0 || returnRate <= 0 || period <= 0) {
                    alert('Please enter valid investment details.');
                    return;
                }
                
                // Calculate future value of SIP
                const monthlyRate = returnRate / 12 / 100;
                const months = period * 12;
                
                const futureValue = investment * ((Math.pow(1 + monthlyRate, months) - 1) / monthlyRate) * (1 + monthlyRate);
                
                // Calculate total investment
                const totalInvestment = investment * months;
                
                // Calculate estimated returns
                const estimatedReturns = futureValue - totalInvestment;
                
                // Calculate inflation-adjusted value
                const inflationAdjustedValue = futureValue / Math.pow(1 + inflation / 100, period);
                
                // Display results
                sipDetails.innerHTML = `
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>Monthly Investment:</div>
                        <div><strong>${formatCurrency(investment)}</strong></div>
                        <div>Total Investment:</div>
                        <div><strong>${formatCurrency(totalInvestment)}</strong></div>
                        <div>Expected Amount:</div>
                        <div><strong>${formatCurrency(futureValue)}</strong></div>
                        <div>Estimated Returns:</div>
                        <div><strong>${formatCurrency(estimatedReturns)}</strong></div>
                        <div>Inflation Adjusted Value:</div>
                        <div><strong>${formatCurrency(inflationAdjustedValue)}</strong></div>
                    </div>
                `;
            });
            
            // Reset button handler
            resetSipBtn.addEventListener('click', () => {
                monthlyInvestment.value = '';
                expectedReturn.value = '';
                investmentPeriod.value = '';
                inflationRate.value = '6';
                sipDetails.innerHTML = 'Enter investment details to calculate SIP returns';
            });
            
            // Format currency
            function formatCurrency(amount) {
                return '$' + amount.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
            }
        }
        

        // Age Calculator Tool
          function setupAgeCalculatorTool(modalOverlay) {
            // Implementation for age calculator tool
            const birthDateInput = modalOverlay.querySelector('#birthDate');
            const calculateAgeBtn = modalOverlay.querySelector('#calculateAgeBtn');
            const resetAgeBtn = modalOverlay.querySelector('#resetAgeBtn');
            const ageResult = modalOverlay.querySelector('#ageResult');
            
            // Set max date to today
            const today = new Date();
            const maxDate = today.toISOString().split('T')[0];
            birthDateInput.max = maxDate;
            
            // Calculate age button handler
            calculateAgeBtn.addEventListener('click', () => {
                if (!birthDateInput.value) {
                    alert('Please select your birth date.');
                    return;
                }
                
                const birthDate = new Date(birthDateInput.value);
                const today = new Date();
                
                let years = today.getFullYear() - birthDate.getFullYear();
                let months = today.getMonth() - birthDate.getMonth();
                let days = today.getDate() - birthDate.getDate();
                
                if (days < 0) {
                    months--;
                    // Get the last day of the previous month
                    const lastDayOfMonth = new Date(today.getFullYear(), today.getMonth(), 0).getDate();
                    days += lastDayOfMonth;
                }
                
                if (months < 0) {
                    years--;
                    months += 12;
                }
                
                ageResult.textContent = `${years} years, ${months} months, ${days} days`;
            });
            
            // Reset button handler
            resetAgeBtn.addEventListener('click', () => {
                birthDateInput.value = '';
                ageResult.textContent = 'Enter your birth date to calculate age';
            });
        }


        // BMI Calculator Tool
        function setupBmiCalculatorTool(modalOverlay) {
            const measurementSystem = modalOverlay.querySelector('#measurementSystem');
            const metricInputs = modalOverlay.querySelector('#metricInputs');
            const imperialInputs = modalOverlay.querySelector('#imperialInputs');
            const weightKg = modalOverlay.querySelector('#weightKg');
            const heightCm = modalOverlay.querySelector('#heightCm');
            const weightLbs = modalOverlay.querySelector('#weightLbs');
            const heightFeet = modalOverlay.querySelector('#heightFeet');
            const heightInches = modalOverlay.querySelector('#heightInches');
            const age = modalOverlay.querySelector('#age');
            const gender = modalOverlay.querySelector('#gender');
            const calculateBmiBtn = modalOverlay.querySelector('#calculateBmiBtn');
            const resetBmiBtn = modalOverlay.querySelector('#resetBmiBtn');
            const bmiDetails = modalOverlay.querySelector('#bmiDetails');
            
            // Measurement system change handler
            measurementSystem.addEventListener('change', () => {
                if (measurementSystem.value === 'metric') {
                    metricInputs.style.display = 'block';
                    imperialInputs.style.display = 'none';
                } else {
                    metricInputs.style.display = 'none';
                    imperialInputs.style.display = 'block';
                }
            });
            
            // Calculate BMI button handler
            calculateBmiBtn.addEventListener('click', () => {
                let weight, height;
                
                if (measurementSystem.value === 'metric') {
                    weight = parseFloat(weightKg.value);
                    height = parseFloat(heightCm.value) / 100; // Convert cm to m
                } else {
                    weight = parseFloat(weightLbs.value);
                    const feet = parseFloat(heightFeet.value);
                    const inches = parseFloat(heightInches.value);
                    height = (feet * 12 + inches) * 0.0254; // Convert inches to m
                    
                    // Convert lbs to kg for calculation
                    weight = weight * 0.453592;
                }
                
                const ageValue = parseFloat(age.value);
                const genderValue = gender.value;
                
                if (isNaN(weight) || isNaN(height) || weight <= 0 || height <= 0) {
                    alert('Please enter valid weight and height values.');
                    return;
                }
                
                // Calculate BMI
                const bmi = weight / (height * height);
                
                // Determine BMI category
                let category, color;
                if (bmi < 18.5) {
                    category = 'Underweight';
                    color = '#ffc107'; // Yellow
                } else if (bmi < 25) {
                    category = 'Normal weight';
                    color = '#28a745'; // Green
                } else if (bmi < 30) {
                    category = 'Overweight';
                    color = '#fd7e14'; // Orange
                } else {
                    category = 'Obese';
                    color = '#dc3545'; // Red
                }
                
                // Display results
                bmiDetails.innerHTML = `
                    <div style="text-align: center; margin-bottom: 15px;">
                        <div style="font-size: 2rem; font-weight: bold; color: ${color};">${bmi.toFixed(1)}</div>
                        <div style="font-size: 1.2rem; color: ${color};">${category}</div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>BMI Category:</div>
                        <div><strong>${category}</strong></div>
                        <div>Weight Status:</div>
                        <div><strong>${getWeightStatus(bmi)}</strong></div>
                    </div>
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--color-text-secondary);">
                        <strong>Note:</strong> BMI is a screening tool, not a diagnostic of body fatness or health.
                    </div>
                `;
            });
            
            // Reset button handler
            resetBmiBtn.addEventListener('click', () => {
                weightKg.value = '';
                heightCm.value = '';
                weightLbs.value = '';
                heightFeet.value = '';
                heightInches.value = '';
                age.value = '';
                gender.value = 'male';
                measurementSystem.value = 'metric';
                metricInputs.style.display = 'block';
                imperialInputs.style.display = 'none';
                bmiDetails.innerHTML = 'Enter your details to calculate BMI';
            });
            
            // Get weight status based on BMI
            function getWeightStatus(bmi) {
                if (bmi < 16) return 'Severe thinness';
                if (bmi < 17) return 'Moderate thinness';
                if (bmi < 18.5) return 'Mild thinness';
                if (bmi < 25) return 'Normal';
                if (bmi < 30) return 'Overweight';
                if (bmi < 35) return 'Obese Class I';
                if (bmi < 40) return 'Obese Class II';
                return 'Obese Class III';
            }
        }

        // Unit Price Calculator Tool
        function setupUnitPriceCalculatorTool(modalOverlay) {
            const product1Price = modalOverlay.querySelector('#product1Price');
            const product1Quantity = modalOverlay.querySelector('#product1Quantity');
            const product1Unit = modalOverlay.querySelector('#product1Unit');
            const product2Price = modalOverlay.querySelector('#product2Price');
            const product2Quantity = modalOverlay.querySelector('#product2Quantity');
            const product2Unit = modalOverlay.querySelector('#product2Unit');
            const currency = modalOverlay.querySelector('#currency');
            const comparePricesBtn = modalOverlay.querySelector('#comparePricesBtn');
            const resetPriceBtn = modalOverlay.querySelector('#resetPriceBtn');
            const priceDetails = modalOverlay.querySelector('#priceDetails');
            
            // Compare prices button handler
            comparePricesBtn.addEventListener('click', () => {
                const price1 = parseFloat(product1Price.value);
                const quantity1 = parseFloat(product1Quantity.value);
                const unit1 = product1Unit.value.trim();
                
                const price2 = parseFloat(product2Price.value);
                const quantity2 = parseFloat(product2Quantity.value);
                const unit2 = product2Unit.value.trim();
                
                if (isNaN(price1) || isNaN(quantity1) || isNaN(price2) || isNaN(quantity2) || 
                    price1 <= 0 || quantity1 <= 0 || price2 <= 0 || quantity2 <= 0) {
                    alert('Please enter valid price and quantity values for both products.');
                    return;
                }
                
                // Calculate unit prices
                const unitPrice1 = price1 / quantity1;
                const unitPrice2 = price2 / quantity2;
                
                // Determine which is better value
                let betterValue, savings, savingsPercent;
                if (unitPrice1 < unitPrice2) {
                    betterValue = 'Product 1';
                    savings = unitPrice2 - unitPrice1;
                    savingsPercent = ((unitPrice2 - unitPrice1) / unitPrice2) * 100;
                } else {
                    betterValue = 'Product 2';
                    savings = unitPrice1 - unitPrice2;
                    savingsPercent = ((unitPrice1 - unitPrice2) / unitPrice1) * 100;
                }
                
                // Display results
                priceDetails.innerHTML = `
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>Product 1 Unit Price:</div>
                        <div><strong>${currency.value}${unitPrice1.toFixed(2)} per ${unit1 || 'unit'}</strong></div>
                        <div>Product 2 Unit Price:</div>
                        <div><strong>${currency.value}${unitPrice2.toFixed(2)} per ${unit2 || 'unit'}</strong></div>
                        <div>Better Value:</div>
                        <div><strong>${betterValue}</strong></div>
                        <div>Savings per Unit:</div>
                        <div><strong>${currency.value}${savings.toFixed(2)}</strong></div>
                        <div>Savings Percentage:</div>
                        <div><strong>${savingsPercent.toFixed(1)}%</strong></div>
                    </div>
                `;
            });
            
            // Reset button handler
            resetPriceBtn.addEventListener('click', () => {
                product1Price.value = '';
                product1Quantity.value = '';
                product1Unit.value = '';
                product2Price.value = '';
                product2Quantity.value = '';
                product2Unit.value = '';
                currency.value = '$';
                priceDetails.innerHTML = 'Enter product details to compare prices';
            });
        }

        // Word Counter Tool
        function setupWordCounterTool(modalOverlay) {
            const wordCounterInput = modalOverlay.querySelector('#wordCounterInput');
            const countWords = modalOverlay.querySelector('#countWords');
            const countCharacters = modalOverlay.querySelector('#countCharacters');
            const countSentences = modalOverlay.querySelector('#countSentences');
            const countParagraphs = modalOverlay.querySelector('#countParagraphs');
            const countSpaces = modalOverlay.querySelector('#countSpaces');
            const countPunctuation = modalOverlay.querySelector('#countPunctuation');
            const countTextBtn = modalOverlay.querySelector('#countTextBtn');
            const clearTextBtn = modalOverlay.querySelector('#clearTextBtn');
            const resetCounterBtn = modalOverlay.querySelector('#resetCounterBtn');
            const wordCounterDetails = modalOverlay.querySelector('#wordCounterDetails');
            
            // Count text button handler
            countTextBtn.addEventListener('click', () => {
                const text = wordCounterInput.value;
                
                if (!text.trim()) {
                    alert('Please enter some text to analyze.');
                    return;
                }
                
                let results = [];
                
                // Count words
                if (countWords.checked) {
                    const words = text.trim().split(/\s+/).filter(word => word.length > 0);
                    results.push(`Words: ${words.length}`);
                }
                
                // Count characters
                if (countCharacters.checked) {
                    results.push(`Characters: ${text.length}`);
                    results.push(`Characters (no spaces): ${text.replace(/\s/g, '').length}`);
                }
                
                // Count sentences
                if (countSentences.checked) {
                    const sentences = text.split(/[.!?]+/).filter(sentence => sentence.trim().length > 0);
                    results.push(`Sentences: ${sentences.length}`);
                }
                
                // Count paragraphs
                if (countParagraphs.checked) {
                    const paragraphs = text.split(/\n+/).filter(paragraph => paragraph.trim().length > 0);
                    results.push(`Paragraphs: ${paragraphs.length}`);
                }
                
                // Count spaces
                if (countSpaces.checked) {
                    const spaces = (text.match(/\s/g) || []).length;
                    results.push(`Spaces: ${spaces}`);
                }
                
                // Count punctuation
                if (countPunctuation.checked) {
                    const punctuation = (text.match(/[.,!?;:'"-]/g) || []).length;
                    results.push(`Punctuation marks: ${punctuation}`);
                }
                
                // Calculate reading time
                const words = text.trim().split(/\s+/).filter(word => word.length > 0);
                const readingTime = Math.ceil(words.length / 200); // Average reading speed: 200 words per minute
                results.push(`Reading time: ${readingTime} minute${readingTime !== 1 ? 's' : ''}`);
                
                // Display results
                if (results.length > 0) {
                    wordCounterDetails.innerHTML = results.map(result => `<div>${result}</div>`).join('');
                } else {
                    wordCounterDetails.innerHTML = 'Please select at least one counting option.';
                }
            });
            
            // Clear text button handler
            clearTextBtn.addEventListener('click', () => {
                wordCounterInput.value = '';
                wordCounterDetails.innerHTML = 'Enter text to see statistics';
            });
            
            // Reset button handler
            resetCounterBtn.addEventListener('click', () => {
                wordCounterInput.value = '';
                countWords.checked = true;
                countCharacters.checked = true;
                countSentences.checked = false;
                countParagraphs.checked = false;
                countSpaces.checked = false;
                countPunctuation.checked = false;
                wordCounterDetails.innerHTML = 'Enter text to see statistics';
            });
        }

        // Case Converter Tool
        function setupCaseConverterTool(modalOverlay) {
            const caseInput = modalOverlay.querySelector('#caseInput');
            const caseOutput = modalOverlay.querySelector('#caseOutput');
            const toUpperCaseBtn = modalOverlay.querySelector('#toUpperCaseBtn');
            const toLowerCaseBtn = modalOverlay.querySelector('#toLowerCaseBtn');
            const toTitleCaseBtn = modalOverlay.querySelector('#toTitleCaseBtn');
            const toSentenceCaseBtn = modalOverlay.querySelector('#toSentenceCaseBtn');
            const toCamelCaseBtn = modalOverlay.querySelector('#toCamelCaseBtn');
            const toPascalCaseBtn = modalOverlay.querySelector('#toPascalCaseBtn');
            const toSnakeCaseBtn = modalOverlay.querySelector('#toSnakeCaseBtn');
            const toKebabCaseBtn = modalOverlay.querySelector('#toKebabCaseBtn');
            const copyCaseBtn = modalOverlay.querySelector('#copyCaseBtn');
            const swapCaseBtn = modalOverlay.querySelector('#swapCaseBtn');
            const resetCaseBtn = modalOverlay.querySelector('#resetCaseBtn');
            
            // Case conversion button handlers
            toUpperCaseBtn.addEventListener('click', () => {
                caseOutput.value = caseInput.value.toUpperCase();
            });
            
            toLowerCaseBtn.addEventListener('click', () => {
                caseOutput.value = caseInput.value.toLowerCase();
            });
            
            toTitleCaseBtn.addEventListener('click', () => {
                caseOutput.value = toTitleCase(caseInput.value);
            });
            
            toSentenceCaseBtn.addEventListener('click', () => {
                caseOutput.value = toSentenceCase(caseInput.value);
            });
            
            toCamelCaseBtn.addEventListener('click', () => {
                caseOutput.value = toCamelCase(caseInput.value);
            });
            
            toPascalCaseBtn.addEventListener('click', () => {
                caseOutput.value = toPascalCase(caseInput.value);
            });
            
            toSnakeCaseBtn.addEventListener('click', () => {
                caseOutput.value = toSnakeCase(caseInput.value);
            });
            
            toKebabCaseBtn.addEventListener('click', () => {
                caseOutput.value = toKebabCase(caseInput.value);
            });
            
            // Copy button handler
            copyCaseBtn.addEventListener('click', () => {
                if (caseOutput.value) {
                    caseOutput.select();
                    document.execCommand('copy');
                    alert('Text copied to clipboard!');
                }
            });
            
            // Swap case button handler
            swapCaseBtn.addEventListener('click', () => {
                caseOutput.value = swapCase(caseInput.value);
            });
            
            // Reset button handler
            resetCaseBtn.addEventListener('click', () => {
                caseInput.value = '';
                caseOutput.value = '';
            });
            
            // Case conversion functions
            function toTitleCase(text) {
                return text.replace(/\w\S*/g, function(txt) {
                    return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
                });
            }
            
            function toSentenceCase(text) {
                return text.replace(/.+?[\.\?\!](\s|$)/g, function(txt) {
                    return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
                });
            }
            
            function toCamelCase(text) {
                return text.replace(/[^a-zA-Z0-9]+(.)/g, function(match, chr) {
                    return chr.toUpperCase();
                }).replace(/[^a-zA-Z0-9]/g, '').replace(/^[A-Z]/, function(chr) {
                    return chr.toLowerCase();
                });
            }
            
            function toPascalCase(text) {
                return text.replace(/[^a-zA-Z0-9]+(.)/g, function(match, chr) {
                    return chr.toUpperCase();
                }).replace(/[^a-zA-Z0-9]/g, '');
            }
            
            function toSnakeCase(text) {
                return text.replace(/\W+/g, ' ')
                    .split(/ |\B(?=[A-Z])/)
                    .map(word => word.toLowerCase())
                    .join('_');
            }
            
            function toKebabCase(text) {
                return text.replace(/\W+/g, ' ')
                    .split(/ |\B(?=[A-Z])/)
                    .map(word => word.toLowerCase())
                    .join('-');
            }
            
            function swapCase(text) {
                return text.split('').map(char => {
                    if (char === char.toUpperCase()) {
                        return char.toLowerCase();
                    } else {
                        return char.toUpperCase();
                    }
                }).join('');
            }
        }

        // Lorem Ipsum Generator Tool
        function setupLoremIpsumTool(modalOverlay) {
            const paragraphCount = modalOverlay.querySelector('#paragraphCount');
            const paragraphLength = modalOverlay.querySelector('#paragraphLength');
            const startWith = modalOverlay.querySelector('#startWith');
            const includeHtml = modalOverlay.querySelector('#includeHtml');
            const generateLoremBtn = modalOverlay.querySelector('#generateLoremBtn');
            const resetLoremBtn = modalOverlay.querySelector('#resetLoremBtn');
            const loremOutput = modalOverlay.querySelector('#loremOutput');
            const copyLoremBtn = modalOverlay.querySelector('#copyLoremBtn');
            
            // Lorem Ipsum text samples
            const loremText = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.";
            const additionalText = "Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.";
            
            // Generate Lorem Ipsum button handler
            generateLoremBtn.addEventListener('click', () => {
                const count = parseInt(paragraphCount.value);
                const length = paragraphLength.value;
                const start = startWith.value;
                const html = includeHtml.value;
                
                if (isNaN(count) || count < 1 || count > 20) {
                    alert('Please enter a valid number of paragraphs (1-20).');
                    return;
                }
                
                // Generate paragraphs
                let paragraphs = [];
                
                for (let i = 0; i < count; i++) {
                    let paragraph = '';
                    
                    // First paragraph starts with Lorem Ipsum if selected
                    if (i === 0 && start === 'lorem') {
                        paragraph = loremText;
                    } else {
                        paragraph = additionalText;
                    }
                    
                    // Extend paragraph based on length selection
                    if (length === 'short') {
                        // Short paragraph (2-3 sentences)
                        paragraph = paragraph.split('. ').slice(0, 2).join('. ') + '.';
                    } else if (length === 'long') {
                        // Long paragraph (7-10 sentences)
                        paragraph = paragraph + ' ' + loremText + ' ' + additionalText;
                    } else if (length === 'very-long') {
                        // Very long paragraph (10+ sentences)
                        paragraph = paragraph + ' ' + loremText + ' ' + additionalText + ' ' + loremText;
                    }
                    // Medium is the default
                    
                    // Add HTML tags if selected
                    if (html === 'p') {
                        paragraph = `<p>${paragraph}</p>`;
                    } else if (html === 'div') {
                        paragraph = `<div>${paragraph}</div>`;
                    }
                    
                    paragraphs.push(paragraph);
                }
                
                // Join paragraphs with line breaks
                loremOutput.value = paragraphs.join('\n\n');
            });
            
            // Copy button handler
            copyLoremBtn.addEventListener('click', () => {
                if (loremOutput.value) {
                    loremOutput.select();
                    document.execCommand('copy');
                    alert('Lorem Ipsum text copied to clipboard!');
                }
            });
            
            // Reset button handler
            resetLoremBtn.addEventListener('click', () => {
                paragraphCount.value = '3';
                paragraphLength.value = 'medium';
                startWith.value = 'lorem';
                includeHtml.value = 'none';
                loremOutput.value = '';
            });
        }

        // Text Minifier Tool
        function setupTextMinifierTool(modalOverlay) {
            const minifyInput = modalOverlay.querySelector('#minifyInput');
            const minifyLanguage = modalOverlay.querySelector('#minifyLanguage');
            const removeComments = modalOverlay.querySelector('#removeComments');
            const removeWhitespace = modalOverlay.querySelector('#removeWhitespace');
            const collapseWhitespace = modalOverlay.querySelector('#collapseWhitespace');
            const removeEmptyAttributes = modalOverlay.querySelector('#removeEmptyAttributes');
            const minifyTextBtn = modalOverlay.querySelector('#minifyTextBtn');
            const resetMinifyBtn = modalOverlay.querySelector('#resetMinifyBtn');
            const minifyOutput = modalOverlay.querySelector('#minifyOutput');
            const minifyStats = modalOverlay.querySelector('#minifyStats');
            const minifyDetails = modalOverlay.querySelector('#minifyDetails');
            const copyMinifyBtn = modalOverlay.querySelector('#copyMinifyBtn');
            
            // Minify text button handler
            minifyTextBtn.addEventListener('click', () => {
                const text = minifyInput.value;
                const language = minifyLanguage.value;
                
                if (!text.trim()) {
                    alert('Please enter some text to minify.');
                    return;
                }
                
                let minified = text;
                const originalSize = text.length;
                
                // Remove comments
                if (removeComments.checked) {
                    if (language === 'html' || language === 'xml') {
                        minified = minified.replace(/<!--[\s\S]*?-->/g, '');
                    } else if (language === 'css') {
                        minified = minified.replace(/\/\*[\s\S]*?\*\//g, '');
                    } else if (language === 'js') {
                        minified = minified.replace(/\/\/.*$/gm, '').replace(/\/\*[\s\S]*?\*\//g, '');
                    } else {
                        // Auto-detect or general approach
                        minified = minified.replace(/\/\/.*$/gm, '').replace(/\/\*[\s\S]*?\*\//g, '').replace(/<!--[\s\S]*?-->/g, '');
                    }
                }
                
                // Remove whitespace
                if (removeWhitespace.checked) {
                    if (language === 'html' || language === 'xml') {
                        // For HTML/XML, be careful with whitespace in text nodes
                        minified = minified.replace(/>\s+</g, '><');
                    } else if (language === 'css') {
                        minified = minified.replace(/\s+/g, ' ');
                    } else if (language === 'js') {
                        minified = minified.replace(/\s+/g, ' ');
                    } else {
                        // General approach
                        minified = minified.replace(/\s+/g, ' ');
                    }
                }
                
                // Collapse whitespace
                if (collapseWhitespace.checked) {
                    minified = minified.replace(/\s+/g, ' ');
                }
                
                // Remove empty attributes (for HTML/XML)
                if (removeEmptyAttributes.checked && (language === 'html' || language === 'xml' || language === 'auto')) {
                    minified = minified.replace(/\s+(\w+)=""/g, '');
                }
                
                // Trim the result
                minified = minified.trim();
                
                // Calculate compression statistics
                const minifiedSize = minified.length;
                const compressionRatio = ((originalSize - minifiedSize) / originalSize * 100).toFixed(1);
                
                // Display minified text
                minifyOutput.value = minified;
                
                // Display compression statistics
                minifyStats.style.display = 'block';
                minifyDetails.innerHTML = `
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>Original Size:</div>
                        <div>${originalSize} characters</div>
                        <div>Minified Size:</div>
                        <div>${minifiedSize} characters</div>
                        <div>Reduction:</div>
                        <div>${originalSize - minifiedSize} characters</div>
                        <div>Compression Ratio:</div>
                        <div>${compressionRatio}%</div>
                    </div>
                `;
            });
            
            // Copy button handler
            copyMinifyBtn.addEventListener('click', () => {
                if (minifyOutput.value) {
                    minifyOutput.select();
                    document.execCommand('copy');
                    alert('Minified text copied to clipboard!');
                }
            });
            
            // Reset button handler
            resetMinifyBtn.addEventListener('click', () => {
                minifyInput.value = '';
                minifyLanguage.value = 'auto';
                removeComments.checked = true;
                removeWhitespace.checked = true;
                collapseWhitespace.checked = false;
                removeEmptyAttributes.checked = false;
                minifyOutput.value = '';
                minifyStats.style.display = 'none';
            });
        }

        // Text Beautifier Tool
        function setupTextBeautifierTool(modalOverlay) {
            const beautifyInput = modalOverlay.querySelector('#beautifyInput');
            const beautifyLanguage = modalOverlay.querySelector('#beautifyLanguage');
            const indentation = modalOverlay.querySelector('#indentation');
            const wrapAttributes = modalOverlay.querySelector('#wrapAttributes');
            const preserveNewlines = modalOverlay.querySelector('#preserveNewlines');
            const endWithNewline = modalOverlay.querySelector('#endWithNewline');
            const sortAttributes = modalOverlay.querySelector('#sortAttributes');
            const beautifyTextBtn = modalOverlay.querySelector('#beautifyTextBtn');
            const resetBeautifyBtn = modalOverlay.querySelector('#resetBeautifyBtn');
            const beautifyOutput = modalOverlay.querySelector('#beautifyOutput');
            const copyBeautifyBtn = modalOverlay.querySelector('#copyBeautifyBtn');
            
            // Beautify text button handler
            beautifyTextBtn.addEventListener('click', () => {
                const text = beautifyInput.value;
                const language = beautifyLanguage.value;
                
                if (!text.trim()) {
                    alert('Please enter some text to beautify.');
                    return;
                }
                
                let beautified = text;
                
                // Basic beautification (this is a simplified implementation)
                if (language === 'json') {
                    try {
                        const parsed = JSON.parse(text);
                        const indent = indentation.value === 'tab' ? '\t' : ' '.repeat(parseInt(indentation.value));
                        beautified = JSON.stringify(parsed, null, indent);
                    } catch (e) {
                        alert('Invalid JSON format. Please check your input.');
                        return;
                    }
                } else if (language === 'html' || language === 'xml') {
                    // Simple HTML beautification
                    beautified = text
                        .replace(/>\s+</g, '>\n<')
                        .replace(/(<\/?\w+)([^>]*?)(\/?>)/g, function(match, tagStart, attributes, tagEnd) {
                            // Simple attribute formatting
                            if (wrapAttributes.checked && attributes.trim()) {
                                attributes = ' ' + attributes.trim() + ' ';
                            }
                            return tagStart + attributes + tagEnd;
                        });
                    
                    // Add indentation
                    const indent = indentation.value === 'tab' ? '\t' : ' '.repeat(parseInt(indentation.value));
                    let level = 0;
                    beautified = beautified.split('\n').map(line => {
                        const trimmed = line.trim();
                        if (trimmed.startsWith('</')) {
                            level = Math.max(0, level - 1);
                        }
                        const indentedLine = indent.repeat(level) + trimmed;
                        if (trimmed.startsWith('<') && !trimmed.startsWith('</') && !trimmed.endsWith('/>')) {
                            level++;
                        }
                        return indentedLine;
                    }).join('\n');
                } else {
                    // General text beautification
                    if (preserveNewlines.checked) {
                        beautified = text.replace(/\n\s*\n/g, '\n\n');
                    }
                    
                    // Add final newline if requested
                    if (endWithNewline.checked && !beautified.endsWith('\n')) {
                        beautified += '\n';
                    }
                }
                
                beautifyOutput.value = beautified;
            });
            
            // Copy button handler
            copyBeautifyBtn.addEventListener('click', () => {
                if (beautifyOutput.value) {
                    beautifyOutput.select();
                    document.execCommand('copy');
                    alert('Beautified text copied to clipboard!');
                }
            });
            
            // Reset button handler
            resetBeautifyBtn.addEventListener('click', () => {
                beautifyInput.value = '';
                beautifyLanguage.value = 'auto';
                indentation.value = '4';
                wrapAttributes.checked = true;
                preserveNewlines.checked = false;
                endWithNewline.checked = true;
                sortAttributes.checked = false;
                beautifyOutput.value = '';
            });
        }

        // Password Generator Tool
        function setupPasswordGeneratorTool(modalOverlay) {
            const passwordLength = modalOverlay.querySelector('#passwordLength');
            const passwordLengthValue = modalOverlay.querySelector('#passwordLengthValue');
            const includeUppercase = modalOverlay.querySelector('#includeUppercase');
            const includeLowercase = modalOverlay.querySelector('#includeLowercase');
            const includeNumbers = modalOverlay.querySelector('#includeNumbers');
            const includeSymbols = modalOverlay.querySelector('#includeSymbols');
            const excludeSimilar = modalOverlay.querySelector('#excludeSimilar');
            const excludeAmbiguous = modalOverlay.querySelector('#excludeAmbiguous');
            const passwordStrengthBar = modalOverlay.querySelector('#passwordStrengthBar');
            const passwordStrengthText = modalOverlay.querySelector('#passwordStrengthText');
            const generatePasswordBtn = modalOverlay.querySelector('#generatePasswordBtn');
            const resetPasswordBtn = modalOverlay.querySelector('#resetPasswordBtn');
            const generatedPassword = modalOverlay.querySelector('#generatedPassword');
            const copyPasswordBtn = modalOverlay.querySelector('#copyPasswordBtn');
            const passwordCount = modalOverlay.querySelector('#passwordCount');
            const generateMultipleBtn = modalOverlay.querySelector('#generateMultipleBtn');
            const multiplePasswords = modalOverlay.querySelector('#multiplePasswords');
            const passwordList = modalOverlay.querySelector('#passwordList');
            
            // Character sets
            const uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const lowercase = 'abcdefghijklmnopqrstuvwxyz';
            const numbers = '0123456789';
            const symbols = '!@#$%^&*()_+-=[]{}|;:,.<>?';
            const similar = 'il1Lo0O';
            const ambiguous = '{}[]()/\\\'"`~,;:.<>';
            
            // Update password length value display
            passwordLength.addEventListener('input', () => {
                passwordLengthValue.textContent = `${passwordLength.value} characters`;
                updatePasswordStrength();
            });
            
            // Update password strength when options change
            [includeUppercase, includeLowercase, includeNumbers, includeSymbols].forEach(checkbox => {
                checkbox.addEventListener('change', updatePasswordStrength);
            });
            
            // Generate password button handler
            generatePasswordBtn.addEventListener('click', () => {
                const password = generatePassword();
                generatedPassword.value = password;
                updatePasswordStrength();
            });
            
            // Copy password button handler
            copyPasswordBtn.addEventListener('click', () => {
                if (generatedPassword.value) {
                    generatedPassword.select();
                    document.execCommand('copy');
                    alert('Password copied to clipboard!');
                }
            });
            
            // Generate multiple passwords button handler
            generateMultipleBtn.addEventListener('click', () => {
                const count = parseInt(passwordCount.value);
                if (isNaN(count) || count < 1 || count > 10) {
                    alert('Please enter a valid number of passwords (1-10).');
                    return;
                }
                
                const passwords = [];
                for (let i = 0; i < count; i++) {
                    passwords.push(generatePassword());
                }
                
                passwordList.innerHTML = passwords.map((password, index) => 
                    `<div style="margin-bottom: 5px;">
                        <span style="font-family: monospace;">${password}</span>
                        <button class="secondary-button" style="padding: 2px 5px; font-size: 0.8rem; margin-left: 10px;" onclick="copyToClipboard('${password}')">Copy</button>
                    </div>`
                ).join('');
                
                multiplePasswords.style.display = 'block';
            });
            
            // Reset button handler
            resetPasswordBtn.addEventListener('click', () => {
                passwordLength.value = 12;
                passwordLengthValue.textContent = '12 characters';
                includeUppercase.checked = true;
                includeLowercase.checked = true;
                includeNumbers.checked = true;
                includeSymbols.checked = false;
                excludeSimilar.checked = false;
                excludeAmbiguous.checked = false;
                generatedPassword.value = '';
                passwordCount.value = 1;
                multiplePasswords.style.display = 'none';
                updatePasswordStrength();
            });
            
            // Generate password function
            function generatePassword() {
                const length = parseInt(passwordLength.value);
                let charset = '';
                
                if (includeUppercase.checked) charset += uppercase;
                if (includeLowercase.checked) charset += lowercase;
                if (includeNumbers.checked) charset += numbers;
                if (includeSymbols.checked) charset += symbols;
                
                // Remove similar characters if requested
                if (excludeSimilar.checked) {
                    charset = charset.split('').filter(char => !similar.includes(char)).join('');
                }
                
                // Remove ambiguous characters if requested
                if (excludeAmbiguous.checked) {
                    charset = charset.split('').filter(char => !ambiguous.includes(char)).join('');
                }
                
                // Ensure at least one character set is selected
                if (charset.length === 0) {
                    alert('Please select at least one character type.');
                    return '';
                }
                
                // Generate password
                let password = '';
                for (let i = 0; i < length; i++) {
                    const randomIndex = Math.floor(Math.random() * charset.length);
                    password += charset[randomIndex];
                }
                
                return password;
            }
            
            // Update password strength display
            function updatePasswordStrength() {
                const length = parseInt(passwordLength.value);
                let strength = 0;
                
                // Length contributes to strength
                strength += Math.min(length / 8, 1) * 25;
                
                // Character variety contributes to strength
                let varietyScore = 0;
                if (includeUppercase.checked) varietyScore++;
                if (includeLowercase.checked) varietyScore++;
                if (includeNumbers.checked) varietyScore++;
                if (includeSymbols.checked) varietyScore++;
                
                strength += (varietyScore / 4) * 75;
                
                // Update strength bar and text
                passwordStrengthBar.style.width = `${strength}%`;
                
                if (strength < 40) {
                    passwordStrengthBar.style.backgroundColor = '#dc3545';
                    passwordStrengthText.textContent = 'Weak';
                } else if (strength < 70) {
                    passwordStrengthBar.style.backgroundColor = '#fd7e14';
                    passwordStrengthText.textContent = 'Medium';
                } else if (strength < 90) {
                    passwordStrengthBar.style.backgroundColor = '#ffc107';
                    passwordStrengthText.textContent = 'Strong';
                } else {
                    passwordStrengthBar.style.backgroundColor = '#28a745';
                    passwordStrengthText.textContent = 'Very Strong';
                }
            }
            
            // Copy to clipboard utility
            function copyToClipboard(text) {
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                alert('Password copied to clipboard!');
            }
            
            // Initialize password strength display
            updatePasswordStrength();
        }

        // QR Code Generator Tool
        function setupQrGeneratorTool(modalOverlay) {
            const qrContent = modalOverlay.querySelector('#qrContent');
            const qrType = modalOverlay.querySelector('#qrType');
            const qrSize = modalOverlay.querySelector('#qrSize');
            const qrSizeValue = modalOverlay.querySelector('#qrSizeValue');
            const qrColor = modalOverlay.querySelector('#qrColor');
            const qrBgColor = modalOverlay.querySelector('#qrBgColor');
            const qrErrorCorrection = modalOverlay.querySelector('#qrErrorCorrection');
            const generateQrBtn = modalOverlay.querySelector('#generateQrBtn');
            const resetQrBtn = modalOverlay.querySelector('#resetQrBtn');
            const qrOutput = modalOverlay.querySelector('#qrOutput');
            const qrCodeContainer = modalOverlay.querySelector('#qrCodeContainer');
            const downloadQrBtn = modalOverlay.querySelector('#downloadQrBtn');
            
            // Update QR size value display
            qrSize.addEventListener('input', () => {
                qrSizeValue.textContent = `${qrSize.value}px`;
            });
            
            // Generate QR code button handler
            generateQrBtn.addEventListener('click', () => {
                const content = qrContent.value.trim();
                if (!content) {
                    alert('Please enter content for the QR code.');
                    return;
                }
                
                // Format content based on type
                let formattedContent = content;
                switch (qrType.value) {
                    case 'url':
                        if (!content.startsWith('http://') && !content.startsWith('https://')) {
                            formattedContent = 'https://' + content;
                        }
                        break;
                    case 'email':
                        formattedContent = `mailto:${content}`;
                        break;
                    case 'phone':
                        formattedContent = `tel:${content}`;
                        break;
                    case 'sms':
                        formattedContent = `sms:${content}`;
                        break;
                    case 'wifi':
                        formattedContent = `WIFI:S:${content};T:WPA;P:password;;`;
                        break;
                    // For other types, use the content as is
                }
                
                // Generate QR code
                const typeNumber = 0; // Auto detect
                const errorCorrectionLevel = qrErrorCorrection.value;
                const qr = qrcode(typeNumber, errorCorrectionLevel);
                qr.addData(formattedContent);
                qr.make();
                
                // Create QR code image
                const size = parseInt(qrSize.value);
                const cellSize = Math.floor(size / qr.getModuleCount());
                const margin = 4;
                const actualSize = qr.getModuleCount() * cellSize + margin * 2;
                
                const canvas = document.createElement('canvas');
                canvas.width = actualSize;
                canvas.height = actualSize;
                const ctx = canvas.getContext('2d');
                
                // Set background
                ctx.fillStyle = qrBgColor.value;
                ctx.fillRect(0, 0, actualSize, actualSize);
                
                // Draw QR code
                ctx.fillStyle = qrColor.value;
                for (let row = 0; row < qr.getModuleCount(); row++) {
                    for (let col = 0; col < qr.getModuleCount(); col++) {
                        if (qr.isDark(row, col)) {
                            ctx.fillRect(
                                col * cellSize + margin,
                                row * cellSize + margin,
                                cellSize,
                                cellSize
                            );
                        }
                    }
                }
                
                // Display QR code
                qrCodeContainer.innerHTML = '';
                qrCodeContainer.appendChild(canvas);
                qrOutput.style.display = 'block';
                
                // Set up download button
                downloadQrBtn.onclick = () => {
                    const link = document.createElement('a');
                    link.download = 'qrcode.png';
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                };
            });
            
            // Reset button handler
            resetQrBtn.addEventListener('click', () => {
                qrContent.value = '';
                qrType.value = 'url';
                qrSize.value = '200';
                qrSizeValue.textContent = '200px';
                qrColor.value = '#000000';
                qrBgColor.value = '#ffffff';
                qrErrorCorrection.value = 'M';
                qrOutput.style.display = 'none';
            });
        }

        // JSON Formatter Tool
        function setupJsonFormatterTool(modalOverlay) {
            const jsonInput = modalOverlay.querySelector('#jsonInput');
            const jsonIndentation = modalOverlay.querySelector('#jsonIndentation');
            const formatJsonBtn = modalOverlay.querySelector('#formatJsonBtn');
            const minifyJsonBtn = modalOverlay.querySelector('#minifyJsonBtn');
            const validateJsonBtn = modalOverlay.querySelector('#validateJsonBtn');
            const resetJsonBtn = modalOverlay.querySelector('#resetJsonBtn');
            const jsonOutput = modalOverlay.querySelector('#jsonOutput');
            const jsonValidation = modalOverlay.querySelector('#jsonValidation');
            const jsonValidationResult = modalOverlay.querySelector('#jsonValidationResult');
            const copyJsonBtn = modalOverlay.querySelector('#copyJsonBtn');
            
            // Format JSON button handler
            formatJsonBtn.addEventListener('click', () => {
                const input = jsonInput.value.trim();
                if (!input) {
                    alert('Please enter JSON to format.');
                    return;
                }
                
                try {
                    const parsed = JSON.parse(input);
                    const indent = jsonIndentation.value === 'tab' ? '\t' : ' '.repeat(parseInt(jsonIndentation.value));
                    const formatted = JSON.stringify(parsed, null, indent);
                    jsonOutput.value = formatted;
                    jsonValidation.style.display = 'none';
                } catch (e) {
                    alert('Invalid JSON format. Please check your input.');
                }
            });
            
            // Minify JSON button handler
            minifyJsonBtn.addEventListener('click', () => {
                const input = jsonInput.value.trim();
                if (!input) {
                    alert('Please enter JSON to minify.');
                    return;
                }
                
                try {
                    const parsed = JSON.parse(input);
                    const minified = JSON.stringify(parsed);
                    jsonOutput.value = minified;
                    jsonValidation.style.display = 'none';
                } catch (e) {
                    alert('Invalid JSON format. Please check your input.');
                }
            });
            
            // Validate JSON button handler
            validateJsonBtn.addEventListener('click', () => {
                const input = jsonInput.value.trim();
                if (!input) {
                    alert('Please enter JSON to validate.');
                    return;
                }
                
                try {
                    JSON.parse(input);
                    jsonValidationResult.innerHTML = '<div style="color: #28a745;">‚úì Valid JSON</div>';
                    jsonValidation.style.display = 'block';
                } catch (e) {
                    jsonValidationResult.innerHTML = `<div style="color: #dc3545;">‚úó Invalid JSON: ${e.message}</div>`;
                    jsonValidation.style.display = 'block';
                }
            });
            
            // Copy button handler
            copyJsonBtn.addEventListener('click', () => {
                if (jsonOutput.value) {
                    jsonOutput.select();
                    document.execCommand('copy');
                    alert('JSON copied to clipboard!');
                }
            });
            
            // Reset button handler
            resetJsonBtn.addEventListener('click', () => {
                jsonInput.value = '';
                jsonIndentation.value = '4';
                jsonOutput.value = '';
                jsonValidation.style.display = 'none';
            });
        }

        // Base64 Converter Tool
        function setupBase64ConverterTool(modalOverlay) {
            const base64Direction = modalOverlay.querySelector('#base64Direction');
            const base64Input = modalOverlay.querySelector('#base64Input');
            const base64InputType = modalOverlay.querySelector('#base64InputType');
            const base64FileUpload = modalOverlay.querySelector('#base64FileUpload');
            const base64FileUploadArea = modalOverlay.querySelector('#base64FileUploadArea');
            const base64File = modalOverlay.querySelector('#base64File');
            const convertBase64Btn = modalOverlay.querySelector('#convertBase64Btn');
            const resetBase64Btn = modalOverlay.querySelector('#resetBase64Btn');
            const base64Output = modalOverlay.querySelector('#base64Output');
            const copyBase64Btn = modalOverlay.querySelector('#copyBase64Btn');
            
            // Input type change handler
            base64InputType.addEventListener('change', () => {
                if (base64InputType.value === 'file') {
                    base64FileUpload.style.display = 'block';
                    base64Input.style.display = 'none';
                } else {
                    base64FileUpload.style.display = 'none';
                    base64Input.style.display = 'block';
                }
            });
            
            // File upload area click handler
            base64FileUploadArea.addEventListener('click', () => {
                base64File.click();
            });
            
            // File input change handler
            base64File.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    
                    if (base64Direction.value === 'encode') {
                        reader.onload = function(event) {
                            // Convert file to base64
                            const base64 = event.target.result.split(',')[1];
                            base64Output.value = base64;
                        };
                        reader.readAsDataURL(file);
                    } else {
                        // For decoding, we'll read the file as text
                        reader.onload = function(event) {
                            base64Input.value = event.target.result;
                            convertBase64();
                        };
                        reader.readAsText(file);
                    }
                }
            });
            
            // Convert button handler
            convertBase64Btn.addEventListener('click', () => {
                convertBase64();
            });
            
            // Reset button handler
            resetBase64Btn.addEventListener('click', () => {
                base64Direction.value = 'encode';
                base64InputType.value = 'text';
                base64FileUpload.style.display = 'none';
                base64Input.style.display = 'block';
                base64Input.value = '';
                base64File.value = '';
                base64Output.value = '';
            });
            
            // Copy button handler
            copyBase64Btn.addEventListener('click', () => {
                if (base64Output.value) {
                    base64Output.select();
                    document.execCommand('copy');
                    alert('Result copied to clipboard!');
                }
            });
            
            // Base64 conversion function
            function convertBase64() {
                if (base64Direction.value === 'encode') {
                    // Encode to base64
                    if (base64InputType.value === 'text') {
                        const text = base64Input.value;
                        if (!text.trim()) {
                            alert('Please enter text to encode.');
                            return;
                        }
                        base64Output.value = btoa(unescape(encodeURIComponent(text)));
                    }
                } else {
                    // Decode from base64
                    if (base64InputType.value === 'text') {
                        const base64 = base64Input.value;
                        if (!base64.trim()) {
                            alert('Please enter base64 to decode.');
                            return;
                        }
                        try {
                            base64Output.value = decodeURIComponent(escape(atob(base64)));
                        } catch (e) {
                            alert('Invalid base64 string. Please check your input.');
                        }
                    }
                }
            }
        }

        // CSV/JSON Converter Tool
        function setupCsvJsonConverterTool(modalOverlay) {
            const conversionDirection = modalOverlay.querySelector('#conversionDirection');
            const conversionInput = modalOverlay.querySelector('#conversionInput');
            const csvOptions = modalOverlay.querySelector('#csvOptions');
            const jsonOptions = modalOverlay.querySelector('#jsonOptions');
            const csvHeader = modalOverlay.querySelector('#csvHeader');
            const csvQuotes = modalOverlay.querySelector('#csvQuotes');
            const csvDelimiter = modalOverlay.querySelector('#csvDelimiter');
            const customDelimiterContainer = modalOverlay.querySelector('#customDelimiterContainer');
            const customDelimiter = modalOverlay.querySelector('#customDelimiter');
            const jsonMinify = modalOverlay.querySelector('#jsonMinify');
            const jsonHeader = modalOverlay.querySelector('#jsonHeader');
            const convertDataBtn = modalOverlay.querySelector('#convertDataBtn');
            const resetConversionBtn = modalOverlay.querySelector('#resetConversionBtn');
            const conversionOutput = modalOverlay.querySelector('#conversionOutput');
            const copyConversionBtn = modalOverlay.querySelector('#copyConversionBtn');
            
            // Conversion direction change handler
            conversionDirection.addEventListener('change', () => {
                if (conversionDirection.value === 'csvToJson') {
                    csvOptions.style.display = 'block';
                    jsonOptions.style.display = 'none';
                } else {
                    csvOptions.style.display = 'none';
                    jsonOptions.style.display = 'block';
                }
            });
            
            // CSV delimiter change handler
            csvDelimiter.addEventListener('change', () => {
                if (csvDelimiter.value === 'custom') {
                    customDelimiterContainer.style.display = 'block';
                } else {
                    customDelimiterContainer.style.display = 'none';
                }
            });
            
            // Convert data button handler
            convertDataBtn.addEventListener('click', () => {
                const input = conversionInput.value.trim();
                if (!input) {
                    alert('Please enter data to convert.');
                    return;
                }
                
                try {
                    if (conversionDirection.value === 'csvToJson') {
                        // CSV to JSON conversion
                        const delimiter = getDelimiter();
                        const lines = input.split('\n');
                        const result = [];
                        
                        // Get headers
                        const headers = csvHeader.checked ? 
                            lines[0].split(delimiter).map(h => h.trim().replace(/^"|"$/g, '')) : 
                            Array.from({ length: lines[0].split(delimiter).length }, (_, i) => `field${i+1}`);
                        
                        // Start from first data row
                        const startRow = csvHeader.checked ? 1 : 0;
                        
                        for (let i = startRow; i < lines.length; i++) {
                            if (lines[i].trim() === '') continue;
                            
                            const obj = {};
                            const values = parseCsvLine(lines[i], delimiter);
                            
                            for (let j = 0; j < headers.length; j++) {
                                obj[headers[j]] = j < values.length ? values[j] : '';
                            }
                            
                            result.push(obj);
                        }
                        
                        // Format JSON output
                        const indent = jsonMinify.checked ? null : 2;
                        conversionOutput.value = JSON.stringify(result, null, indent);
                    } else {
                        // JSON to CSV conversion
                        const data = JSON.parse(input);
                        if (!Array.isArray(data)) {
                            throw new Error('JSON must be an array of objects');
                        }
                        
                        // Get all unique keys (headers)
                        const headers = [...new Set(data.flatMap(obj => Object.keys(obj)))];
                        
                        let csv = '';
                        
                        // Add header row if requested
                        if (jsonHeader.checked) {
                            const delimiter = getDelimiter();
                            const headerRow = headers.map(h => 
                                csvQuotes.checked ? `"${h}"` : h
                            ).join(delimiter);
                            csv += headerRow + '\n';
                        }
                        
                        // Add data rows
                        const delimiter = getDelimiter();
                        data.forEach(obj => {
                            const row = headers.map(header => {
                                const value = obj[header] !== undefined ? String(obj[header]) : '';
                                return csvQuotes.checked ? `"${value}"` : value;
                            }).join(delimiter);
                            csv += row + '\n';
                        });
                        
                        conversionOutput.value = csv;
                    }
                } catch (e) {
                    alert(`Conversion error: ${e.message}`);
                }
            });
            
            // Reset button handler
            resetConversionBtn.addEventListener('click', () => {
                conversionDirection.value = 'csvToJson';
                conversionInput.value = '';
                csvOptions.style.display = 'block';
                jsonOptions.style.display = 'none';
                csvHeader.checked = true;
                csvQuotes.checked = false;
                csvDelimiter.value = ',';
                customDelimiterContainer.style.display = 'none';
                customDelimiter.value = '';
                jsonMinify.checked = false;
                jsonHeader.checked = true;
                conversionOutput.value = '';
            });
            
            // Copy button handler
            copyConversionBtn.addEventListener('click', () => {
                if (conversionOutput.value) {
                    conversionOutput.select();
                    document.execCommand('copy');
                    alert('Converted data copied to clipboard!');
                }
            });
            
            // Get the delimiter character
            function getDelimiter() {
                if (csvDelimiter.value === 'custom') {
                    return customDelimiter.value || ',';
                }
                return {
                    ',': ',',
                    ';': ';',
                    '\t': '\t',
                    '|': '|'
                }[csvDelimiter.value] || ',';
            }
            
            // Parse a CSV line considering quoted values
            function parseCsvLine(line, delimiter) {
                const result = [];
                let current = '';
                let inQuotes = false;
                
                for (let i = 0; i < line.length; i++) {
                    const char = line[i];
                    
                    if (char === '"') {
                        inQuotes = !inQuotes;
                    } else if (char === delimiter && !inQuotes) {
                        result.push(current.trim().replace(/^"|"$/g, ''));
                        current = '';
                    } else {
                        current += char;
                    }
                }
                
                result.push(current.trim().replace(/^"|"$/g, ''));
                return result;
            }
        }

        // Regex Tester Tool
        function setupRegexTesterTool(modalOverlay) {
            const regexPattern = modalOverlay.querySelector('#regexPattern');
            const testString = modalOverlay.querySelector('#testString');
            const globalFlag = modalOverlay.querySelector('#globalFlag');
            const ignoreCaseFlag = modalOverlay.querySelector('#ignoreCaseFlag');
            const multilineFlag = modalOverlay.querySelector('#multilineFlag');
            const dotAllFlag = modalOverlay.querySelector('#dotAllFlag');
            const unicodeFlag = modalOverlay.querySelector('#unicodeFlag');
            const stickyFlag = modalOverlay.querySelector('#stickyFlag');
            const testRegexBtn = modalOverlay.querySelector('#testRegexBtn');
            const resetRegexBtn = modalOverlay.querySelector('#resetRegexBtn');
            const regexDetails = modalOverlay.querySelector('#regexDetails');
            
            // Test regex button handler
            testRegexBtn.addEventListener('click', () => {
                const pattern = regexPattern.value;
                const string = testString.value;
                
                if (!pattern) {
                    alert('Please enter a regular expression.');
                    return;
                }
                
                if (!string) {
                    alert('Please enter a test string.');
                    return;
                }
                
                try {
                    // Build flags string
                    let flags = '';
                    if (globalFlag.checked) flags += 'g';
                    if (ignoreCaseFlag.checked) flags += 'i';
                    if (multilineFlag.checked) flags += 'm';
                    if (dotAllFlag.checked) flags += 's';
                    if (unicodeFlag.checked) flags += 'u';
                    if (stickyFlag.checked) flags += 'y';
                    
                    // Create regex
                    const regex = new RegExp(pattern, flags);
                    
                    // Test regex
                    const isMatch = regex.test(string);
                    
                    // Find all matches
                    const matches = [];
                    let match;
                    
                    // Reset regex lastIndex for global search
                    regex.lastIndex = 0;
                    
                    while ((match = regex.exec(string)) !== null) {
                        matches.push({
                            match: match[0],
                            index: match.index,
                            groups: match.slice(1)
                        });
                        
                        // Break if not global to avoid infinite loop
                        if (!regex.global) break;
                    }
                    
                    // Display results
                    let resultHtml = `
                        <div style="margin-bottom: 10px;">
                            <strong>Pattern:</strong> /${pattern}/${flags}
                        </div>
                        <div style="margin-bottom: 10px;">
                            <strong>Overall Match:</strong> ${isMatch ? '‚úì Yes' : '‚úó No'}
                        </div>
                    `;
                    
                    if (matches.length > 0) {
                        resultHtml += `
                            <div style="margin-bottom: 10px;">
                                <strong>Matches Found:</strong> ${matches.length}
                            </div>
                            <div>
                                <strong>Match Details:</strong>
                                <ul style="margin-top: 5px; padding-left: 20px;">
                        `;
                        
                        matches.forEach((m, index) => {
                            resultHtml += `
                                <li style="margin-bottom: 5px;">
                                    <strong>Match ${index + 1}:</strong> "${m.match}" at position ${m.index}
                                    ${m.groups.length > 0 ? `<br>Groups: ${m.groups.map((g, i) => `$${i+1}: "${g}"`).join(', ')}` : ''}
                                </li>
                            `;
                        });
                        
                        resultHtml += `</ul></div>`;
                    } else {
                        resultHtml += `<div><strong>No individual matches found.</strong></div>`;
                    }
                    
                    regexDetails.innerHTML = resultHtml;
                } catch (e) {
                    regexDetails.innerHTML = `<div style="color: #dc3545;">Invalid regular expression: ${e.message}</div>`;
                }
            });
            
            // Reset button handler
            resetRegexBtn.addEventListener('click', () => {
                regexPattern.value = '';
                testString.value = '';
                globalFlag.checked = false;
                ignoreCaseFlag.checked = false;
                multilineFlag.checked = false;
                dotAllFlag.checked = false;
                unicodeFlag.checked = false;
                stickyFlag.checked = false;
                regexDetails.innerHTML = 'Test results will appear here';
            });
        }

        // Hash Generator Tool
        function setupHashGeneratorTool(modalOverlay) {
            const hashInput = modalOverlay.querySelector('#hashInput');
            const hashInputType = modalOverlay.querySelector('#hashInputType');
            const hashFileUpload = modalOverlay.querySelector('#hashFileUpload');
            const hashFileUploadArea = modalOverlay.querySelector('#hashFileUploadArea');
            const hashFile = modalOverlay.querySelector('#hashFile');
            const hashAlgorithm = modalOverlay.querySelector('#hashAlgorithm');
            const generateHashBtn = modalOverlay.querySelector('#generateHashBtn');
            const resetHashBtn = modalOverlay.querySelector('#resetHashBtn');
            const hashOutput = modalOverlay.querySelector('#hashOutput');
            const copyHashBtn = modalOverlay.querySelector('#copyHashBtn');
            
            // Input type change handler
            hashInputType.addEventListener('change', () => {
                if (hashInputType.value === 'file') {
                    hashFileUpload.style.display = 'block';
                    hashInput.style.display = 'none';
                } else {
                    hashFileUpload.style.display = 'none';
                    hashInput.style.display = 'block';
                }
            });
            
            // File upload area click handler
            hashFileUploadArea.addEventListener('click', () => {
                hashFile.click();
            });
            
            // File input change handler
            hashFile.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    
                    reader.onload = function(event) {
                        // For files, we'll process them directly in generateHash
                        // We don't set the input value for files
                    };
                    
                    // We don't actually need to read the file here
                    // The file will be processed when generating the hash
                }
            });
            
            // Generate hash button handler
            generateHashBtn.addEventListener('click', () => {
                if (hashInputType.value === 'text') {
                    const text = hashInput.value;
                    if (!text.trim()) {
                        alert('Please enter text to hash.');
                        return;
                    }
                    
                    // Generate hash from text
                    generateTextHash(text);
                } else {
                    // Generate hash from file
                    if (!hashFile.files.length) {
                        alert('Please select a file to hash.');
                        return;
                    }
                    
                    generateFileHash(hashFile.files[0]);
                }
            });
            
            // Reset button handler
            resetHashBtn.addEventListener('click', () => {
                hashInput.value = '';
                hashInputType.value = 'text';
                hashFileUpload.style.display = 'none';
                hashInput.style.display = 'block';
                hashFile.value = '';
                hashAlgorithm.value = 'MD5';
                hashOutput.value = '';
            });
            
            // Copy button handler
            copyHashBtn.addEventListener('click', () => {
                if (hashOutput.value) {
                    hashOutput.select();
                    document.execCommand('copy');
                    alert('Hash copied to clipboard!');
                }
            });
            
            // Generate hash from text
            function generateTextHash(text) {
                // This is a simplified implementation
                // In a real application, you would use a proper cryptographic library
                
                const algorithm = hashAlgorithm.value;
                let hash;
                
                // Simple hash simulation (not cryptographically secure)
                switch (algorithm) {
                    case 'MD5':
                        hash = simpleMD5(text);
                        break;
                    case 'SHA-1':
                        hash = simpleSHA1(text);
                        break;
                    default:
                        // For other algorithms, use a simple simulation
                        hash = simpleHash(text, algorithm);
                        break;
                }
                
                hashOutput.value = hash;
            }
            
            // Generate hash from file
            function generateFileHash(file) {
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    const content = event.target.result;
                    generateTextHash(content);
                };
                
                reader.readAsText(file);
            }
            
            // Simple hash functions (for demonstration only)
            function simpleMD5(text) {
                // This is not a real MD5 implementation
                let hash = 0;
                for (let i = 0; i < text.length; i++) {
                    const char = text.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash; // Convert to 32-bit integer
                }
                return Math.abs(hash).toString(16);
            }
            
            function simpleSHA1(text) {
                // This is not a real SHA-1 implementation
                let hash = 0;
                for (let i = 0; i < text.length; i++) {
                    const char = text.charCodeAt(i);
                    hash = ((hash << 7) - hash) + char;
                    hash = hash & hash; // Convert to 32-bit integer
                }
                return Math.abs(hash).toString(16);
            }
            
            function simpleHash(text, algorithm) {
                // Simple hash for demonstration
                let hash = 0;
                for (let i = 0; i < text.length; i++) {
                    const char = text.charCodeAt(i);
                    hash = ((hash << 9) - hash) + char;
                    hash = hash & hash; // Convert to 32-bit integer
                }
                return Math.abs(hash).toString(16);
            }
        }

        // Timer/Stopwatch Tool
        function setupTimerStopwatchTool(modalOverlay) {
            const timerMode = modalOverlay.querySelector('#timerMode');
            const timerOptions = modalOverlay.querySelector('#timerOptions');
            const timerHours = modalOverlay.querySelector('#timerHours');
            const timerMinutes = modalOverlay.querySelector('#timerMinutes');
            const timerSeconds = modalOverlay.querySelector('#timerSeconds');
            const timeDisplay = modalOverlay.querySelector('#timeDisplay');
            const startTimerBtn = modalOverlay.querySelector('#startTimerBtn');
            const pauseTimerBtn = modalOverlay.querySelector('#pauseTimerBtn');
            const resetTimerBtn = modalOverlay.querySelector('#resetTimerBtn');
            const lapTimerBtn = modalOverlay.querySelector('#lapTimerBtn');
            const lapTimes = modalOverlay.querySelector('#lapTimes');
            
            let timerInterval = null;
            let isRunning = false;
            let startTime = 0;
            let elapsedTime = 0;
            let lapCount = 0;
            
            // Timer mode change handler
            timerMode.addEventListener('change', () => {
                if (timerMode.value === 'timer') {
                    timerOptions.style.display = 'block';
                    resetTimer();
                } else {
                    timerOptions.style.display = 'none';
                    resetTimer();
                }
            });
            
            // Start button handler
            startTimerBtn.addEventListener('click', () => {
                if (isRunning) return;
                
                if (timerMode.value === 'timer') {
                    // Timer mode
                    const hours = parseInt(timerHours.value) || 0;
                    const minutes = parseInt(timerMinutes.value) || 0;
                    const seconds = parseInt(timerSeconds.value) || 0;
                    
                    if (hours === 0 && minutes === 0 && seconds === 0) {
                        alert('Please set a timer duration.');
                        return;
                    }
                    
                    elapsedTime = (hours * 3600 + minutes * 60 + seconds) * 1000;
                } else {
                    // Stopwatch mode
                    startTime = Date.now() - elapsedTime;
                }
                
                isRunning = true;
                startTimerBtn.disabled = true;
                pauseTimerBtn.disabled = false;
                
                timerInterval = setInterval(updateTime, 100);
            });
            
            // Pause button handler
            pauseTimerBtn.addEventListener('click', () => {
                if (!isRunning) return;
                
                isRunning = false;
                startTimerBtn.disabled = false;
                pauseTimerBtn.disabled = true;
                
                clearInterval(timerInterval);
                
                if (timerMode.value === 'stopwatch') {
                    elapsedTime = Date.now() - startTime;
                }
            });
            
            // Reset button handler
            resetTimerBtn.addEventListener('click', () => {
                resetTimer();
            });
            
            // Lap button handler
            lapTimerBtn.addEventListener('click', () => {
                if (!isRunning || timerMode.value !== 'stopwatch') return;
                
                lapCount++;
                const lapTime = formatTime(Date.now() - startTime);
                
                const lapElement = document.createElement('div');
                lapElement.textContent = `Lap ${lapCount}: ${lapTime}`;
                lapTimes.appendChild(lapElement);
            });
            
            // Update time display
            function updateTime() {
                if (timerMode.value === 'timer') {
                    // Timer countdown
                    elapsedTime -= 100;
                    
                    if (elapsedTime <= 0) {
                        elapsedTime = 0;
                        clearInterval(timerInterval);
                        isRunning = false;
                        startTimerBtn.disabled = false;
                        pauseTimerBtn.disabled = true;
                        
                        // Timer finished
                        alert('Timer finished!');
                    }
                    
                    timeDisplay.textContent = formatTime(elapsedTime);
                } else {
                    // Stopwatch countup
                    const currentTime = Date.now() - startTime;
                    timeDisplay.textContent = formatTime(currentTime);
                }
            }
            
            // Reset timer function
            function resetTimer() {
                clearInterval(timerInterval);
                isRunning = false;
                startTimerBtn.disabled = false;
                pauseTimerBtn.disabled = true;
                
                if (timerMode.value === 'timer') {
                    const hours = parseInt(timerHours.value) || 0;
                    const minutes = parseInt(timerMinutes.value) || 0;
                    const seconds = parseInt(timerSeconds.value) || 0;
                    
                    elapsedTime = (hours * 3600 + minutes * 60 + seconds) * 1000;
                    timeDisplay.textContent = formatTime(elapsedTime);
                } else {
                    elapsedTime = 0;
                    timeDisplay.textContent = '00:00:00';
                }
                
                lapCount = 0;
                lapTimes.innerHTML = '';
            }
            
            // Format time function
            function formatTime(milliseconds) {
                const totalSeconds = Math.floor(milliseconds / 1000);
                const hours = Math.floor(totalSeconds / 3600);
                const minutes = Math.floor((totalSeconds % 3600) / 60);
                const seconds = totalSeconds % 60;
                
                return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            // Initialize display
            resetTimer();
        }

        // Unit Converter Tool
        function setupUnitConverterTool(modalOverlay) {
            const unitCategory = modalOverlay.querySelector('#unitCategory');
            const unitValue = modalOverlay.querySelector('#unitValue');
            const fromUnit = modalOverlay.querySelector('#fromUnit');
            const toUnit = modalOverlay.querySelector('#toUnit');
            const decimalPlaces = modalOverlay.querySelector('#decimalPlaces');
            const convertUnitBtn = modalOverlay.querySelector('#convertUnitBtn');
            const resetUnitBtn = modalOverlay.querySelector('#resetUnitBtn');
            const unitDetails = modalOverlay.querySelector('#unitDetails');
            
            // Unit conversion data
            const units = {
                length: {
                    meter: 1,
                    kilometer: 1000,
                    centimeter: 0.01,
                    millimeter: 0.001,
                    mile: 1609.34,
                    yard: 0.9144,
                    foot: 0.3048,
                    inch: 0.0254
                },
                weight: {
                    kilogram: 1,
                    gram: 0.001,
                    milligram: 0.000001,
                    pound: 0.453592,
                    ounce: 0.0283495,
                    ton: 1000
                },
                temperature: {
                    celsius: 'celsius',
                    fahrenheit: 'fahrenheit',
                    kelvin: 'kelvin'
                },
                area: {
                    'square meter': 1,
                    'square kilometer': 1000000,
                    'square mile': 2589988.11,
                    'square yard': 0.836127,
                    'square foot': 0.092903,
                    'square inch': 0.00064516,
                    hectare: 10000,
                    acre: 4046.86
                },
                volume: {
                    liter: 1,
                    'cubic meter': 1000,
                    'cubic centimeter': 0.001,
                    gallon: 3.78541,
                    quart: 0.946353,
                    pint: 0.473176,
                    'fluid ounce': 0.0295735
                },
                speed: {
                    'meter/second': 1,
                    'kilometer/hour': 0.277778,
                    'mile/hour': 0.44704,
                    knot: 0.514444,
                    'foot/second': 0.3048
                },
                time: {
                    second: 1,
                    minute: 60,
                    hour: 3600,
                    day: 86400,
                    week: 604800,
                    month: 2592000, // 30 days
                    year: 31536000 // 365 days
                },
                digital: {
                    bit: 1,
                    byte: 8,
                    kilobyte: 8192,
                    megabyte: 8388608,
                    gigabyte: 8589934592,
                    terabyte: 8796093022208
                },
                energy: {
                    joule: 1,
                    'kilojoule': 1000,
                    calorie: 4.184,
                    'kilocalorie': 4184,
                    'watt hour': 3600,
                    'kilowatt hour': 3600000
                },
                pressure: {
                    pascal: 1,
                    kilopascal: 1000,
                    bar: 100000,
                    psi: 6894.76,
                    atm: 101325
                }
            };
            
            // Category change handler
            unitCategory.addEventListener('change', () => {
                updateUnitOptions();
            });
            
            // Convert unit button handler
            convertUnitBtn.addEventListener('click', () => {
                const value = parseFloat(unitValue.value);
                const from = fromUnit.value;
                const to = toUnit.value;
                const category = unitCategory.value;
                const decimals = parseInt(decimalPlaces.value);
                
                if (isNaN(value)) {
                    alert('Please enter a valid number to convert.');
                    return;
                }
                
                if (from === to) {
                    alert('Please select different units to convert between.');
                    return;
                }
                
                let result;
                
                if (category === 'temperature') {
                    // Temperature conversion requires special handling
                    result = convertTemperature(value, from, to);
                } else {
                    // Standard conversion
                    const fromFactor = units[category][from];
                    const toFactor = units[category][to];
                    result = value * fromFactor / toFactor;
                }
                
                // Format result with specified decimal places
                const formattedResult = result.toFixed(decimals);
                
                // Display result
                unitDetails.innerHTML = `
                    <div style="text-align: center; font-size: 1.2rem; margin-bottom: 10px;">
                        ${value} ${from} = ${formattedResult} ${to}
                    </div>
                `;
            });
            
            // Reset button handler
            resetUnitBtn.addEventListener('click', () => {
                unitCategory.value = 'length';
                unitValue.value = '';
                decimalPlaces.value = '2';
                unitDetails.innerHTML = 'Enter values to convert';
                updateUnitOptions();
            });
            
            // Update unit options based on category
            function updateUnitOptions() {
                const category = unitCategory.value;
                const unitList = Object.keys(units[category]);
                
                // Clear existing options
                fromUnit.innerHTML = '';
                toUnit.innerHTML = '';
                
                // Add new options
                unitList.forEach(unit => {
                    const fromOption = document.createElement('option');
                    fromOption.value = unit;
                    fromOption.textContent = unit;
                    fromUnit.appendChild(fromOption);
                    
                    const toOption = document.createElement('option');
                    toOption.value = unit;
                    toOption.textContent = unit;
                    toUnit.appendChild(toOption);
                });
                
                // Set default selections
                if (category === 'length') {
                    fromUnit.value = 'meter';
                    toUnit.value = 'foot';
                } else if (category === 'weight') {
                    fromUnit.value = 'kilogram';
                    toUnit.value = 'pound';
                } else if (category === 'temperature') {
                    fromUnit.value = 'celsius';
                    toUnit.value = 'fahrenheit';
                } else {
                    fromUnit.value = unitList[0];
                    toUnit.value = unitList[1] || unitList[0];
                }
            }
            
            // Temperature conversion function
            function convertTemperature(value, from, to) {
                if (from === to) return value;
                
                // Convert to Celsius first
                let celsius;
                if (from === 'celsius') {
                    celsius = value;
                } else if (from === 'fahrenheit') {
                    celsius = (value - 32) * 5/9;
                } else if (from === 'kelvin') {
                    celsius = value - 273.15;
                }
                
                // Convert from Celsius to target
                if (to === 'celsius') {
                    return celsius;
                } else if (to === 'fahrenheit') {
                    return celsius * 9/5 + 32;
                } else if (to === 'kelvin') {
                    return celsius + 273.15;
                }
                
                return value;
            }
            
            // Initialize unit options
            updateUnitOptions();
        }

        // Document Scanner Tool
        function setupDocumentScannerTool(modalOverlay) {
            const documentFileInput = modalOverlay.querySelector('#documentFile');
            const documentUploadArea = modalOverlay.querySelector('#documentUploadArea');
            const documentCanvas = modalOverlay.querySelector('#documentCanvas');
            const grayscaleFilter = modalOverlay.querySelector('#grayscaleFilter');
            const contrastFilter = modalOverlay.querySelector('#contrastFilter');
            const brightnessFilter = modalOverlay.querySelector('#brightnessFilter');
            const sharpenFilter = modalOverlay.querySelector('#sharpenFilter');
            const blurFilter = modalOverlay.querySelector('#blurFilter');
            const invertFilter = modalOverlay.querySelector('#invertFilter');
            const sepiaFilter = modalOverlay.querySelector('#sepiaFilter');
            const noiseFilter = modalOverlay.querySelector('#noiseFilter');
            const brightnessValue = modalOverlay.querySelector('#brightnessValue');
            const brightnessValueDisplay = modalOverlay.querySelector('#brightnessValueDisplay');
            const contrastValue = modalOverlay.querySelector('#contrastValue');
            const contrastValueDisplay = modalOverlay.querySelector('#contrastValueDisplay');
            const sharpnessValue = modalOverlay.querySelector('#sharpnessValue');
            const sharpnessValueDisplay = modalOverlay.querySelector('#sharpnessValueDisplay');
            const applyFiltersBtn = modalOverlay.querySelector('#applyFiltersBtn');
            const resetDocumentBtn = modalOverlay.querySelector('#resetDocumentBtn');
            const downloadDocumentBtn = modalOverlay.querySelector('#downloadDocumentBtn');
            
            let ctx = documentCanvas.getContext('2d');
            let originalImage = null;
            let originalImageData = null;
            
            // File upload area click handler
            documentUploadArea.addEventListener('click', () => {
                documentFileInput.click();
            });
            
            // File input change handler
            documentFileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    
                    reader.onload = function(event) {
                        originalImage = new Image();
                        originalImage.onload = function() {
                            // Set canvas size to image size
                            documentCanvas.width = originalImage.width;
                            documentCanvas.height = originalImage.height;
                            
                            // Draw image on canvas
                            ctx.drawImage(originalImage, 0, 0);
                            
                            // Store original image data
                            originalImageData = ctx.getImageData(0, 0, documentCanvas.width, documentCanvas.height);
                        };
                        originalImage.src = event.target.result;
                    };
                    
                    reader.readAsDataURL(file);
                }
            });
            
            // Update value displays
            brightnessValue.addEventListener('input', () => {
                brightnessValueDisplay.textContent = `${brightnessValue.value}%`;
            });
            
            contrastValue.addEventListener('input', () => {
                contrastValueDisplay.textContent = `${contrastValue.value}%`;
            });
            
            sharpnessValue.addEventListener('input', () => {
                sharpnessValueDisplay.textContent = `${sharpnessValue.value}%`;
            });
            
            // Apply filters button handler
            applyFiltersBtn.addEventListener('click', () => {
                if (!originalImage) {
                    alert('Please upload an image first.');
                    return;
                }
                
                // Reset to original image
                ctx.putImageData(originalImageData, 0, 0);
                
                // Get current image data
                let imageData = ctx.getImageData(0, 0, documentCanvas.width, documentCanvas.height);
                let data = imageData.data;
                
                // Apply filters
                if (grayscaleFilter.checked) {
                    data = applyGrayscale(data);
                }
                
                if (contrastFilter.checked) {
                    const contrast = parseInt(contrastValue.value) / 100;
                    data = applyContrast(data, contrast);
                }
                
                if (brightnessFilter.checked) {
                    const brightness = parseInt(brightnessValue.value);
                    data = applyBrightness(data, brightness);
                }
                
                if (invertFilter.checked) {
                    data = applyInvert(data);
                }
                
                if (sepiaFilter.checked) {
                    data = applySepia(data);
                }
                
                // Update image data
                imageData.data.set(data);
                ctx.putImageData(imageData, 0, 0);
                
                // Apply convolution filters (these need to be applied to the entire canvas)
                if (sharpenFilter.checked) {
                    const sharpness = parseInt(sharpnessValue.value) / 100;
                    applyConvolutionFilter(sharpenKernel(sharpness));
                }
                
                if (blurFilter.checked) {
                    applyConvolutionFilter(blurKernel());
                }
                
                if (noiseFilter.checked) {
                    applyNoiseReduction();
                }
            });
            
            // Download button handler
            downloadDocumentBtn.addEventListener('click', () => {
                if (!originalImage) {
                    alert('Please upload and process an image first.');
                    return;
                }
                
                const dataUrl = documentCanvas.toDataURL('image/png');
                const a = document.createElement('a');
                a.href = dataUrl;
                a.download = 'enhanced-document.png';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            });
            
            // Reset button handler
            resetDocumentBtn.addEventListener('click', () => {
                documentFileInput.value = '';
                grayscaleFilter.checked = false;
                contrastFilter.checked = false;
                brightnessFilter.checked = false;
                sharpenFilter.checked = false;
                blurFilter.checked = false;
                invertFilter.checked = false;
                sepiaFilter.checked = false;
                noiseFilter.checked = false;
                brightnessValue.value = 0;
                brightnessValueDisplay.textContent = '0%';
                contrastValue.value = 0;
                contrastValueDisplay.textContent = '0%';
                sharpnessValue.value = 0;
                sharpnessValueDisplay.textContent = '0%';
                ctx.clearRect(0, 0, documentCanvas.width, documentCanvas.height);
                originalImage = null;
                originalImageData = null;
            });
            
            // Filter functions
            function applyGrayscale(data) {
                for (let i = 0; i < data.length; i += 4) {
                    const gray = data[i] * 0.299 + data[i+1] * 0.587 + data[i+2] * 0.114;
                    data[i] = gray;     // red
                    data[i+1] = gray;   // green
                    data[i+2] = gray;   // blue
                }
                return data;
            }
            
            function applyContrast(data, contrast) {
                const factor = (259 * (contrast + 255)) / (255 * (259 - contrast));
                
                for (let i = 0; i < data.length; i += 4) {
                    data[i] = factor * (data[i] - 128) + 128;     // red
                    data[i+1] = factor * (data[i+1] - 128) + 128; // green
                    data[i+2] = factor * (data[i+2] - 128) + 128; // blue
                }
                return data;
            }
            
            function applyBrightness(data, brightness) {
                for (let i = 0; i < data.length; i += 4) {
                    data[i] = Math.max(0, Math.min(255, data[i] + brightness));     // red
                    data[i+1] = Math.max(0, Math.min(255, data[i+1] + brightness)); // green
                    data[i+2] = Math.max(0, Math.min(255, data[i+2] + brightness)); // blue
                }
                return data;
            }
            
            function applyInvert(data) {
                for (let i = 0; i < data.length; i += 4) {
                    data[i] = 255 - data[i];     // red
                    data[i+1] = 255 - data[i+1]; // green
                    data[i+2] = 255 - data[i+2]; // blue
                }
                return data;
            }
            
            function applySepia(data) {
                for (let i = 0; i < data.length; i += 4) {
                    const r = data[i];
                    const g = data[i+1];
                    const b = data[i+2];
                    
                    data[i] = Math.min(255, (r * 0.393) + (g * 0.769) + (b * 0.189));     // red
                    data[i+1] = Math.min(255, (r * 0.349) + (g * 0.686) + (b * 0.168));   // green
                    data[i+2] = Math.min(255, (r * 0.272) + (g * 0.534) + (b * 0.131));   // blue
                }
                return data;
            }
            
            function applyConvolutionFilter(kernel) {
                const imageData = ctx.getImageData(0, 0, documentCanvas.width, documentCanvas.height);
                const data = imageData.data;
                const width = documentCanvas.width;
                const height = documentCanvas.height;
                
                const tempData = new Uint8ClampedArray(data);
                
                const kernelSize = Math.sqrt(kernel.length);
                const kernelRadius = Math.floor(kernelSize / 2);
                
                for (let y = kernelRadius; y < height - kernelRadius; y++) {
                    for (let x = kernelRadius; x < width - kernelRadius; x++) {
                        let r = 0, g = 0, b = 0;
                        
                        for (let ky = -kernelRadius; ky <= kernelRadius; ky++) {
                            for (let kx = -kernelRadius; kx <= kernelRadius; kx++) {
                                const pixelIndex = ((y + ky) * width + (x + kx)) * 4;
                                const kernelIndex = (ky + kernelRadius) * kernelSize + (kx + kernelRadius);
                                
                                r += tempData[pixelIndex] * kernel[kernelIndex];
                                g += tempData[pixelIndex + 1] * kernel[kernelIndex];
                                b += tempData[pixelIndex + 2] * kernel[kernelIndex];
                            }
                        }
                        
                        const pixelIndex = (y * width + x) * 4;
                        data[pixelIndex] = Math.max(0, Math.min(255, r));
                        data[pixelIndex + 1] = Math.max(0, Math.min(255, g));
                        data[pixelIndex + 2] = Math.max(0, Math.min(255, b));
                    }
                }
                
                ctx.putImageData(imageData, 0, 0);
            }
            
            function applyNoiseReduction() {
                // Simple median filter for noise reduction
                const imageData = ctx.getImageData(0, 0, documentCanvas.width, documentCanvas.height);
                const data = imageData.data;
                const width = documentCanvas.width;
                const height = documentCanvas.height;
                
                const tempData = new Uint8ClampedArray(data);
                
                for (let y = 1; y < height - 1; y++) {
                    for (let x = 1; x < width - 1; x++) {
                        const pixelIndex = (y * width + x) * 4;
                        
                        // Get 3x3 neighborhood
                        const rValues = [], gValues = [], bValues = [];
                        for (let dy = -1; dy <= 1; dy++) {
                            for (let dx = -1; dx <= 1; dx++) {
                                const neighborIndex = ((y + dy) * width + (x + dx)) * 4;
                                rValues.push(tempData[neighborIndex]);
                                gValues.push(tempData[neighborIndex + 1]);
                                bValues.push(tempData[neighborIndex + 2]);
                            }
                        }
                        
                        // Sort and take median
                        rValues.sort((a, b) => a - b);
                        gValues.sort((a, b) => a - b);
                        bValues.sort((a, b) => a - b);
                        
                        data[pixelIndex] = rValues[4]; // Median of 9 values
                        data[pixelIndex + 1] = gValues[4];
                        data[pixelIndex + 2] = bValues[4];
                    }
                }
                
                ctx.putImageData(imageData, 0, 0);
            }
            
            // Kernel definitions
            function sharpenKernel(amount) {
                const base = [
                    0, -1, 0,
                    -1, 5, -1,
                    0, -1, 0
                ];
                
                return base.map(value => value * amount);
            }
            
            function blurKernel() {
                return [
                    1/9, 1/9, 1/9,
                    1/9, 1/9, 1/9,
                    1/9, 1/9, 1/9
                ];
            }
        }

        // Color Picker Tool
        function setupColorPickerTool(modalOverlay) {
            const colorPicker = modalOverlay.querySelector('#colorPicker');
            const hexValue = modalOverlay.querySelector('#hexValue');
            const rgbValue = modalOverlay.querySelector('#rgbValue');
            const hslValue = modalOverlay.querySelector('#hslValue');
            const hsvValue = modalOverlay.querySelector('#hsvValue');
            const cmykValue = modalOverlay.querySelector('#cmykValue');
            const color1 = modalOverlay.querySelector('#color1');
            const color2 = modalOverlay.querySelector('#color2');
            const color1Sample = modalOverlay.querySelector('#color1Sample');
            const color2Sample = modalOverlay.querySelector('#color2Sample');
            const contrastResult = modalOverlay.querySelector('#contrastResult');
            const generatePaletteBtn = modalOverlay.querySelector('#generatePaletteBtn');
            const generatedPalette = modalOverlay.querySelector('#generatedPalette');
            const resetColorBtn = modalOverlay.querySelector('#resetColorBtn');
            
            // Update color formats when color picker changes
            colorPicker.addEventListener('input', () => {
                updateColorFormats(colorPicker.value);
            });
            
            // Update contrast checker when colors change
            color1.addEventListener('input', updateContrastChecker);
            color2.addEventListener('input', updateContrastChecker);
            
            // Generate palette button handler
            generatePaletteBtn.addEventListener('click', () => {
                generateColorPalette(colorPicker.value);
            });
            
            // Reset button handler
            resetColorBtn.addEventListener('click', () => {
                colorPicker.value = '#ff0000';
                color1.value = '#ff0000';
                color2.value = '#ffffff';
                updateColorFormats('#ff0000');
                updateContrastChecker();
                generatedPalette.innerHTML = '';
            });
            
            // Update color format displays
            function updateColorFormats(hex) {
                hexValue.value = hex;
                
                // Convert HEX to RGB
                const r = parseInt(hex.substr(1, 2), 16);
                const g = parseInt(hex.substr(3, 2), 16);
                const b = parseInt(hex.substr(5, 2), 16);
                
                rgbValue.value = `rgb(${r}, ${g}, ${b})`;
                
                // Convert RGB to HSL
                const hsl = rgbToHsl(r, g, b);
                hslValue.value = `hsl(${Math.round(hsl.h)}, ${Math.round(hsl.s)}%, ${Math.round(hsl.l)}%)`;
                
                // Convert RGB to HSV
                const hsv = rgbToHsv(r, g, b);
                hsvValue.value = `hsv(${Math.round(hsv.h)}, ${Math.round(hsv.s)}%, ${Math.round(hsv.v)}%)`;
                
                // Convert RGB to CMYK
                const cmyk = rgbToCmyk(r, g, b);
                cmykValue.value = `cmyk(${Math.round(cmyk.c)}%, ${Math.round(cmyk.m)}%, ${Math.round(cmyk.y)}%, ${Math.round(cmyk.k)}%)`;
                
                // Update sample displays
                color1Sample.style.backgroundColor = hex;
                color2Sample.style.color = hex;
            }
            
            // Update contrast checker
            function updateContrastChecker() {
                const color1Hex = color1.value;
                const color2Hex = color2.value;
                
                color1Sample.style.backgroundColor = color1Hex;
                color1Sample.style.color = color2Hex;
                
                color2Sample.style.backgroundColor = color2Hex;
                color2Sample.style.color = color1Hex;
                
                // Calculate contrast ratio
                const contrast = calculateContrastRatio(color1Hex, color2Hex);
                const level = getContrastLevel(contrast);
                
                contrastResult.innerHTML = `
                    Contrast ratio: ${contrast.toFixed(2)}:1
                    <br>${level}
                `;
            }
            
            // Generate color palette
            function generateColorPalette(baseColor) {
                generatedPalette.innerHTML = '';
                
                // Convert base color to HSL for easier manipulation
                const hex = baseColor;
                const r = parseInt(hex.substr(1, 2), 16);
                const g = parseInt(hex.substr(3, 2), 16);
                const b = parseInt(hex.substr(5, 2), 16);
                const baseHsl = rgbToHsl(r, g, b);
                
                // Generate complementary, analogous, triadic, and tetradic colors
                const schemes = {
                    'Complementary': [baseHsl.h, (baseHsl.h + 180) % 360],
                    'Analogous': [(baseHsl.h - 30 + 360) % 360, baseHsl.h, (baseHsl.h + 30) % 360],
                    'Triadic': [baseHsl.h, (baseHsl.h + 120) % 360, (baseHsl.h + 240) % 360],
                    'Tetradic': [baseHsl.h, (baseHsl.h + 60) % 360, (baseHsl.h + 180) % 360, (baseHsl.h + 240) % 360]
                };
                
                Object.keys(schemes).forEach(schemeName => {
                    const scheme = schemes[schemeName];
                    const schemeDiv = document.createElement('div');
                    schemeDiv.style.marginBottom = '15px';
                    
                    const schemeTitle = document.createElement('div');
                    schemeTitle.textContent = schemeName;
                    schemeTitle.style.fontWeight = 'bold';
                    schemeTitle.style.marginBottom = '5px';
                    
                    const colorsDiv = document.createElement('div');
                    colorsDiv.className = 'color-palette';
                    
                    scheme.forEach(hue => {
                        const color = hslToRgb(hue, baseHsl.s, baseHsl.l);
                        const hex = rgbToHex(color.r, color.g, color.b);
                        
                        const swatch = document.createElement('div');
                        swatch.className = 'color-swatch';
                        swatch.style.backgroundColor = hex;
                        swatch.setAttribute('data-color', hex);
                        swatch.addEventListener('click', () => {
                            colorPicker.value = hex;
                            updateColorFormats(hex);
                        });
                        
                        colorsDiv.appendChild(swatch);
                    });
                    
                    schemeDiv.appendChild(schemeTitle);
                    schemeDiv.appendChild(colorsDiv);
                    generatedPalette.appendChild(schemeDiv);
                });
            }
            
            // Color conversion functions
            function rgbToHsl(r, g, b) {
                r /= 255;
                g /= 255;
                b /= 255;
                
                const max = Math.max(r, g, b);
                const min = Math.min(r, g, b);
                let h, s, l = (max + min) / 2;
                
                if (max === min) {
                    h = s = 0; // achromatic
                } else {
                    const d = max - min;
                    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                    
                    switch (max) {
                        case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                        case g: h = (b - r) / d + 2; break;
                        case b: h = (r - g) / d + 4; break;
                    }
                    
                    h /= 6;
                }
                
                return {
                    h: Math.round(h * 360),
                    s: Math.round(s * 100),
                    l: Math.round(l * 100)
                };
            }
            
            function rgbToHsv(r, g, b) {
                r /= 255;
                g /= 255;
                b /= 255;
                
                const max = Math.max(r, g, b);
                const min = Math.min(r, g, b);
                let h, s, v = max;
                
                const d = max - min;
                s = max === 0 ? 0 : d / max;
                
                if (max === min) {
                    h = 0; // achromatic
                } else {
                    switch (max) {
                        case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                        case g: h = (b - r) / d + 2; break;
                        case b: h = (r - g) / d + 4; break;
                    }
                    
                    h /= 6;
                }
                
                return {
                    h: Math.round(h * 360),
                    s: Math.round(s * 100),
                    v: Math.round(v * 100)
                };
            }
            
            function rgbToCmyk(r, g, b) {
                r /= 255;
                g /= 255;
                b /= 255;
                
                const k = 1 - Math.max(r, g, b);
                const c = (1 - r - k) / (1 - k) || 0;
                const m = (1 - g - k) / (1 - k) || 0;
                const y = (1 - b - k) / (1 - k) || 0;
                
                return {
                    c: Math.round(c * 100),
                    m: Math.round(m * 100),
                    y: Math.round(y * 100),
                    k: Math.round(k * 100)
                };
            }
            
            function hslToRgb(h, s, l) {
                h /= 360;
                s /= 100;
                l /= 100;
                
                let r, g, b;
                
                if (s === 0) {
                    r = g = b = l; // achromatic
                } else {
                    const hue2rgb = (p, q, t) => {
                        if (t < 0) t += 1;
                        if (t > 1) t -= 1;
                        if (t < 1/6) return p + (q - p) * 6 * t;
                        if (t < 1/2) return q;
                        if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                        return p;
                    };
                    
                    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                    const p = 2 * l - q;
                    
                    r = hue2rgb(p, q, h + 1/3);
                    g = hue2rgb(p, q, h);
                    b = hue2rgb(p, q, h - 1/3);
                }
                
                return {
                    r: Math.round(r * 255),
                    g: Math.round(g * 255),
                    b: Math.round(b * 255)
                };
            }
            
            function rgbToHex(r, g, b) {
                return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
            }
            
            // Contrast calculation functions
            function calculateContrastRatio(color1, color2) {
                const luminance1 = calculateLuminance(color1);
                const luminance2 = calculateLuminance(color2);
                
                const lighter = Math.max(luminance1, luminance2);
                const darker = Math.min(luminance1, luminance2);
                
                return (lighter + 0.05) / (darker + 0.05);
            }
            
            function calculateLuminance(hex) {
                const r = parseInt(hex.substr(1, 2), 16) / 255;
                const g = parseInt(hex.substr(3, 2), 16) / 255;
                const b = parseInt(hex.substr(5, 2), 16) / 255;
                
                const rs = r <= 0.03928 ? r / 12.92 : Math.pow((r + 0.055) / 1.055, 2.4);
                const gs = g <= 0.03928 ? g / 12.92 : Math.pow((g + 0.055) / 1.055, 2.4);
                const bs = b <= 0.03928 ? b / 12.92 : Math.pow((b + 0.055) / 1.055, 2.4);
                
                return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs;
            }
            
            function getContrastLevel(ratio) {
                if (ratio >= 7) return 'AAA (Excellent)';
                if (ratio >= 4.5) return 'AA (Good)';
                if (ratio >= 3) return 'AA (Large Text)';
                return 'Fail (Poor)';
            }
            
            // Initialize
            updateColorFormats(colorPicker.value);
            updateContrastChecker();
        }

        // Initialize the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
<script async="async" data-cfasync="false" src="//pl28000173.effectivegatecpm.com/d178885bd24c6eaf517ba233cebb5151/invoke.js"></script>
<div id="container-d178885bd24c6eaf517ba233cebb5151"></div>
